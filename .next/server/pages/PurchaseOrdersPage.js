"use strict";(()=>{var a={};a.id=6659,a.ids=[3220,6659],a.modules={8732:a=>{a.exports=require("react/jsx-runtime")},33873:a=>{a.exports=require("path")},40361:a=>{a.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},46060:a=>{a.exports=require("next/dist/shared/lib/no-fallback-error.external.js")},56472:a=>{a.exports=require("@opentelemetry/api")},82015:a=>{a.exports=require("react")},86857:(a,b,c)=>{c.r(b),c.d(b,{config:()=>u,default:()=>q,getServerSideProps:()=>t,getStaticPaths:()=>s,getStaticProps:()=>r,handler:()=>C,reportWebVitals:()=>v,routeModule:()=>B,unstable_getServerProps:()=>z,unstable_getServerSideProps:()=>A,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>x,unstable_getStaticProps:()=>w});var d={};c.r(d),c.d(d,{PurchaseOrdersPage:()=>o});var e=c(63885),f=c(80237),g=c(81413),h=c(65611),i=c.n(h),j=c(625),k=c.n(j),l=c(8732),m=c(82015);let n=({isOpen:a,onClose:b,onSuccess:c})=>{let[d,e]=(0,m.useState)({project_id:"",vendor_name:"",po_number:"",description:"",amount:"",status:"pending",order_date:new Date().toISOString().split("T")[0],delivery_date:""}),[f,g]=(0,m.useState)([]),[h,i]=(0,m.useState)(!1),[j,k]=(0,m.useState)(null);(0,m.useEffect)(()=>{a&&(n(),e(a=>({...a,po_number:`PO-${Date.now()}`})))},[a]);let n=async()=>{try{let a=await fetch("/api/projects?limit=100"),b=await a.json();b.success&&g(b.data)}catch(a){console.error("Failed to fetch projects:",a)}};if(!a)return null;let o=async a=>{a.preventDefault(),i(!0),k(null);try{let a=localStorage.getItem("user"),f=a?JSON.parse(a):null,g=f?.company_id||"company-1",h=await fetch("/api/purchase-orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...d,company_id:g,project_id:parseInt(d.project_id),amount:parseFloat(d.amount)})}),i=await h.json();i.success?(c(),b(),e({project_id:"",vendor_name:"",po_number:"",description:"",amount:"",status:"pending",order_date:new Date().toISOString().split("T")[0],delivery_date:""})):k(i.error||"Failed to create purchase order")}catch(a){k(a.message||"Failed to create purchase order")}finally{i(!1)}};return(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,l.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,l.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Create Purchase Order"}),(0,l.jsx)("button",{type:"button",onClick:b,className:"text-gray-400 hover:text-gray-600",children:(0,l.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,l.jsxs)("form",{onSubmit:o,className:"p-6 space-y-4",children:[j&&(0,l.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:j}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Project ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsxs)("select",{required:!0,value:d.project_id,onChange:a=>e({...d,project_id:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:"",children:"Select project"}),f.map(a=>(0,l.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["PO Number ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)("input",{type:"text",required:!0,value:d.po_number,onChange:a=>e({...d,po_number:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"PO-12345"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Vendor Name ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)("input",{type:"text",required:!0,value:d.vendor_name,onChange:a=>e({...d,vendor_name:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter vendor name"})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Description ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)("textarea",{required:!0,value:d.description,onChange:a=>e({...d,description:a.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Describe the purchase..."})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Amount ($) ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)("input",{type:"number",required:!0,step:"0.01",min:"0",value:d.amount,onChange:a=>e({...d,amount:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,l.jsxs)("select",{value:d.status,onChange:a=>e({...d,status:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[(0,l.jsx)("option",{value:"pending",children:"Pending"}),(0,l.jsx)("option",{value:"approved",children:"Approved"}),(0,l.jsx)("option",{value:"ordered",children:"Ordered"}),(0,l.jsx)("option",{value:"received",children:"Received"}),(0,l.jsx)("option",{value:"cancelled",children:"Cancelled"})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Order Date ",(0,l.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,l.jsx)("input",{type:"date",required:!0,value:d.order_date,onChange:a=>e({...d,order_date:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Date"}),(0,l.jsx)("input",{type:"date",value:d.delivery_date,onChange:a=>e({...d,delivery_date:a.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t border-gray-200",children:[(0,l.jsx)("button",{type:"button",onClick:b,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),(0,l.jsx)("button",{type:"submit",disabled:h,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:h?"Creating...":"Create PO"})]})]})]})})},o=()=>{let[a,b]=(0,m.useState)(""),[c,d]=(0,m.useState)("all"),[e,f]=(0,m.useState)([]),[g,h]=(0,m.useState)(!0),[i,j]=(0,m.useState)(null),[k,o]=(0,m.useState)(!1);(0,m.useEffect)(()=>{p()},[a,c]);let p=async()=>{try{h(!0);let b=new URLSearchParams({page:"1",limit:"50"});a&&b.append("search",a),"all"!==c&&b.append("status",c);let d=await fetch(`/api/purchase-orders?${b}`),e=await d.json();e.success?f(e.data):j(e.error)}catch(a){j(a.message),f(q)}finally{h(!1)}},q=[{id:"PO-2024-001",vendor:"ABC Supplies Inc",project:"Downtown Office Complex",items:"Steel beams, concrete mix",amount:45e3,status:"approved",orderDate:"Dec 1, 2024",deliveryDate:"Dec 15, 2024",receivedDate:null},{id:"PO-2024-002",vendor:"BuildMart Wholesale",project:"Riverside Luxury Apartments",items:"Lumber, drywall, insulation",amount:32500,status:"pending",orderDate:"Dec 5, 2024",deliveryDate:"Dec 20, 2024",receivedDate:null}];return(0,l.jsxs)("div",{className:"p-8",children:[(0,l.jsx)("div",{className:"mb-8",children:(0,l.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Purchase Orders"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Manage procurement and orders"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),(0,l.jsx)("input",{type:"text",placeholder:"Search purchase orders...",value:a,onChange:a=>b(a.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent w-64"})]}),(0,l.jsxs)("select",{value:c,onChange:a=>d(a.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,l.jsx)("option",{value:"all",children:"All Status"}),(0,l.jsx)("option",{value:"approved",children:"Approved"}),(0,l.jsx)("option",{value:"pending",children:"Pending"}),(0,l.jsx)("option",{value:"received",children:"Received"}),(0,l.jsx)("option",{value:"cancelled",children:"Cancelled"})]}),(0,l.jsxs)("button",{type:"button",onClick:()=>o(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),(0,l.jsx)("span",{children:"New Purchase Order"})]})]})]})}),(0,l.jsx)("div",{className:"space-y-4",children:e.map(a=>(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[(0,l.jsx)("div",{className:"flex items-start justify-between mb-4",children:(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,l.jsx)("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${{approved:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",received:"bg-blue-100 text-blue-800",cancelled:"bg-red-100 text-red-800"}[a.status]||"bg-gray-100 text-gray-800"}`,children:a.status}),(0,l.jsx)("span",{className:"text-2xl font-bold text-gray-900",children:(a=>null==a?"\xa30.00":`\xa3${a.toLocaleString("en-GB",{minimumFractionDigits:2,maximumFractionDigits:2})}`)(a.amount)})]}),(0,l.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:["PO #",a.id]}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:a.vendor})]})}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("div",{className:"flex items-start",children:[(0,l.jsx)("span",{className:"text-sm text-gray-600 mr-2",children:"Project:"}),(0,l.jsx)("p",{className:"text-sm font-medium text-gray-900",children:a.project})]}),(0,l.jsxs)("div",{className:"flex items-start",children:[(0,l.jsx)("span",{className:"text-sm text-gray-600 mr-2",children:"Items:"}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:a.items})]}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-4 pt-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-xs text-gray-500",children:"Order Date:"}),(0,l.jsx)("p",{className:"text-sm font-medium text-gray-900",children:a.orderDate})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-xs text-gray-500",children:"Delivery Date:"}),(0,l.jsx)("p",{className:"text-sm font-medium text-gray-900",children:a.deliveryDate})]}),a.receivedDate&&(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-xs text-gray-500",children:"Received:"}),(0,l.jsx)("p",{className:"text-sm font-medium text-green-600",children:a.receivedDate})]})]})]})]},a.id))}),(0,l.jsx)(n,{isOpen:k,onClose:()=>o(!1),onSuccess:()=>{o(!1),p()}})]})};var p=c(12289);let q=(0,g.M)(d,"default"),r=(0,g.M)(d,"getStaticProps"),s=(0,g.M)(d,"getStaticPaths"),t=(0,g.M)(d,"getServerSideProps"),u=(0,g.M)(d,"config"),v=(0,g.M)(d,"reportWebVitals"),w=(0,g.M)(d,"unstable_getStaticProps"),x=(0,g.M)(d,"unstable_getStaticPaths"),y=(0,g.M)(d,"unstable_getStaticParams"),z=(0,g.M)(d,"unstable_getServerProps"),A=(0,g.M)(d,"unstable_getServerSideProps"),B=new e.PagesRouteModule({definition:{kind:f.RouteKind.PAGES,page:"/PurchaseOrdersPage",pathname:"/PurchaseOrdersPage",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:k(),Document:i()},userland:d}),C=(0,p.U)({srcPage:"/PurchaseOrdersPage",config:u,userland:d,routeModule:B,getStaticPaths:s,getStaticProps:r,getServerSideProps:t})}};var b=require("../webpack-runtime.js");b.C(a);var c=b.X(0,[5611,157],()=>b(b.s=86857));module.exports=c})();