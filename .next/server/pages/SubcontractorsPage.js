"use strict";(()=>{var a={};a.id=8499,a.ids=[3220,8499],a.modules={8732:a=>{a.exports=require("react/jsx-runtime")},33013:(a,b,c)=>{c.r(b),c.d(b,{config:()=>u,default:()=>q,getServerSideProps:()=>t,getStaticPaths:()=>s,getStaticProps:()=>r,handler:()=>C,reportWebVitals:()=>v,routeModule:()=>B,unstable_getServerProps:()=>z,unstable_getServerSideProps:()=>A,unstable_getStaticParams:()=>y,unstable_getStaticPaths:()=>x,unstable_getStaticProps:()=>w});var d={};c.r(d),c.d(d,{SubcontractorsPage:()=>o});var e=c(63885),f=c(80237),g=c(81413),h=c(65611),i=c.n(h),j=c(625),k=c.n(j),l=c(8732),m=c(82015);let n=({isOpen:a,onClose:b,onSuccess:c})=>{let[d,e]=(0,m.useState)({name:"",trade:"electrical",contact_name:"",email:"",phone:"",license_number:"",insurance_expiry:"",status:"active"}),[f,g]=(0,m.useState)(!1),[h,i]=(0,m.useState)(null);if(!a)return null;let j=async a=>{a.preventDefault(),g(!0),i(null);try{let a=localStorage.getItem("user"),f=a?JSON.parse(a):null,g=f?.company_id||"company-1",h=await fetch("/api/subcontractors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...d,company_id:g})}),j=await h.json();j.success?(c(),b(),e({name:"",trade:"electrical",contact_name:"",email:"",phone:"",license_number:"",insurance_expiry:"",status:"active"})):i(j.error||"Failed to create subcontractor")}catch(a){i(a.message||"Failed to create subcontractor")}finally{g(!1)}};return(0,l.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,l.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"New Subcontractor"}),(0,l.jsx)("button",{type:"button",onClick:b,className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,l.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,l.jsxs)("form",{onSubmit:j,className:"p-6 space-y-6",children:[h&&(0,l.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:h}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Name *"}),(0,l.jsx)("input",{type:"text",required:!0,value:d.name,onChange:a=>e({...d,name:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter company name"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Trade *"}),(0,l.jsxs)("select",{required:!0,value:d.trade,onChange:a=>e({...d,trade:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,l.jsx)("option",{value:"electrical",children:"Electrical"}),(0,l.jsx)("option",{value:"plumbing",children:"Plumbing"}),(0,l.jsx)("option",{value:"hvac",children:"HVAC"}),(0,l.jsx)("option",{value:"carpentry",children:"Carpentry"}),(0,l.jsx)("option",{value:"masonry",children:"Masonry"}),(0,l.jsx)("option",{value:"roofing",children:"Roofing"}),(0,l.jsx)("option",{value:"painting",children:"Painting"}),(0,l.jsx)("option",{value:"flooring",children:"Flooring"}),(0,l.jsx)("option",{value:"landscaping",children:"Landscaping"}),(0,l.jsx)("option",{value:"other",children:"Other"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Name"}),(0,l.jsx)("input",{type:"text",value:d.contact_name,onChange:a=>e({...d,contact_name:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Contact person"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,l.jsx)("input",{type:"email",value:d.email,onChange:a=>e({...d,email:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"email@example.com"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),(0,l.jsx)("input",{type:"tel",value:d.phone,onChange:a=>e({...d,phone:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"(555) 123-4567"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"License Number"}),(0,l.jsx)("input",{type:"text",value:d.license_number,onChange:a=>e({...d,license_number:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"License #"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Insurance Expiry"}),(0,l.jsx)("input",{type:"date",value:d.insurance_expiry,onChange:a=>e({...d,insurance_expiry:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,l.jsxs)("select",{value:d.status,onChange:a=>e({...d,status:a.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,l.jsx)("option",{value:"active",children:"Active"}),(0,l.jsx)("option",{value:"inactive",children:"Inactive"}),(0,l.jsx)("option",{value:"pending",children:"Pending"})]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-end space-x-4 pt-4 border-t border-gray-200",children:[(0,l.jsx)("button",{type:"button",onClick:b,className:"px-6 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),(0,l.jsx)("button",{type:"submit",disabled:f,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 flex items-center space-x-2",children:f?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"inline-block animate-spin",children:"⏳"}),(0,l.jsx)("span",{children:"Creating..."})]}):(0,l.jsx)("span",{children:"Create Subcontractor"})})]})]})]})})},o=()=>{let[a,b]=(0,m.useState)(""),[c,d]=(0,m.useState)("all"),[e,f]=(0,m.useState)("directory"),[g,h]=(0,m.useState)([]),[i,j]=(0,m.useState)(!0),[k,o]=(0,m.useState)(null),[p,q]=(0,m.useState)(!1);(0,m.useEffect)(()=>{r()},[a,c]);let r=async()=>{try{j(!0);let b=new URLSearchParams({page:"1",limit:"50"});a&&b.append("search",a),"all"!==c&&b.append("trade",c);let d=await fetch(`/api/subcontractors?${b}`),e=await d.json();e.success?h(e.data):o(e.error)}catch(a){o(a.message),h(s)}finally{j(!1)}},s=[{id:"1",name:"Elite Electrical Services",trade:"electrical",contact:"Mike Johnson",email:"mike@eliteelectrical.com",phone:"555-0101",license:"EC-12345",status:"active",rating:5,projects:0,onTimeRate:92,insuranceExpiring:!0},{id:"2",name:"Premier HVAC Inc",trade:"hvac",contact:"David Chen",email:"david@premierhvac.com",phone:"555-0103",license:"HV-24680",status:"active",rating:5,projects:0,onTimeRate:88,insuranceExpiring:!0},{id:"3",name:"ProPlumb Solutions",trade:"plumbing",contact:"Sarah Martinez",email:"sarah@proplumb.com",phone:"555-0102",license:"PL-67890",status:"active",rating:5,projects:0,onTimeRate:95,insuranceExpiring:!0}];return(0,l.jsxs)("div",{className:"p-8",children:[(0,l.jsx)("div",{className:"mb-8",children:(0,l.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Subcontractors"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Manage your subcontractor network"})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)("svg",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),(0,l.jsx)("input",{type:"text",placeholder:"Search subcontractors...",value:a,onChange:a=>b(a.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent w-64"})]}),(0,l.jsxs)("select",{value:c,onChange:a=>d(a.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,l.jsx)("option",{value:"all",children:"All Trades"}),(0,l.jsx)("option",{value:"electrical",children:"Electrical"}),(0,l.jsx)("option",{value:"hvac",children:"HVAC"}),(0,l.jsx)("option",{value:"plumbing",children:"Plumbing"}),(0,l.jsx)("option",{value:"carpentry",children:"Carpentry"})]}),(0,l.jsxs)("button",{type:"button",onClick:()=>q(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[(0,l.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),(0,l.jsx)("span",{children:"Add Subcontractor"})]})]})]})}),(0,l.jsx)("div",{className:"mb-6",children:(0,l.jsx)("div",{className:"border-b border-gray-200",children:(0,l.jsxs)("nav",{className:"flex space-x-8",children:[(0,l.jsx)("button",{type:"button",onClick:()=>f("directory"),className:`py-4 px-1 border-b-2 font-medium text-sm ${"directory"===e?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Directory"}),(0,l.jsx)("button",{type:"button",onClick:()=>f("assignments"),className:`py-4 px-1 border-b-2 font-medium text-sm ${"assignments"===e?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Assignments"})]})})}),"directory"===e&&(0,l.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(a=>{let b;return(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[(0,l.jsxs)("div",{className:"flex items-start space-x-3 mb-4",children:[(0,l.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center text-2xl",children:"\uD83D\uDD27"}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,l.jsx)("span",{className:"px-2 py-1 rounded text-xs font-medium bg-green-100 text-green-800",children:a.status}),a.insuranceExpiring&&(0,l.jsxs)("span",{className:"px-2 py-1 rounded text-xs font-medium bg-yellow-100 text-yellow-800 flex items-center space-x-1",children:[(0,l.jsx)("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),(0,l.jsx)("span",{children:"Insurance Expiring"})]})]}),(0,l.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:a.name}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:a.trade})]})]}),(0,l.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,l.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,l.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),(0,l.jsx)("span",{children:a.contact})]}),(0,l.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,l.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),(0,l.jsx)("span",{children:a.email})]}),(0,l.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,l.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),(0,l.jsx)("span",{children:a.phone})]}),(0,l.jsxs)("div",{className:"flex items-center text-sm text-gray-600",children:[(0,l.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),(0,l.jsxs)("span",{children:["License: ",a.license]})]})]}),(0,l.jsx)("div",{className:"mb-4",children:(0,l.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[(0,l.jsx)("span",{className:"text-gray-600",children:"Rating:"}),(0,l.jsx)("div",{className:"flex",children:(b=a.rating,Array.from({length:5},(a,c)=>(0,l.jsx)("span",{className:c<b?"text-yellow-400":"text-gray-300",children:"★"},c)))})]})}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-gray-200 mb-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-xs text-gray-500",children:"Projects:"}),(0,l.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:a.projects})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-xs text-gray-500",children:"On-time Rate:"}),(0,l.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:[a.onTimeRate,"%"]})]})]}),(0,l.jsxs)("button",{type:"button",className:"w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[(0,l.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,l.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),(0,l.jsx)("span",{children:"Assign to Project"})]})]},a.id)})}),"assignments"===e&&(0,l.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-8 text-center",children:(0,l.jsx)("p",{className:"text-gray-600",children:"No assignments yet. Assign subcontractors to projects from the Directory tab."})}),(0,l.jsx)(n,{isOpen:p,onClose:()=>q(!1),onSuccess:()=>{r(),q(!1)}})]})};var p=c(12289);let q=(0,g.M)(d,"default"),r=(0,g.M)(d,"getStaticProps"),s=(0,g.M)(d,"getStaticPaths"),t=(0,g.M)(d,"getServerSideProps"),u=(0,g.M)(d,"config"),v=(0,g.M)(d,"reportWebVitals"),w=(0,g.M)(d,"unstable_getStaticProps"),x=(0,g.M)(d,"unstable_getStaticPaths"),y=(0,g.M)(d,"unstable_getStaticParams"),z=(0,g.M)(d,"unstable_getServerProps"),A=(0,g.M)(d,"unstable_getServerSideProps"),B=new e.PagesRouteModule({definition:{kind:f.RouteKind.PAGES,page:"/SubcontractorsPage",pathname:"/SubcontractorsPage",bundlePath:"",filename:""},distDir:".next",relativeProjectDir:"",components:{App:k(),Document:i()},userland:d}),C=(0,p.U)({srcPage:"/SubcontractorsPage",config:u,userland:d,routeModule:B,getStaticPaths:s,getStaticProps:r,getServerSideProps:t})},33873:a=>{a.exports=require("path")},40361:a=>{a.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},46060:a=>{a.exports=require("next/dist/shared/lib/no-fallback-error.external.js")},56472:a=>{a.exports=require("@opentelemetry/api")},82015:a=>{a.exports=require("react")}};var b=require("../webpack-runtime.js");b.C(a);var c=b.X(0,[5611,157],()=>b(b.s=33013));module.exports=c})();