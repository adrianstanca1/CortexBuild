import{r as e,a as t,g as s}from"./react-DiZ9e1Sl.js";import{r as a,R as r}from"./leaflet-D9Qn1H0p.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var i,n,l={exports:{}},o={};var c,d=(n||(n=1,l.exports=function(){if(i)return o;i=1;var t=e(),s=Symbol.for("react.element"),a=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,n=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,a){var i,o={},c=null,d=null;for(i in void 0!==a&&(c=""+a),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)r.call(t,i)&&!l.hasOwnProperty(i)&&(o[i]=t[i]);if(e&&e.defaultProps)for(i in t=e.defaultProps)void 0===o[i]&&(o[i]=t[i]);return{$$typeof:s,type:e,key:c,ref:d,props:o,_owner:n.current}}return o.Fragment=a,o.jsx=c,o.jsxs=c,o}()),l.exports),m={};const u=s(function(){if(c)return m;c=1;var e=t();return m.createRoot=e.createRoot,m.hydrateRoot=e.hydrateRoot,m}());var x=(e=>(e.OWNER="OWNER",e.ADMIN="ADMIN",e.PROJECT_MANAGER="PROJECT_MANAGER",e.FOREMAN="FOREMAN",e.OPERATIVE="OPERATIVE",e.CLIENT="CLIENT",e.PRINCIPAL_ADMIN="PRINCIPAL_ADMIN",e))(x||{}),h=(e=>(e.VIEW_ALL_PROJECTS="VIEW_ALL_PROJECTS",e.VIEW_ASSIGNED_PROJECTS="VIEW_ASSIGNED_PROJECTS",e.CREATE_PROJECT="CREATE_PROJECT",e.MANAGE_PROJECT_DETAILS="MANAGE_PROJECT_DETAILS",e.MANAGE_PROJECT_TEMPLATES="MANAGE_PROJECT_TEMPLATES",e.VIEW_ALL_TASKS="VIEW_ALL_TASKS",e.MANAGE_ALL_TASKS="MANAGE_ALL_TASKS",e.SUBMIT_TIMESHEET="SUBMIT_TIMESHEET",e.VIEW_ALL_TIMESHEETS="VIEW_ALL_TIMESHEETS",e.MANAGE_TIMESHEETS="MANAGE_TIMESHEETS",e.UPLOAD_DOCUMENTS="UPLOAD_DOCUMENTS",e.VIEW_DOCUMENTS="VIEW_DOCUMENTS",e.SUBMIT_SAFETY_REPORT="SUBMIT_SAFETY_REPORT",e.VIEW_SAFETY_REPORTS="VIEW_SAFETY_REPORTS",e.MANAGE_SAFETY_REPORTS="MANAGE_SAFETY_REPORTS",e.VIEW_FINANCES="VIEW_FINANCES",e.MANAGE_FINANCES="MANAGE_FINANCES",e.VIEW_TEAM="VIEW_TEAM",e.MANAGE_TEAM="MANAGE_TEAM",e.MANAGE_EQUIPMENT="MANAGE_EQUIPMENT",e.VIEW_AUDIT_LOG="VIEW_AUDIT_LOG",e.SEND_DIRECT_MESSAGE="SEND_DIRECT_MESSAGE",e.ACCESS_ALL_TOOLS="ACCESS_ALL_TOOLS",e.SUBMIT_EXPENSE="SUBMIT_EXPENSE",e))(h||{}),p=(e=>(e.TODO="TODO",e.IN_PROGRESS="IN_PROGRESS",e.DONE="DONE",e))(p||{}),g=(e=>(e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH",e))(g||{}),y=(e=>(e.PENDING="PENDING",e.APPROVED="APPROVED",e.REJECTED="REJECTED",e.PAID="PAID",e))(y||{}),b=(e=>(e.DRAFT="DRAFT",e.SENT="SENT",e.PAID="PAID",e.OVERDUE="OVERDUE",e.CANCELLED="CANCELLED",e))(b||{}),j=(e=>(e.PENDING="PENDING",e.APPROVED="APPROVED",e.REJECTED="REJECTED",e.DRAFT="DRAFT",e))(j||{}),f=(e=>(e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH",e.CRITICAL="CRITICAL",e))(f||{}),v=(e=>(e.REPORTED="REPORTED",e.UNDER_INVESTIGATION="UNDER_INVESTIGATION",e.RESOLVED="RESOLVED",e))(v||{}),N=(e=>(e.AVAILABLE="AVAILABLE",e.IN_USE="IN_USE",e.MAINTENANCE="MAINTENANCE",e.OUT_OF_ORDER="OUT_OF_ORDER",e))(N||{});const w={OWNER:new Set(Object.values(h)),ADMIN:new Set(["VIEW_ALL_PROJECTS","CREATE_PROJECT","MANAGE_PROJECT_DETAILS","VIEW_ALL_TASKS","MANAGE_ALL_TASKS","VIEW_ALL_TIMESHEETS","MANAGE_TIMESHEETS","UPLOAD_DOCUMENTS","VIEW_DOCUMENTS","VIEW_SAFETY_REPORTS","MANAGE_SAFETY_REPORTS","VIEW_FINANCES","MANAGE_FINANCES","VIEW_TEAM","MANAGE_TEAM","MANAGE_EQUIPMENT","VIEW_AUDIT_LOG","SEND_DIRECT_MESSAGE","ACCESS_ALL_TOOLS","SUBMIT_EXPENSE","MANAGE_PROJECT_TEMPLATES"]),PROJECT_MANAGER:new Set(["VIEW_ALL_PROJECTS","MANAGE_PROJECT_DETAILS","VIEW_ALL_TASKS","MANAGE_ALL_TASKS","VIEW_ALL_TIMESHEETS","MANAGE_TIMESHEETS","UPLOAD_DOCUMENTS","VIEW_DOCUMENTS","VIEW_SAFETY_REPORTS","VIEW_FINANCES","VIEW_TEAM","MANAGE_EQUIPMENT","SEND_DIRECT_MESSAGE","SUBMIT_EXPENSE"]),FOREMAN:new Set(["VIEW_ASSIGNED_PROJECTS","SUBMIT_TIMESHEET","UPLOAD_DOCUMENTS","VIEW_DOCUMENTS","SUBMIT_SAFETY_REPORT","VIEW_SAFETY_REPORTS","SEND_DIRECT_MESSAGE","SUBMIT_EXPENSE"]),OPERATIVE:new Set(["VIEW_ASSIGNED_PROJECTS","SUBMIT_TIMESHEET","VIEW_DOCUMENTS","SUBMIT_SAFETY_REPORT","SUBMIT_EXPENSE"]),CLIENT:new Set(["VIEW_ASSIGNED_PROJECTS","VIEW_DOCUMENTS"]),PRINCIPAL_ADMIN:new Set(Object.values(h))},k={companies:[{id:"0",name:"Platform Administration"},{id:"1",name:"ConstructCo"},{id:"2",name:"Renovate Ltd."},{id:"3",name:"As Cladding and Roofing Ltd"}],users:[{id:"demo",firstName:"Demo",lastName:"User",email:"demo@example.com",role:x.ADMIN,companyId:"1",avatar:"https://i.pravatar.cc/150?u=demo",password:"password",mfaEnabled:!1},{id:"0",firstName:"Adrian",lastName:"Admin",email:"adrian@ascladdingltd.co.uk",role:x.PRINCIPAL_ADMIN,companyId:"0",avatar:"https://i.pravatar.cc/150?u=0",password:"Cumparavinde1",mfaEnabled:!1},{id:"1",firstName:"Samantha",lastName:"Lee",email:"sam@constructco.com",role:x.ADMIN,companyId:"1",avatar:"https://i.pravatar.cc/150?u=1",phone:"07123456781",password:"password123",mfaEnabled:!1},{id:"2",firstName:"David",lastName:"Chen",email:"david@constructco.com",role:x.PROJECT_MANAGER,companyId:"1",avatar:"https://i.pravatar.cc/150?u=2",phone:"07123456782",password:"password123",mfaEnabled:!0},{id:"3",firstName:"Maria",lastName:"Garcia",email:"maria@constructco.com",role:x.FOREMAN,companyId:"1",avatar:"https://i.pravatar.cc/150?u=3",phone:"07123456783",password:"password123",mfaEnabled:!1},{id:"4",firstName:"Bob",lastName:"Williams",email:"bob@constructco.com",role:x.OPERATIVE,companyId:"1",avatar:"https://i.pravatar.cc/150?u=4",phone:"07123456784",password:"password123",mfaEnabled:!1},{id:"5",firstName:"John",lastName:"Smith",email:"john@renovate.com",role:x.ADMIN,companyId:"2",avatar:"https://i.pravatar.cc/150?u=5",phone:"07123456785",password:"password123",mfaEnabled:!1},{id:"6",firstName:"Emily",lastName:"White",email:"emily@renovate.com",role:x.PROJECT_MANAGER,companyId:"2",avatar:"https://i.pravatar.cc/150?u=6",phone:"07123456786",password:"password123",mfaEnabled:!1},{id:"7",firstName:"Carlos",lastName:"Diaz",email:"carlos@constructco.com",role:x.OPERATIVE,companyId:"1",avatar:"https://i.pravatar.cc/150?u=7",phone:"07123456787",password:"password123",mfaEnabled:!1},{id:"8",firstName:"Admin",lastName:"User",email:"admin@ascladding.com",role:x.OWNER,companyId:"3",avatar:"https://i.pravatar.cc/150?u=8",phone:"07123456788",password:"password123",mfaEnabled:!1}],projects:[{id:"101",companyId:"1",name:"Downtown Tower",location:{address:"123 Main St, London",lat:51.5074,lng:-.1278},budget:5e6,spent:325e4,actualCost:325e4,startDate:"2023-01-15",status:"ACTIVE",image:"https://picsum.photos/seed/tower/800/400"},{id:"102",companyId:"1",name:"North Bridge Retrofit",location:{address:"456 Oak Ave, Manchester",lat:53.4808,lng:-2.2426},budget:12e5,spent:135e4,actualCost:135e4,startDate:"2022-11-01",status:"COMPLETED",image:"https://picsum.photos/seed/bridge/800/400"},{id:"201",companyId:"2",name:"Victorian House Reno",location:{address:"789 Pine Ln, Bristol",lat:51.4545,lng:-2.5879},budget:25e4,spent:18e4,actualCost:18e4,startDate:"2023-03-10",status:"ACTIVE",image:"https://picsum.photos/seed/house/800/400"}],todos:[{id:"t-1",text:"Finalize foundation pouring",title:"Finalize foundation pouring",status:p.IN_PROGRESS,priority:g.HIGH,assignedTo:"3",projectId:"101"},{id:"t-2",text:"Install HVAC system on floor 5",title:"Install HVAC system on floor 5",status:p.TODO,priority:g.MEDIUM,assignedTo:"4",projectId:"101"},{id:"t-3",text:"Source interior fixtures",title:"Source interior fixtures",status:p.TODO,priority:g.LOW,assignedTo:"2",projectId:"101"},{id:"t-4",text:"Strip wallpaper in living room",title:"Strip wallpaper in living room",status:p.DONE,priority:g.MEDIUM,assignedTo:"6",projectId:"201"}],expenses:[{id:"e-1",description:"Client Lunch",amount:150,category:"Other",projectId:"101",userId:"2",date:"2024-01-15",status:y.APPROVED}],invoices:[{id:"inv-1",companyId:"1",invoiceNumber:"INV-001",projectId:"101",clientId:"c-1",issueDate:"2024-01-20",dueDate:"2024-02-20",status:b.PAID,lineItems:[{id:"li-1",description:"Phase 1",quantity:1,rate:1e5,amount:1e5}],subtotal:1e5,taxRate:.2,taxAmount:2e4,retentionRate:.05,retentionAmount:5e3,total:115e3,amountPaid:115e3,balance:0}],siteUpdates:[{id:"su-1",projectId:"101",userId:"3",message:"Concrete pour for the ground floor is complete.",timestamp:new Date(Date.now()-72e5).toISOString(),images:["https://picsum.photos/seed/concrete/400/200"]}],projectMessages:[{id:"pm-1",projectId:"101",senderId:"2",message:"Team, please remember the safety briefing at 7 AM sharp tomorrow.",timestamp:new Date(Date.now()-12e5).toISOString()}],safetyIncidents:[{id:"si-1",title:"Minor Slip",description:"Minor slip on wet surface, no injury.",severity:f.LOW,projectId:"101",reportedBy:"3",incidentDate:(new Date).toISOString(),status:v.RESOLVED}],equipment:[{id:"eq-1",name:"Excavator CAT 320",status:N.AVAILABLE,companyId:"1"}],timeEntries:[{id:"te-1",userId:"4",projectId:"101",startTime:new Date(Date.now()-288e5).toISOString(),endTime:(new Date).toISOString(),status:j.PENDING}],projectInsights:[],financialForecasts:[],clients:[{id:"c-1",companyId:"1",name:"Global Real Estate Inc.",contactPerson:"Ava Harris",contactEmail:"ava.harris@gre.com",contactPhone:"+44 20 7946 0101",email:"accounts@gre.com",phone:"+44 20 7946 0101",billingAddress:"Accounts Payable, 100 Market Street, London SW1A 1AA",paymentTerms:"Net 30",isActive:!0,createdAt:"2024-01-15T09:00:00Z",updatedAt:"2024-12-10T10:30:00Z",address:{street:"100 Market Street",city:"London",state:"Greater London",zipCode:"SW1A 1AA",country:"United Kingdom"}},{id:"c-2",companyId:"1",name:"Northbridge Retail Group",contactPerson:"Leo Patel",contactEmail:"leo.patel@northbridge.com",contactPhone:"+44 161 555 0198",email:"finance@northbridge.com",phone:"+44 161 555 0198",billingAddress:"Finance Office, 50 King Street, Manchester M2 4LY",paymentTerms:"Net 45",isActive:!0,createdAt:"2024-11-28T12:00:00Z",updatedAt:"2024-12-15T08:15:00Z",address:{street:"50 King Street",city:"Manchester",state:"Greater Manchester",zipCode:"M2 4LY",country:"United Kingdom"}}]};var S={};class C{constructor(e={}){this.cache=new Map,this.defaultTtl=e.ttl||3e5,this.maxSize=e.maxSize||100,this.persistent=e.persistent||!1,this.namespace=e.namespace||"app-cache",this.persistent&&this.loadFromStorage(),"undefined"==typeof window||this.isTestEnv()||setInterval(()=>this.cleanup(),6e4)}isTestEnv(){try{return"undefined"!=typeof process&&!(!S?.VITEST&&!S?.VITEST_WORKER_ID)}catch{return!1}}set(e,t,s){const a=Date.now(),r={data:t,timestamp:a,ttl:s||this.defaultTtl,accessCount:0,lastAccessed:a};this.cache.size>=this.maxSize&&this.evictLRU(),this.cache.set(e,r),this.persistent&&this.saveToStorage()}get(e){const t=this.cache.get(e);if(!t)return null;const s=Date.now();return s-t.timestamp>t.ttl?(this.cache.delete(e),this.persistent&&this.saveToStorage(),null):(t.accessCount++,t.lastAccessed=s,t.data)}has(e){return null!==this.get(e)}delete(e){const t=this.cache.delete(e);return t&&this.persistent&&this.saveToStorage(),t}clear(){this.cache.clear(),this.persistent&&this.saveToStorage()}keys(){return Array.from(this.cache.keys())}size(){return this.cache.size}getStats(){const e=Array.from(this.cache.values());return{size:this.cache.size,maxSize:this.maxSize,totalAccesses:e.reduce((e,t)=>e+t.accessCount,0),averageAge:e.length>0?e.reduce((e,t)=>e+(Date.now()-t.timestamp),0)/e.length:0}}evictLRU(){let e="",t=Date.now();for(const[s,a]of this.cache.entries())a.lastAccessed<t&&(t=a.lastAccessed,e=s);e&&this.cache.delete(e)}cleanup(){const e=Date.now(),t=[];for(const[s,a]of this.cache.entries())e-a.timestamp>a.ttl&&t.push(s);t.forEach(e=>this.cache.delete(e)),t.length>0&&this.persistent&&this.saveToStorage()}saveToStorage(){if("undefined"!=typeof window&&window.localStorage)try{const e=JSON.stringify(Array.from(this.cache.entries()));localStorage.setItem(`${this.namespace}-cache`,e)}catch(e){console.warn("Failed to save cache to localStorage:",e)}}loadFromStorage(){if("undefined"!=typeof window&&window.localStorage)try{const e=localStorage.getItem(`${this.namespace}-cache`);if(e){const t=JSON.parse(e);this.cache=new Map(t),this.cleanup()}}catch(e){console.warn("Failed to load cache from localStorage:",e)}}}new C({ttl:3e5,maxSize:200,persistent:!0,namespace:"api-cache"}),new C({ttl:18e5,maxSize:50,persistent:!0,namespace:"user-cache"}),new C({ttl:6e5,maxSize:100,persistent:!0,namespace:"project-cache"});const E=class{static validate(e,t){const s={},a={...e};for(const r of t){const t=String(r.field),i=e[r.field],n=[];if(!r.required||null!=i&&""!==i){if(r.required||null!=i&&""!==i){if(r.type){const e=this.validateType(i,r.type,t);e&&n.push(e)}if("string"==typeof i&&(r.minLength&&i.length<r.minLength&&n.push(`${t} must be at least ${r.minLength} characters`),r.maxLength&&i.length>r.maxLength&&n.push(`${t} must not exceed ${r.maxLength} characters`)),"number"==typeof i&&(void 0!==r.min&&i<r.min&&n.push(`${t} must be at least ${r.min}`),void 0!==r.max&&i>r.max&&n.push(`${t} must not exceed ${r.max}`)),r.pattern&&"string"==typeof i&&!r.pattern.test(i)&&n.push(`${t} format is invalid`),r.custom){const e=r.custom(i);e&&n.push(e)}r.sanitize&&(a[r.field]=r.sanitize(i)),n.length>0&&(s[t]=n)}}else n.push(`${t} is required`)}return{isValid:0===Object.keys(s).length,errors:s,sanitizedData:0===Object.keys(s).length?a:void 0}}static validateType(e,t,s){switch(t){case"string":return"string"!=typeof e?`${s} must be a string`:null;case"number":return"number"!=typeof e||isNaN(e)?`${s} must be a valid number`:null;case"boolean":return"boolean"!=typeof e?`${s} must be true or false`:null;case"email":return"string"==typeof e&&this.emailRegex.test(e)?null:`${s} must be a valid email address`;case"phone":return"string"==typeof e&&this.phoneRegex.test(e.replace(/\s/g,""))?null:`${s} must be a valid phone number`;case"url":return"string"==typeof e&&this.urlRegex.test(e)?null:`${s} must be a valid URL`;case"date":const t=new Date(e);return isNaN(t.getTime())?`${s} must be a valid date`:null;default:return null}}};E.emailRegex=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,E.phoneRegex=/^[\+]?[1-9][\d]{0,15}$/,E.urlRegex=/^https?:\/\/.+/,E.sanitizers={trim:e=>"string"==typeof e?e.trim():e,toLowerCase:e=>"string"==typeof e?e.toLowerCase():e,toUpperCase:e=>"string"==typeof e?e.toUpperCase():e,removeSpecialChars:e=>"string"==typeof e?e.replace(/[^a-zA-Z0-9\s]/g,""):e,normalizePhone:e=>"string"==typeof e?e.replace(/\D/g,""):e,normalizeEmail:e=>"string"==typeof e?e.toLowerCase().trim():e,escapeHtml:e=>"string"!=typeof e?e:e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),limitLength:e=>t=>"string"==typeof t?t.substring(0,e):t},E.commonRules={email:{field:"email",required:!0,type:"email",sanitize:E.sanitizers.normalizeEmail},password:{field:"password",required:!0,type:"string",minLength:8,custom:e=>/(?=.*[a-z])/.test(e)?/(?=.*[A-Z])/.test(e)?/(?=.*\d)/.test(e)?null:"Password must contain at least one number":"Password must contain at least one uppercase letter":"Password must contain at least one lowercase letter"},phone:{field:"phone",type:"phone",sanitize:E.sanitizers.normalizePhone},name:{field:"name",required:!0,type:"string",minLength:2,maxLength:50,sanitize:E.sanitizers.trim},currency:{field:"amount",required:!0,type:"number",min:0,custom:e=>e<0?"Amount cannot be negative":e>1e6?"Amount exceeds maximum limit":null}};let D=E;let A=null;const I=()=>{if(A)return A;try{const e=globalThis;if(e&&e.localStorage){const t="__asagents_storage_test__";return e.localStorage.setItem(t,"1"),e.localStorage.removeItem(t),A=e.localStorage,A}}catch(e){console.warn("Falling back to in-memory storage adapter.",e)}return A=(()=>{const e=new Map;return{getItem:t=>e.has(t)?e.get(t):null,setItem(t,s){e.set(t,String(s))},removeItem(t){e.delete(t)},clear(){e.clear()},key:t=>Array.from(e.keys())[t]??null,get length(){return e.size}}})(),A},T=(()=>{if(void 0!==globalThis.crypto)return globalThis.crypto;throw new Error("Secure crypto APIs are not available in this environment.")})(),M=new TextEncoder,R=e=>Array.from(new Uint8Array(e)).map(e=>e.toString(16).padStart(2,"0")).join(""),P=async(e,t)=>{const s=M.encode(`${t}:${e}`),a=await T.subtle.digest("SHA-256",s);return R(a)},L=async e=>{const t=((e=16)=>{const t=new Uint8Array(e);return T.getRandomValues(t),R(t.buffer)})();return{hash:await P(e,t),salt:t}},_=async e=>{if(!e.passwordHash&&!e.passwordSalt&&e.password){const{hash:t,salt:s}=await L(e.password);e.passwordHash=t,e.passwordSalt=s,delete e.password}return e},O=(e=50)=>new Promise(t=>setTimeout(t,e)),U=9e5,F=6048e5,q=e=>e.trim().toLowerCase(),$=e=>e.trim().toUpperCase(),V=new Map,z=I(),H=[["JOIN-CONSTRUCTCO",{companyId:"1",allowedRoles:[x.ADMIN,x.PROJECT_MANAGER,x.FOREMAN,x.OPERATIVE],suggestedRole:x.PROJECT_MANAGER}],["JOIN-RENOVATE",{companyId:"2",allowedRoles:[x.ADMIN,x.PROJECT_MANAGER,x.FOREMAN,x.OPERATIVE],suggestedRole:x.FOREMAN}],["JOIN-CLIENT",{companyId:"3",allowedRoles:[x.CLIENT],suggestedRole:x.CLIENT}]],B=new Map;B.clear(),H.forEach(([e,t])=>{B.set(e,{...t})});const W=e=>{if("function"==typeof btoa)return btoa(e);if("undefined"!=typeof Buffer)return Buffer.from(e,"binary").toString("base64");throw new Error("Base64 encoding is not supported in this environment.")},G=(e,t)=>{const s={...e,iat:Date.now(),exp:Math.floor((Date.now()+t)/1e3)};return`${W(JSON.stringify({alg:"HS256",typ:"JWT"}))}.${W(JSON.stringify(s))}.${W("your-super-secret-key-for-mock-jwt")}`},J=e=>{try{const t=JSON.parse((e=>{if("function"==typeof atob)return atob(e);if("undefined"!=typeof Buffer)return Buffer.from(e,"base64").toString("binary");throw new Error("Base64 decoding is not supported in this environment.")})(e.split(".")[1]));if(1e3*t.exp<Date.now())throw new Error("Token expired");return t}catch(t){return console.error("Token decode/validation failed:",t),null}},Y="asagents_",Q=e=>JSON.parse(JSON.stringify(e)),K=(e,t)=>{try{const s=z.getItem(e);return s?JSON.parse(s):t}catch(s){return console.error(`Failed to read ${e} from storage`,s),t}},Z={companies:Q(k.companies),users:Q(k.users),projects:Q(k.projects),todos:Q(k.todos),timeEntries:Q(k.timeEntries),safetyIncidents:Q(k.safetyIncidents),equipment:Q(k.equipment),clients:Q(k.clients),invoices:Q(k.invoices),expenses:Q(k.expenses||[]),siteUpdates:Q(k.siteUpdates),projectMessages:Q(k.projectMessages),notifications:Q(k.notifications||[]),quotes:Q(k.quotes||[]),auditLogs:[],resourceAssignments:[],conversations:[],messages:[],projectAssignments:[],projectTemplates:[],whiteboardNotes:[],documents:[],projectInsights:Q(k.projectInsights||[]),financialForecasts:Q(k.financialForecasts||[])},ee=e=>{const t=`${Y}${String(e)}`;try{const e=z.getItem(t);if(e)return JSON.parse(e)}catch(a){console.error(`Failed to hydrate ${String(e)} from storage`,a)}const s=Q(Z[e]);return z.setItem(t,JSON.stringify(s)),s};let te={companies:ee("companies"),users:ee("users"),projects:ee("projects"),todos:ee("todos"),timeEntries:ee("timeEntries"),safetyIncidents:ee("safetyIncidents"),equipment:ee("equipment"),clients:ee("clients"),invoices:ee("invoices"),expenses:ee("expenses"),siteUpdates:ee("siteUpdates"),projectMessages:ee("projectMessages"),notifications:ee("notifications"),quotes:ee("quotes"),auditLogs:ee("auditLogs"),resourceAssignments:ee("resourceAssignments"),conversations:ee("conversations"),messages:ee("messages"),projectAssignments:ee("projectAssignments"),projectTemplates:ee("projectTemplates"),whiteboardNotes:ee("whiteboardNotes"),documents:ee("documents"),financialForecasts:ee("financialForecasts"),projectInsights:ee("projectInsights")};const se=()=>{Object.keys(te).forEach(e=>{z.setItem(`${Y}${String(e)}`,JSON.stringify(te[e]))})},ae=e=>{const t=q(e);return te.users.find(e=>e.email&&e.email.toLowerCase()===t)},re=e=>(e=>{const{password:t,passwordHash:s,passwordSalt:a,...r}=e;return r})(e);(()=>{const e=te.users.filter(e=>e.password&&(!e.passwordHash||!e.passwordSalt));0!==e.length&&Promise.all(e.map(e=>_(e))).then(()=>{se()}).catch(e=>console.error("Failed to upgrade legacy user credentials",e))})();(()=>{let e=!1;te.users.forEach(t=>{!t.role||t.permissions&&0!==t.permissions.length||(t.permissions=Array.from(w[t.role]),e=!0)}),e&&se()})();const ie=(e,t,s)=>{const a={id:String(Date.now()+Math.random()),actorId:e,action:t,target:s,timestamp:(new Date).toISOString()};te.auditLogs.push(a),se()},ne={register:async e=>{if(await O(),!e.email||!e.password)throw new Error("Email and password are required.");if(!e.termsAccepted)throw new Error("You must accept the terms and conditions to create an account.");const t=q(e.email);if(ae(t))throw new Error("An account with this email already exists.");const s=e.password.trim();if(![s.length>=8,/[A-Z]/.test(s),/[a-z]/.test(s),/\d/.test(s),/[^A-Za-z0-9]/.test(s)].every(Boolean))throw new Error("Password does not meet the minimum complexity requirements.");const a=e.firstName?.trim(),r=e.lastName?.trim(),i=e.phone?.trim();let n,l,o=e.role||x.OPERATIVE;if("create"===e.companySelection){const t=e.companyName?.trim(),s=e.companyType,a=e.companyEmail?q(e.companyEmail):void 0,r=e.companyPhone?.trim(),i=e.companyWebsite?.trim();if(!t||!s)throw new Error("Company information is incomplete.");const c=String(Date.now());n=c,l={id:n,name:t,type:s,email:a,phone:r,website:i,status:"Active",subscriptionPlan:"FREE",storageUsageGB:0,settings:{theme:"light",accessibility:{highContrast:!1},timeZone:"Europe/London",dateFormat:"DD/MM/YYYY",currency:"GBP",workingHours:{start:"08:00",end:"17:00",workDays:[1,2,3,4,5]},features:{projectManagement:!0,timeTracking:!0,financials:!0,documents:!0,safety:!0,equipment:!0,reporting:!0}},address:{street:"",city:"",state:"",zipCode:"",country:"United Kingdom"},createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString()},te.companies.push(l),B.set(`JOIN-${n}`,{companyId:n,allowedRoles:[x.ADMIN,x.PROJECT_MANAGER,x.FOREMAN,x.OPERATIVE],suggestedRole:x.ADMIN}),o=x.OWNER}else{if("join"!==e.companySelection)throw new Error("Invalid company selection.");{const t=e.inviteToken?$(e.inviteToken):"";if(!t)throw new Error("An invite token is required to join an existing company.");const s=B.get(t);if(!s)throw new Error("Invalid invite token.");if(n=s.companyId,l=te.companies.find(e=>e.id===n),!l)throw new Error("Company not found for invite token.");if(e.role&&!s.allowedRoles.includes(e.role))throw new Error("Selected role is not permitted for this invite.");o=e.role&&s.allowedRoles.includes(e.role)?e.role:s.suggestedRole||s.allowedRoles[0]}}const c=await L(s),d=(new Date).toISOString(),m={id:String(Date.now()+Math.random()),firstName:a,lastName:r,email:t,passwordHash:c.hash,passwordSalt:c.salt,phone:i,role:o,permissions:Array.from(w[o]),companyId:n,isActive:!0,isEmailVerified:!0,mfaEnabled:!1,createdAt:d,updatedAt:d,preferences:{theme:"system",language:"en",notifications:{email:!0,push:!1,sms:!1,taskReminders:!0,projectUpdates:!0,systemAlerts:!0},dashboard:{defaultView:"dashboard",pinnedWidgets:[],hiddenWidgets:[]}}};!1===e.updatesOptIn&&(m.preferences.notifications.projectUpdates=!1),te.users.push(m);const u=l||te.companies.find(e=>e.id===n);u?.name&&(ie(m.id,"USER_REGISTERED",{type:"Company",id:n,name:u.name}),"create"===e.companySelection&&ie(m.id,"COMPANY_CREATED",{type:"Company",id:n,name:u.name})),se();const h=te.users.find(e=>e.id===m.id),p=te.companies.find(e=>e.id===n);return{success:!0,token:G({userId:h.id,companyId:p.id,role:h.role},U),refreshToken:G({userId:h.id},F),user:re(h),company:p}},checkEmailAvailability:async e=>{if(await O(120),!e)return{available:!1};const t=q(e);return{available:!ae(t)}},lookupInviteToken:async e=>{if(await O(200),!e)throw new Error("An invite token is required.");const t=$(e),s=B.get(t);if(!s)throw new Error("Invite token not recognized.");const a=te.companies.find(e=>e.id===s.companyId);if(!a)throw new Error("Company not found for invite token.");return{companyId:a.id,companyName:a.name||"Unnamed Company",companyType:a.type,allowedRoles:s.allowedRoles,suggestedRole:s.suggestedRole}},login:async e=>{await O(200);const t=q(e.email),s=ae(t);if(!s)throw new Error("Invalid email or password.");if(!(!s.password||s.passwordHash&&s.passwordSalt)&&(await _(s),se()),!s.passwordHash||!s.passwordSalt)throw new Error("Invalid email or password.");if(!(await(async(e,t,s)=>((e,t)=>{if(e.length!==t.length)return!1;let s=0;for(let a=0;a<e.length;a++)s|=e.charCodeAt(a)^t.charCodeAt(a);return 0===s})(await P(e,s),t))(e.password,s.passwordHash,s.passwordSalt)))throw new Error("Invalid email or password.");return s.mfaEnabled?{success:!0,mfaRequired:!0,userId:s.id}:ne.finalizeLogin(s.id)},verifyMfa:async(e,t)=>{if(await O(200),"123456"!==t)throw new Error("Invalid MFA code.");return ne.finalizeLogin(e)},finalizeLogin:async e=>{await O();const t=te.users.find(t=>t.id===e);if(!t)throw new Error("User not found during finalization.");const s=te.companies.find(e=>e.id===t.companyId);if(!s)throw new Error("Company not found for user.");return{success:!0,token:G({userId:t.id,companyId:s.id,role:t.role},U),refreshToken:G({userId:t.id},F),user:re(t),company:s}},refreshToken:async e=>{await O();const t=J(e);if(!t)throw new Error("Invalid refresh token");const s=te.users.find(e=>e.id===t.userId);if(!s)throw new Error("User not found for refresh token");return{token:G({userId:s.id,companyId:s.companyId,role:s.role},U)}},me:async e=>{await O();const t=J(e);if(!t)throw new Error("Invalid or expired token");const s=te.users.find(e=>e.id===t.userId),a=te.companies.find(e=>e.id===t.companyId);if(!s||!a)throw new Error("User or company not found");return{user:re(s),company:a}},requestPasswordReset:async e=>{await O(300);const t=e?ae(e):void 0;if(t){const s=`reset-${Date.now()}-${Math.random()}`;V.set(s,{userId:t.id,expires:Date.now()+36e5}),console.log(`Password reset for ${e}. Token: ${s}`)}return{success:!0}},resetPassword:async(e,t)=>{await O(300);const s=V.get(e);if(!s||s.expires<Date.now())throw new Error("Invalid or expired password reset token.");const a=te.users.findIndex(e=>e.id===s.userId);if(-1===a)throw new Error("User not found.");const r=await L(t);return te.users[a].passwordHash=r.hash,te.users[a].passwordSalt=r.salt,delete te.users[a].password,se(),V.delete(e),{success:!0}}};K("asagents_offline_queue",[]),K("asagents_failed_sync_actions",[]);const le=async(e,t,s,a)=>{const r=te.users.findIndex(t=>t.id===e);if(-1===r)throw new Error("User not found");const i={...t};if(i.email&&(i.email=q(i.email)),t?.password){const e=await L(t.password);i.passwordHash=e.hash,i.passwordSalt=e.salt,delete i.password}return te.users[r]={...te.users[r],...i},delete te.users[r].password,void 0!==s&&(te.projectAssignments=te.projectAssignments.filter(t=>t.userId!==e),s.forEach(t=>te.projectAssignments.push({userId:e,projectId:String(t)}))),se(),re(te.users[r])},oe={};var ce={};class de extends Error{constructor(e,t){super(e),this.cause=t,this.name="BackendUnavailableError"}}const me=e=>{if(!e)return null;const t=e.trim();return t?t.replace(/\/+$/,""):null},ue="undefined"!=typeof process&&(ce?.VITEST||ce?.VITEST_WORKER_ID)?null:"undefined"!=typeof window&&"string"==typeof window.__ASAGENTS_API_BASE_URL__?me(window.__ASAGENTS_API_BASE_URL__):void 0!==import.meta&&oe?.VITE_API_BASE_URL?me(void 0):"undefined"!=typeof process&&"string"==typeof ce?.VITE_API_BASE_URL?me(ce.VITE_API_BASE_URL):null;let xe=ue,he=!ue;const pe=(e,t)=>{const s=new Headers(e??{});return s.has("Accept")||s.set("Accept","application/json"),null==t||""===t||s.has("Content-Type")||s.set("Content-Type","application/json"),s},ge=async(e,t,s)=>{if(!xe)return s();try{return await(async(e,t)=>{if(!xe)throw new de("No authentication backend configured.");const s=`${xe}${(e=>e.startsWith("/")?e:`/${e}`)(e)}`;let a;try{a=await fetch(s,{...t,headers:pe(t.headers,t.body??void 0)})}catch(n){throw new de("Unable to reach authentication service.",n)}let r=null;const i=a.headers.get("content-type");if(i&&i.includes("application/json"))r=await a.json();else{const e=await a.text();r=e?{message:e}:{}}if(!a.ok){const e=r?.message||r?.error||`Request failed with status ${a.status}`,t=new Error(e);throw t.status=a.status,t.details=r,t}return r})(e,t)}catch(a){if(a instanceof de){if(he)return console.warn("[authClient] Falling back to local mock authentication.",a),s();const e=new Error("Authentication service is currently unavailable. Please try again later.");throw e.cause=a,e}throw a}},ye=e=>ge("/auth/register",{method:"POST",body:JSON.stringify(e)},()=>ne.register(e)),be=(e,t)=>ge("/auth/mfa/verify",{method:"POST",body:JSON.stringify({userId:e,code:t})},()=>ne.verifyMfa(e,t)),je=e=>ge("/auth/token/refresh",{method:"POST",body:JSON.stringify({refreshToken:e})},()=>ne.refreshToken(e)),fe=e=>ge("/auth/me",{method:"GET",headers:{Authorization:`Bearer ${e}`}},()=>ne.me(e)),ve=e=>ge("/auth/password/request-reset",{method:"POST",body:JSON.stringify({email:e})},()=>ne.requestPasswordReset(e)),Ne=(e,t)=>ge("/auth/password/reset",{method:"POST",body:JSON.stringify({token:e,newPassword:t})},()=>ne.resetPassword(e,t));class we{constructor(){this.loginAttempts=new Map,this.activeSessions=new Map,this.maxLoginAttempts=5,this.lockoutDuration=9e5,this.sessionTimeout=18e5}static getInstance(){return we.instance||(we.instance=new we),we.instance}hasPermission(e,t,s){if(!e)return!1;if(e.role===x.PRINCIPAL_ADMIN)return!0;const a=w[e.role];if(!a)return!1;const r=a.has(t);return r&&s?this.checkContextualPermissions(e,t,s):r}isAccountLocked(e){return(this.loginAttempts.get(e)||[]).filter(e=>!e.success&&Date.now()-e.timestamp<this.lockoutDuration).length>=this.maxLoginAttempts}recordLoginAttempt(e,t,s){const a=this.loginAttempts.get(e)||[];a.push({email:e,timestamp:Date.now(),success:t,...s});const r=Date.now()-864e5,i=a.filter(e=>e.timestamp>r);this.loginAttempts.set(e,i)}validatePasswordStrength(e){const t=[];return e.length<8&&t.push("Password must be at least 8 characters long"),/[a-z]/.test(e)||t.push("Password must contain at least one lowercase letter"),/[A-Z]/.test(e)||t.push("Password must contain at least one uppercase letter"),/\d/.test(e)||t.push("Password must contain at least one number"),/[!@#$%^&*(),.?":{}|<>]/.test(e)||t.push("Password must contain at least one special character"),this.isCommonPassword(e)&&t.push("Password is too common, please choose a more unique password"),{isValid:0===t.length,errors:t}}createSession(e,t){const s=this.generateSessionId(),a=new Set(w[e.role]||[]),r={user:e,sessionId:s,lastActivity:Date.now(),permissions:a,...t};return this.activeSessions.set(s,r),this.cleanupExpiredSessions(),s}validateSession(e){const t=this.activeSessions.get(e);return t?Date.now()-t.lastActivity>this.sessionTimeout?(this.activeSessions.delete(e),null):(t.lastActivity=Date.now(),t):null}revokeSession(e){return this.activeSessions.delete(e)}revokeAllUserSessions(e){let t=0;for(const[s,a]of this.activeSessions.entries())a.user.id===e&&(this.activeSessions.delete(s),t++);return t}getSecurityMetrics(){const e=Date.now()-36e5;let t=0,s=0,a=0;for(const r of this.loginAttempts.values()){const i=r.filter(t=>t.timestamp>e);t+=i.length,s+=i.filter(e=>!e.success).length;i.filter(e=>!e.success).length>=this.maxLoginAttempts&&a++}return{activeSessions:this.activeSessions.size,totalLoginAttempts:t,failedLoginAttempts:s,lockedAccounts:a,successRate:t>0?(t-s)/t*100:100}}checkContextualPermissions(e,t,s){return t===h.MANAGE_TEAM&&s.userId?e.id===s.userId||this.hasPermission(e,h.MANAGE_TEAM):(t===h.VIEW_ALL_PROJECTS&&s.projectId,!0)}isCommonPassword(e){return["password","123456","123456789","qwerty","abc123","password123","admin","letmein","welcome","monkey"].includes(e.toLowerCase())}generateSessionId(){const e=new Uint8Array(32);return crypto.getRandomValues(e),Array.from(e,e=>e.toString(16).padStart(2,"0")).join("")}cleanupExpiredSessions(){const e=Date.now();for(const[t,s]of this.activeSessions.entries())e-s.lastActivity>this.sessionTimeout&&this.activeSessions.delete(t)}}const ke=(e,t)=>we.getInstance().hasPermission(e,t),Se=we.getInstance();class Ce{constructor(){this.events=[],this.metrics=[],this.batchSize=50,this.flushInterval=3e4,this.maxRetries=3,this.currentSession=this.createSession(),this.setupPerformanceMonitoring(),this.setupAutoFlush(),this.setupPageVisibilityTracking()}static getInstance(){return Ce.instance||(Ce.instance=new Ce),Ce.instance}track(e,t){const s={name:e,properties:this.sanitizeProperties(t),timestamp:Date.now(),userId:this.getCurrentUserId(),sessionId:this.currentSession.id,metadata:{url:window.location.href,userAgent:navigator.userAgent,viewport:`${window.innerWidth}x${window.innerHeight}`}};this.events.push(s),this.currentSession.events.push(s),this.updateSessionActivity(),this.events.length>=this.batchSize&&this.flush()}trackPageView(e,t){this.track("page_view",{path:e,title:t||document.title,referrer:document.referrer}),this.currentSession.pageViews++}trackClick(e,t){this.track("click",{element:e,...t})}trackFormSubmit(e,t,s){this.track("form_submit",{form_name:e,success:t,errors:s})}trackSearch(e,t,s){this.track("search",{query:e,results_count:t,filters:s})}trackError(e,t){this.track("error",{error_name:e.name,error_message:e.message,error_stack:e.stack,context:t})}trackPerformance(e,t,s,a){const r={name:e,value:t,unit:s,timestamp:Date.now(),tags:a};this.metrics.push(r),this.metrics.length>=this.batchSize&&this.flushMetrics()}trackLoadTime(e,t){this.trackPerformance("page_load_time",t,"ms",{page:e})}trackApiCall(e,t,s,a){this.trackPerformance("api_call_duration",s,"ms",{endpoint:e,method:t,status:a.toString()})}identify(e,t){this.currentSession.userId=e,this.track("identify",{user_id:e,traits:this.sanitizeProperties(t)})}startNewSession(){this.endCurrentSession(),this.currentSession=this.createSession()}endCurrentSession(){this.track("session_end",{session_duration:Date.now()-this.currentSession.startTime,page_views:this.currentSession.pageViews,events_count:this.currentSession.events.length}),this.flush()}getSessionData(){return{...this.currentSession}}getEventsSummary(e){const t=e?this.events.filter(t=>t.timestamp>=e.start&&t.timestamp<=e.end):this.events,s=t.reduce((e,t)=>(e[t.name]=(e[t.name]||0)+1,e),{});return{totalEvents:t.length,eventTypes:Object.keys(s).length,breakdown:s}}getPerformanceMetrics(e){const t=e?this.metrics.filter(t=>t.name===e):this.metrics;if(0===t.length)return null;const s=t.map(e=>e.value);return{count:t.length,min:Math.min(...s),max:Math.max(...s),avg:s.reduce((e,t)=>e+t,0)/s.length,p95:this.percentile(s,95),p99:this.percentile(s,99)}}async flush(){if(0===this.events.length)return;const e=[...this.events];this.events=[];try{await this.sendEvents(e)}catch(t){console.error("Failed to send analytics events:",t),this.events.unshift(...e)}}async flushMetrics(){if(0===this.metrics.length)return;const e=[...this.metrics];this.metrics=[];try{await this.sendMetrics(e)}catch(t){console.error("Failed to send performance metrics:",t),this.metrics.unshift(...e)}}createSession(){return{id:this.generateSessionId(),startTime:Date.now(),lastActivity:Date.now(),pageViews:0,events:[],userAgent:navigator.userAgent,referrer:document.referrer}}updateSessionActivity(){this.currentSession.lastActivity=Date.now()}getCurrentUserId(){return this.currentSession.userId}generateSessionId(){return`${Date.now()}-${Math.random().toString(36).substr(2,9)}`}sanitizeProperties(e){if(!e)return;const t={};for(const[s,a]of Object.entries(e))"function"!=typeof a&&void 0!==a&&("string"==typeof a&&a.length>1e3?t[s]=a.substring(0,1e3)+"...":t[s]=a);return t}setupPerformanceMonitoring(){if("performance"in window&&"getEntriesByType"in performance&&window.addEventListener("load",()=>{setTimeout(()=>{const e=performance.getEntriesByType("navigation")[0];e&&this.trackLoadTime("initial_page_load",e.loadEventEnd-e.fetchStart)},0)}),"PerformanceObserver"in window)try{new PerformanceObserver(e=>{for(const t of e.getEntries())this.trackPerformance("long_task",t.duration,"ms")}).observe({entryTypes:["longtask"]})}catch(e){console.warn("Long task monitoring not supported")}}setupAutoFlush(){setInterval(()=>{this.flush(),this.flushMetrics()},this.flushInterval),window.addEventListener("beforeunload",()=>{this.endCurrentSession()})}setupPageVisibilityTracking(){document.addEventListener("visibilitychange",()=>{document.hidden?this.track("page_hidden"):(this.track("page_visible"),this.updateSessionActivity())})}async sendEvents(e){console.log("Sending analytics events:",e),await new Promise(e=>setTimeout(e,100))}async sendMetrics(e){console.log("Sending performance metrics:",e),await new Promise(e=>setTimeout(e,100))}percentile(e,t){const s=[...e].sort((e,t)=>e-t);return s[Math.ceil(t/100*s.length)-1]}}const Ee=Ce.getInstance();I();const De=a.createContext(void 0);let Ae=null;const Ie=({children:e})=>{const[t,s]=a.useState({isAuthenticated:!1,token:null,refreshToken:null,user:null,company:null,loading:!0,error:null}),r=I(),i=a.useCallback(()=>{r.removeItem("token"),r.removeItem("refreshToken"),Ae&&clearTimeout(Ae),s({isAuthenticated:!1,token:null,refreshToken:null,user:null,company:null,loading:!1,error:null})},[]),n=e=>{Ae&&clearTimeout(Ae);const t=(e=>{try{return JSON.parse(atob(e.split(".")[1]))}catch(t){return null}})(e);if(t&&t.exp){const a=1e3*t.exp-Date.now()-6e4;a>0?Ae=setTimeout(async()=>{const t=r.getItem("refreshToken");if(t)try{console.log("Proactively refreshing token...");const{token:a}=await je(t);r.setItem("token",a),s(e=>({...e,token:a})),a!==e&&n(a)}catch(a){console.error("Proactive token refresh failed",a),r.removeItem("token"),r.removeItem("refreshToken"),Ae&&clearTimeout(Ae),s({isAuthenticated:!1,token:null,refreshToken:null,user:null,company:null,loading:!1,error:null})}},a):(console.warn("Token is already expired or has less than a minute left. Logging out."),r.removeItem("token"),r.removeItem("refreshToken"),Ae&&clearTimeout(Ae),s({isAuthenticated:!1,token:null,refreshToken:null,user:null,company:null,loading:!1,error:null}))}},l=a.useCallback(e=>{r.setItem("token",e.token),r.setItem("refreshToken",e.refreshToken),s({isAuthenticated:!0,token:e.token,refreshToken:e.refreshToken,user:e.user,company:e.company,loading:!1,error:null}),n(e.token)},[]);a.useEffect(()=>((async()=>{const e=r.getItem("token"),t=r.getItem("refreshToken");if(e&&t)try{const{user:s,company:a}=await fe(e);l({token:e,refreshToken:t,user:s,company:a})}catch(a){console.log("Access token invalid, attempting reactive refresh...");try{const{token:e}=await je(t),{user:s,company:a}=await fe(e);l({token:e,refreshToken:t,user:s,company:a})}catch(i){console.error("Auth init with refresh token failed, clearing auth state.",i),r.removeItem("token"),r.removeItem("refreshToken"),s({isAuthenticated:!1,token:null,refreshToken:null,user:null,company:null,loading:!1,error:null})}}else s(e=>({...e,loading:!1}))})(),()=>{Ae&&clearTimeout(Ae)}),[]);const o={...t,login:async e=>{s(e=>({...e,loading:!0,error:null}));const t=D.validate(e,[{field:"email",required:!0,type:"email",sanitize:D.sanitizers.normalizeEmail},{field:"password",required:!0,type:"string",minLength:1}]);if(!t.isValid){const e=new Error(`Invalid credentials: ${Object.values(t.errors).flat().join(", ")}`);throw s(t=>({...t,loading:!1,error:e.message})),e}if(Se.isAccountLocked(e.email)){const t=new Error("Account temporarily locked due to multiple failed login attempts");throw s(e=>({...e,loading:!1,error:t.message})),Se.recordLoginAttempt(e.email,!1,{ipAddress:"unknown",userAgent:navigator.userAgent}),t}try{const a=await ne.login(t.sanitizedData);return Se.recordLoginAttempt(e.email,!0,{ipAddress:"unknown",userAgent:navigator.userAgent}),a.mfaRequired?(s(e=>({...e,loading:!1})),{mfaRequired:!0,userId:a.userId}):(l(a),{mfaRequired:!1})}catch(a){throw Se.recordLoginAttempt(e.email,!1,{ipAddress:"unknown",userAgent:navigator.userAgent}),Ee.trackError(a,{operation:"login",email:e.email}),s(e=>({...e,token:null,refreshToken:null,user:null,company:null,isAuthenticated:!1,loading:!1,error:a.message||"Login failed"})),a}},register:async e=>{s(e=>({...e,loading:!0,error:null}));try{const t=await ye(e);return l(t),t}catch(t){throw s(e=>({...e,loading:!1,error:t.message||"Registration failed"})),t}},logout:i,hasPermission:e=>ke(t.user,e),verifyMfaAndFinalize:async(e,t)=>{s(e=>({...e,loading:!0,error:null}));try{const s=await be(e,t);l(s)}catch(a){throw s(e=>({...e,loading:!1,error:a.message||"MFA verification failed"})),a}},updateUserProfile:async e=>{if(!t.user)throw new Error("Not authenticated");const a=await le(t.user.id,e,void 0,t.user.id);s(e=>({...e,user:{...e.user,...a}}))},requestPasswordReset:async e=>{s(e=>({...e,loading:!0,error:null}));try{await ve(e),s(e=>({...e,loading:!1}))}catch(t){throw s(e=>({...e,loading:!1,error:t.message||"Request failed"})),t}},resetPassword:async(e,t)=>{s(e=>({...e,loading:!0,error:null}));try{await Ne(e,t),s(e=>({...e,loading:!1}))}catch(a){throw s(e=>({...e,loading:!1,error:a.message||"Password reset failed"})),a}}};return d.jsx(De.Provider,{value:o,children:e})},Te=()=>{const e=a.useContext(De);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e},Me=({children:e,className:t="",...s})=>d.jsx("div",{className:`bg-card text-card-foreground rounded-[--radius] border border-border p-6 shadow-sm transition-all duration-300 ${t}`,...s,children:e}),Re=({size:e})=>d.jsxs("svg",{className:`animate-spin ${{sm:"h-4 w-4",md:"h-5 w-5",lg:"h-6 w-6"}[e]}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[d.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),d.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),Pe=({children:e,variant:t="primary",size:s="md",className:a="",isLoading:r=!1,...i})=>d.jsx("button",{className:`inline-flex items-center justify-center rounded-md font-semibold focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:opacity-60 disabled:cursor-not-allowed transition-all duration-200 transform hover:scale-[1.02] active:scale-[0.98] ${{primary:"bg-primary text-primary-foreground hover:bg-primary/90 shadow-sm",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 border border-border",success:"bg-green-600 hover:bg-green-700 focus:ring-green-500 text-white shadow-sm",danger:"bg-destructive text-destructive-foreground hover:bg-destructive/90 shadow-sm",ghost:"bg-transparent hover:bg-accent focus:ring-ring text-accent-foreground"}[t]} ${{sm:"px-3 py-1.5 text-xs h-9",md:"px-5 py-2 text-sm h-10",lg:"px-6 py-3 text-base h-12"}[s]} ${a}`,...i,disabled:i.disabled||r,children:r?d.jsx(Re,{size:s}):e}),Le="asagents_remembered_email",_e=I(),Oe=(e,t)=>{try{e&&t?_e.setItem(Le,(e=>e.trim().toLowerCase())(t)):_e.removeItem(Le)}catch(s){console.warn("Unable to persist remembered email",s)}},Ue=({align:e="center",className:t=""})=>{const s="left"===e?"text-left":"text-center";return d.jsx("p",{className:`text-xs text-muted-foreground ${s} ${t}`.trim(),children:"Operating in secure offline demo mode. Accounts are stored locally in your browser."})},Fe=({onSwitchToRegister:e,onSwitchToForgotPassword:t})=>{const{login:s,verifyMfaAndFinalize:r,error:i,loading:n}=Te(),[l,o]=a.useState("credentials"),c=(()=>{try{return _e.getItem(Le)||""}catch(v){return console.warn("Unable to read remembered email",v),""}})(),[m,u]=a.useState(c),[x,h]=a.useState(""),[p,g]=a.useState(""),[y,b]=a.useState(""!==c),[j,f]=a.useState(!1),[v,N]=a.useState(null),[w,k]=a.useState({}),[S,C]=a.useState(null),E=a.useRef(null);a.useEffect(()=>{N(i)},[i]),a.useEffect(()=>{y||Oe(!1,"")},[y]),a.useEffect(()=>{"mfa"===l&&E.current?.focus()},[l]);const D=e=>{k(t=>{if(!t[e])return t;const s={...t};return delete s[e],s})},A=async e=>{e.preventDefault(),N(null);const t={},a=m.trim();if((e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e))(a)||(t.email="Please enter a valid email."),x.length<6&&(t.password="Password is too short."),k(t),!(Object.keys(t).length>0))try{u(a);const e=await s({email:a,password:x,rememberMe:y});e.mfaRequired&&e.userId?(C(e.userId),o("mfa"),g(""),k(e=>{if(!e.mfa)return e;const t={...e};return delete t.mfa,t})):Oe(y,a.toLowerCase()),h("")}catch(r){}},I=async e=>{if(e.preventDefault(),N(null),6===p.length)try{if(!S)throw new Error("User ID not found");await r(S,p),Oe(y,m.trim().toLowerCase()),g("")}catch(t){}else k({mfa:"Code must be 6 digits."})};return d.jsxs("div",{className:"min-h-screen bg-background flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[d.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md text-center",children:[d.jsxs("div",{className:"inline-flex items-center justify-center gap-2 mb-2",children:[d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"w-10 h-10 text-primary",children:d.jsx("path",{fill:"currentColor",d:"M12 2L2 22h20L12 2z"})}),d.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"AS Agents"})]}),d.jsx("h2",{className:"text-muted-foreground",children:"Sign in to your account"})]}),d.jsxs(Me,{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:[d.jsx(Ue,{className:"mb-4"}),v&&d.jsx("div",{className:"mb-4 p-3 bg-destructive/10 text-destructive text-sm rounded-md border border-destructive/20",children:v}),"credentials"===l?d.jsxs("form",{onSubmit:A,className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-muted-foreground",children:"Email Address"}),d.jsx("input",{id:"email",type:"email",value:m,onChange:e=>{u(e.target.value),D("email"),N(null)},required:!0,autoComplete:"email",className:"mt-1 block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm "+(w.email?"border-destructive":"border-border")}),w.email&&d.jsx("p",{className:"text-xs text-destructive mt-1",children:w.email})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-muted-foreground",children:"Password"}),d.jsxs("div",{className:"relative mt-1",children:[d.jsx("input",{id:"password",type:j?"text":"password",value:x,onChange:e=>{h(e.target.value),D("password"),N(null)},required:!0,autoComplete:"current-password",className:"block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm pr-12 "+(w.password?"border-destructive":"border-border")}),d.jsx("button",{type:"button",onClick:()=>f(e=>!e),className:"absolute inset-y-0 right-2 flex items-center text-xs font-medium text-muted-foreground hover:text-foreground","aria-label":j?"Hide password":"Show password",children:j?"Hide":"Show"})]}),w.password&&d.jsx("p",{className:"text-xs text-destructive mt-1",children:w.password})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{id:"remember-me",type:"checkbox",checked:y,onChange:e=>b(e.target.checked),className:"h-4 w-4 text-primary focus:ring-ring border-border rounded"}),d.jsx("label",{htmlFor:"remember-me",className:"ml-2 block text-sm text-muted-foreground",children:"Remember me"})]}),d.jsx("div",{className:"text-sm",children:d.jsx("button",{type:"button",onClick:t,className:"font-medium text-primary hover:text-primary/90",children:"Forgot your password?"})})]}),d.jsx("div",{children:d.jsx(Pe,{type:"submit",className:"w-full",isLoading:n,children:"Sign in"})})]}):d.jsxs("form",{onSubmit:I,className:"space-y-6",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("h3",{className:"text-lg font-medium text-foreground",children:"Two-Factor Authentication"}),d.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Enter the 6-digit code from your authenticator app."})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"mfa",className:"sr-only",children:"Authentication Code"}),d.jsx("input",{id:"mfa",type:"text",ref:E,value:p,onChange:e=>{const t=e.target.value.replace(/\D/g,"");g(t),D("mfa"),N(null)},maxLength:6,required:!0,inputMode:"numeric",autoComplete:"one-time-code",className:"block w-full text-center text-2xl tracking-[0.5em] px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary "+(w.mfa?"border-destructive":"border-border")}),w.mfa&&d.jsx("p",{className:"text-xs text-destructive mt-1 text-center",children:w.mfa})]}),d.jsx("div",{children:d.jsx(Pe,{type:"submit",className:"w-full",isLoading:n,children:"Verify"})}),d.jsx("div",{className:"text-center",children:d.jsx("button",{type:"button",onClick:()=>o("credentials"),className:"text-sm font-medium text-primary hover:text-primary/90",children:"Back to login"})})]})]}),d.jsxs("p",{className:"mt-6 text-center text-sm text-muted-foreground",children:["Not a member?"," ",d.jsx("button",{onClick:e,className:"font-semibold text-primary hover:text-primary/80",children:"Create an account"})]})]})},qe=({view:e,label:t,icon:s,activeView:a,setActiveView:r,badgeCount:i})=>d.jsxs("button",{onClick:()=>r(e),className:"w-full flex items-center justify-between gap-3 px-3 py-2 rounded-md text-sm transition-colors "+(a===e?"bg-primary text-primary-foreground font-semibold shadow":"text-muted-foreground hover:bg-accent hover:text-accent-foreground"),children:[d.jsxs("div",{className:"flex items-center gap-3",children:[s,d.jsx("span",{children:t})]}),i&&i>0&&d.jsx("span",{className:"ml-auto bg-red-500 text-white text-xs font-bold px-2 py-0.5 rounded-full",children:i>99?"99+":i})]}),$e=({user:e,activeView:t,setActiveView:s,onLogout:a,pendingTimesheetCount:r=0,openIncidentCount:i=0,unreadMessageCount:n=0,companyName:l})=>e?d.jsxs("aside",{className:"w-64 bg-card border-r border-border flex flex-col flex-shrink-0 h-full p-4",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-6 px-2",children:[d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",className:"w-8 h-8 text-primary",children:d.jsx("path",{fill:"currentColor",d:"M12 2L2 22h20L12 2z"})}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-xl font-bold text-foreground",children:"AS Agents"}),l&&d.jsx("p",{className:"text-xs text-muted-foreground",children:l})]})]}),d.jsxs("nav",{className:"flex flex-col gap-2",children:[d.jsx(qe,{view:"dashboard",label:"Dashboard",icon:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),activeView:t,setActiveView:s}),d.jsx(qe,{view:"tools",label:"Tools",icon:d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924-1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),activeView:t,setActiveView:s,badgeCount:n}),d.jsx(qe,{view:"timesheets",label:"Timesheets",icon:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),activeView:t,setActiveView:s,badgeCount:r}),d.jsx(qe,{view:"safety-dashboard",label:"Safety",icon:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),activeView:t,setActiveView:s,badgeCount:i}),d.jsx(qe,{view:"equipment-dashboard",label:"Equipment",icon:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),activeView:t,setActiveView:s}),d.jsx(qe,{view:"field",label:"Field Management",icon:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002-2h2a2 2 0 002 2m-6 8l2 2 4-4"})}),activeView:t,setActiveView:s}),d.jsx(qe,{view:"document-management",label:"Document Control",icon:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),activeView:t,setActiveView:s}),d.jsx(qe,{view:"project-analytics",label:"Project Analytics",icon:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),activeView:t,setActiveView:s}),d.jsx(qe,{view:"advanced-reporting",label:"Advanced Reports",icon:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),activeView:t,setActiveView:s}),d.jsx(qe,{view:"collaboration",label:"Team Collaboration",icon:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),activeView:t,setActiveView:s}),d.jsx(qe,{view:"quality-control",label:"Quality Control",icon:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),activeView:t,setActiveView:s}),d.jsx(qe,{view:"user-management",label:"User Management",icon:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"})}),activeView:t,setActiveView:s}),d.jsx(qe,{view:"templates-dashboard",label:"Templates",icon:d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),activeView:t,setActiveView:s}),d.jsx("div",{className:"mt-4 border-t border-border pt-4",children:d.jsx(qe,{view:"settings-dashboard",label:"Settings",icon:d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924-1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),activeView:t,setActiveView:s})})]}),d.jsx("div",{className:"mt-6",children:d.jsxs("button",{onClick:a,className:"flex w-full items-center justify-center gap-2 rounded-xl border border-red-200/70 bg-red-500/10 px-3 py-2 text-sm font-semibold text-red-600 transition hover:bg-red-500/20",children:[d.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"h-5 w-5",fill:"none",stroke:"currentColor",strokeWidth:2,children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 7l-5 5 5 5M4 12h11"})}),"Sign out"]})})]}):null,Ve=({name:e})=>d.jsxs(Me,{className:"p-6",children:[d.jsx("h3",{className:"font-semibold text-lg",children:e}),d.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"This tool will be restored next."})]}),ze=({user:e,addToast:t,setActiveView:s})=>{const[r,i]=a.useState(null),n=[{id:"ai-advisor",name:"AI Advisor",description:"Chat with an AI expert on project management.",icon:"",component:d.jsx(Ve,{name:"AI Advisor"}),permission:!0},{id:"bid-generator",name:"Bid Package Generator",description:"Generate professional bid packages and cover letters.",icon:"",component:d.jsx(Ve,{name:"Bid Package Generator"}),permission:!0},{id:"cost-estimator",name:"Cost Estimator",description:"Estimate project costs based on specifications.",icon:"",component:d.jsx(Ve,{name:"Cost Estimator"}),permission:!0},{id:"daily-summary",name:"Daily Summary Generator",description:"AI-powered daily progress reports.",icon:"",component:d.jsx(Ve,{name:"Daily Summary Generator"}),permission:!0},{id:"funding-bot",name:"FundingBot",description:"Discover grants and funding opportunities.",icon:"",component:d.jsx(Ve,{name:"FundingBot"}),permission:!0},{id:"risk-bot",name:"RiskBot",description:"Analyze documents for compliance and financial risks.",icon:"",component:d.jsx(Ve,{name:"RiskBot"}),permission:!0},{id:"safety-analysis",name:"Safety Analysis",description:"Identify trends from safety incident reports.",icon:"",component:d.jsx(Ve,{name:"Safety Analysis"}),permission:!0},{id:"site-inspector",name:"AI Site Inspector",description:"Analyze site photos for progress and hazards.",icon:"",component:d.jsx(Ve,{name:"AI Site Inspector"}),permission:!0},{id:"workforce-planner",name:"Workforce Planner",description:"Plan and allocate personnel to projects.",icon:"",component:d.jsx(Ve,{name:"Workforce Planner"}),permission:ke(e,h.MANAGE_TEAM)},{id:"resource-scheduler",name:"Resource Scheduler",description:"View team and equipment schedules.",icon:"",component:d.jsx(Ve,{name:"Resource Scheduler"}),permission:ke(e,h.MANAGE_EQUIPMENT)}].filter(e=>e.permission),l=n.find(e=>e.id===r);return l?d.jsxs("div",{children:[d.jsx("button",{onClick:()=>i(null),className:"flex items-center gap-2 text-sm text-slate-600 hover:text-slate-900 mb-4",children:" Back to all tools"}),l.component]}):d.jsxs("div",{className:"space-y-6",children:[d.jsx("h2",{className:"text-3xl font-bold text-slate-800",children:"Tools"}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(e=>d.jsxs(Me,{onClick:()=>i(e.id),className:"cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-all",children:[d.jsx("div",{className:"text-3xl mb-2",children:e.icon}),d.jsx("h3",{className:"font-bold text-lg",children:e.name}),d.jsx("p",{className:"text-sm text-slate-600",children:e.description})]},e.id))})]})};var He,Be,We={exports:{}},Ge={};function Je(){if(He)return Ge;He=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),n=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),o=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),m=Symbol.iterator;var u={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,h={};function p(e,t,s){this.props=e,this.context=t,this.refs=h,this.updater=s||u}function g(){}function y(e,t,s){this.props=e,this.context=t,this.refs=h,this.updater=s||u}p.prototype.isReactComponent={},p.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},p.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},g.prototype=p.prototype;var b=y.prototype=new g;b.constructor=y,x(b,p.prototype),b.isPureReactComponent=!0;var j=Array.isArray,f={H:null,A:null,T:null,S:null,V:null},v=Object.prototype.hasOwnProperty;function N(t,s,a,r,i,n){return a=n.ref,{$$typeof:e,type:t,key:s,ref:void 0!==a?a:null,props:n}}function w(t){return"object"==typeof t&&null!==t&&t.$$typeof===e}var k=/\/+/g;function S(e,t){return"object"==typeof e&&null!==e&&null!=e.key?(s=""+e.key,a={"=":"=0",":":"=2"},"$"+s.replace(/[=:]/g,function(e){return a[e]})):t.toString(36);var s,a}function C(){}function E(s,a,r,i,n){var l=typeof s;"undefined"!==l&&"boolean"!==l||(s=null);var o,c,u=!1;if(null===s)u=!0;else switch(l){case"bigint":case"string":case"number":u=!0;break;case"object":switch(s.$$typeof){case e:case t:u=!0;break;case d:return E((u=s._init)(s._payload),a,r,i,n)}}if(u)return n=n(s),u=""===i?"."+S(s,0):i,j(n)?(r="",null!=u&&(r=u.replace(k,"$&/")+"/"),E(n,a,r,"",function(e){return e})):null!=n&&(w(n)&&(o=n,c=r+(null==n.key||s&&s.key===n.key?"":(""+n.key).replace(k,"$&/")+"/")+u,n=N(o.type,c,void 0,0,0,o.props)),a.push(n)),1;u=0;var x,h=""===i?".":i+":";if(j(s))for(var p=0;p<s.length;p++)u+=E(i=s[p],a,r,l=h+S(i,p),n);else if("function"==typeof(p=null===(x=s)||"object"!=typeof x?null:"function"==typeof(x=m&&x[m]||x["@@iterator"])?x:null))for(s=p.call(s),p=0;!(i=s.next()).done;)u+=E(i=i.value,a,r,l=h+S(i,p++),n);else if("object"===l){if("function"==typeof s.then)return E(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"==typeof e.status?e.then(C,C):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(s),a,r,i,n);throw a=String(s),Error("Objects are not valid as a React child (found: "+("[object Object]"===a?"object with keys {"+Object.keys(s).join(", ")+"}":a)+"). If you meant to render a collection of children, use an array instead.")}return u}function D(e,t,s){if(null==e)return e;var a=[],r=0;return E(e,a,"","",function(e){return t.call(s,e,r++)}),a}function A(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var I="function"==typeof reportError?reportError:function(e){if("object"==typeof window&&"function"==typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"==typeof e&&null!==e&&"string"==typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"==typeof process&&"function"==typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)};function T(){}return Ge.Children={map:D,forEach:function(e,t,s){D(e,function(){t.apply(this,arguments)},s)},count:function(e){var t=0;return D(e,function(){t++}),t},toArray:function(e){return D(e,function(e){return e})||[]},only:function(e){if(!w(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},Ge.Component=p,Ge.Fragment=s,Ge.Profiler=r,Ge.PureComponent=y,Ge.StrictMode=a,Ge.Suspense=o,Ge.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=f,Ge.__COMPILER_RUNTIME={__proto__:null,c:function(e){return f.H.useMemoCache(e)}},Ge.cache=function(e){return function(){return e.apply(null,arguments)}},Ge.cloneElement=function(e,t,s){if(null==e)throw Error("The argument must be a React element, but you passed "+e+".");var a=x({},e.props),r=e.key;if(null!=t)for(i in void 0!==t.ref&&void 0,void 0!==t.key&&(r=""+t.key),t)!v.call(t,i)||"key"===i||"__self"===i||"__source"===i||"ref"===i&&void 0===t.ref||(a[i]=t[i]);var i=arguments.length-2;if(1===i)a.children=s;else if(1<i){for(var n=Array(i),l=0;l<i;l++)n[l]=arguments[l+2];a.children=n}return N(e.type,r,void 0,0,0,a)},Ge.createContext=function(e){return(e={$$typeof:n,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:i,_context:e},e},Ge.createElement=function(e,t,s){var a,r={},i=null;if(null!=t)for(a in void 0!==t.key&&(i=""+t.key),t)v.call(t,a)&&"key"!==a&&"__self"!==a&&"__source"!==a&&(r[a]=t[a]);var n=arguments.length-2;if(1===n)r.children=s;else if(1<n){for(var l=Array(n),o=0;o<n;o++)l[o]=arguments[o+2];r.children=l}if(e&&e.defaultProps)for(a in n=e.defaultProps)void 0===r[a]&&(r[a]=n[a]);return N(e,i,void 0,0,0,r)},Ge.createRef=function(){return{current:null}},Ge.forwardRef=function(e){return{$$typeof:l,render:e}},Ge.isValidElement=w,Ge.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:A}},Ge.memo=function(e,t){return{$$typeof:c,type:e,compare:void 0===t?null:t}},Ge.startTransition=function(e){var t=f.T,s={};f.T=s;try{var a=e(),r=f.S;null!==r&&r(s,a),"object"==typeof a&&null!==a&&"function"==typeof a.then&&a.then(T,I)}catch(i){I(i)}finally{f.T=t}},Ge.unstable_useCacheRefresh=function(){return f.H.useCacheRefresh()},Ge.use=function(e){return f.H.use(e)},Ge.useActionState=function(e,t,s){return f.H.useActionState(e,t,s)},Ge.useCallback=function(e,t){return f.H.useCallback(e,t)},Ge.useContext=function(e){return f.H.useContext(e)},Ge.useDebugValue=function(){},Ge.useDeferredValue=function(e,t){return f.H.useDeferredValue(e,t)},Ge.useEffect=function(e,t,s){var a=f.H;if("function"==typeof s)throw Error("useEffect CRUD overload is not enabled in this build of React.");return a.useEffect(e,t)},Ge.useId=function(){return f.H.useId()},Ge.useImperativeHandle=function(e,t,s){return f.H.useImperativeHandle(e,t,s)},Ge.useInsertionEffect=function(e,t){return f.H.useInsertionEffect(e,t)},Ge.useLayoutEffect=function(e,t){return f.H.useLayoutEffect(e,t)},Ge.useMemo=function(e,t){return f.H.useMemo(e,t)},Ge.useOptimistic=function(e,t){return f.H.useOptimistic(e,t)},Ge.useReducer=function(e,t,s){return f.H.useReducer(e,t,s)},Ge.useRef=function(e){return f.H.useRef(e)},Ge.useState=function(e){return f.H.useState(e)},Ge.useSyncExternalStore=function(e,t,s){return f.H.useSyncExternalStore(e,t,s)},Ge.useTransition=function(){return f.H.useTransition()},Ge.version="19.1.1",Ge}var Ye=(Be||(Be=1,We.exports=Je()),We.exports);
/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,s)=>s?s.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},Xe=(...e)=>e.filter((e,t,s)=>Boolean(e)&&""!==e.trim()&&s.indexOf(e)===t).join(" ").trim(),Ke=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};
/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var Ze={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=Ye.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:r="",children:i,iconNode:n,...l},o)=>Ye.createElement("svg",{ref:o,...Ze,width:t,height:t,stroke:e,strokeWidth:a?24*Number(s)/Number(t):s,className:Xe("lucide",r),...!i&&!Ke(l)&&{"aria-hidden":"true"},...l},[...n.map(([e,t])=>Ye.createElement(e,t)),...Array.isArray(i)?i:[i]])),tt=(e,t)=>{const s=Ye.forwardRef(({className:s,...a},r)=>{return Ye.createElement(et,{ref:r,iconNode:t,className:Xe(`lucide-${i=Qe(e),i.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,s),...a});var i});return s.displayName=Qe(e),s},st=tt("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),at=tt("at-sign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]),rt=tt("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),it=tt("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),nt=tt("building",[["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M9 22v-3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v3",key:"cabbwy"}],["rect",{x:"4",y:"2",width:"16",height:"20",rx:"2",key:"1uxh74"}]]),lt=tt("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),ot=tt("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),ct=tt("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),dt=tt("chart-line",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]]),mt=tt("chart-pie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]),ut=tt("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),xt=tt("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),ht=tt("clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]),pt=tt("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),gt=tt("compass",[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),yt=tt("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),bt=tt("crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]),jt=tt("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),ft=tt("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),vt=tt("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),Nt=tt("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),wt=tt("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),kt=tt("flag",[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]]),St=tt("folder-open",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]),Ct=tt("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]),Et=tt("gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]),Dt=tt("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]),At=tt("grid-3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),It=tt("hard-hat",[["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M14 6a6 6 0 0 1 6 6v3",key:"1hnv84"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6",key:"9ciidu"}],["rect",{x:"2",y:"15",width:"20",height:"4",rx:"1",key:"g3x8cw"}]]),Tt=tt("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),Mt=tt("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Rt=tt("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]),Pt=tt("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]),Lt=tt("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),_t=tt("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]),Ot=tt("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),Ut=tt("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]),Ft=tt("navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]),qt=tt("paperclip",[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]]),$t=tt("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]),Vt=tt("pin",[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]]),zt=tt("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Ht=tt("qr-code",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]),Bt=tt("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Wt=tt("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),Gt=tt("scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]),Jt=tt("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),Yt=tt("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),Qt=tt("server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]),Xt=tt("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Kt=tt("share-2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]),Zt=tt("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),es=tt("sliders-vertical",[["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M12 21v-9",key:"17s77i"}],["path",{d:"M12 8V3",key:"13r4qs"}],["path",{d:"M17 16h4",key:"h1uq16"}],["path",{d:"M19 12V3",key:"o1uvq1"}],["path",{d:"M19 21v-5",key:"qua636"}],["path",{d:"M3 14h4",key:"bcjad9"}],["path",{d:"M5 10V3",key:"cb8scm"}],["path",{d:"M5 21v-7",key:"1w1uti"}]]),ts=tt("smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),ss=tt("smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),as=tt("square-check-big",[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),rs=tt("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),is=tt("star-off",[["path",{d:"M8.34 8.34 2 9.27l5 4.87L5.82 21 12 17.77 18.18 21l-.59-3.43",key:"16m0ql"}],["path",{d:"M18.42 12.76 22 9.27l-6.91-1L12 2l-1.44 2.91",key:"1vt8nq"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),ns=tt("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),ls=tt("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),os=tt("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),cs=tt("toggle-left",[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]]),ds=tt("toggle-right",[["circle",{cx:"15",cy:"12",r:"3",key:"1afu0r"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]]),ms=tt("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),us=tt("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]),xs=tt("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]),hs=tt("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),ps=tt("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]),gs=tt("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),ys=tt("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),bs=tt("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),js=tt("user-x",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),fs=tt("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),vs=tt("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),Ns=tt("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]),ws=tt("volume-2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),ks=tt("volume-x",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]),Ss=tt("wifi-off",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),Cs=tt("wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),Es=tt("workflow",[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]]),Ds=tt("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]]),As=tt("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Is=tt("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);
/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ts=(e=>(e.ARCHITECTURAL="architectural",e.STRUCTURAL="structural",e.MECHANICAL="mechanical",e.ELECTRICAL="electrical",e.PLUMBING="plumbing",e.HVAC="hvac",e.FIRE_SAFETY="fire_safety",e.LANDSCAPING="landscaping",e.CLEANUP="cleanup",e.OTHER="other",e))(Ts||{}),Ms=(e=>(e.OPEN="open",e.IN_PROGRESS="in_progress",e.READY_FOR_REVIEW="ready_for_review",e.COMPLETED="completed",e.VERIFIED="verified",e.REJECTED="rejected",e))(Ms||{}),Rs=(e=>(e.NOT_STARTED="not_started",e.IN_PROGRESS="in_progress",e.ON_HOLD="on_hold",e.COMPLETED="completed",e.CANCELLED="cancelled",e))(Rs||{}),Ps=(e=>(e.LOW="low",e.MEDIUM="medium",e.HIGH="high",e.CRITICAL="critical",e))(Ps||{});const Ls=new class{constructor(){this.baseUrl="/api/field",this.offlineStorage="asagents_offline_data"}async getPunchLists(e,t){try{const s=new URLSearchParams;t&&Object.entries(t).forEach(([e,t])=>{t&&s.append(e,String(t))});const a=await fetch(`${this.baseUrl}/projects/${e}/punch-lists?${s}`);if(!a.ok)throw new Error("Failed to fetch punch lists");return await a.json()}catch(s){return console.error("Error fetching punch lists:",s),this.getMockPunchLists(e)}}async createPunchList(e,t){try{const s=await fetch(`${this.baseUrl}/projects/${e}/punch-lists`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw new Error("Failed to create punch list");return await s.json()}catch(s){return console.error("Error creating punch list:",s),this.createMockPunchList(e,t)}}async updatePunchList(e,t,s){try{const a=await fetch(`${this.baseUrl}/projects/${e}/punch-lists/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw new Error("Failed to update punch list");return await a.json()}catch(a){return console.error("Error updating punch list:",a),this.getMockPunchLists(e)[0]}}async deletePunchList(e,t){try{if(!(await fetch(`${this.baseUrl}/projects/${e}/punch-lists/${t}`,{method:"DELETE"})).ok)throw new Error("Failed to delete punch list")}catch(s){console.error("Error deleting punch list:",s)}}async getDailyReports(e,t){try{const s=new URLSearchParams;t&&(s.append("start",t.start.toISOString()),s.append("end",t.end.toISOString()));const a=await fetch(`${this.baseUrl}/projects/${e}/daily-reports?${s}`);if(!a.ok)throw new Error("Failed to fetch daily reports");return await a.json()}catch(s){return console.error("Error fetching daily reports:",s),this.getMockDailyReports(e)}}async createDailyReport(e,t){try{const s=await fetch(`${this.baseUrl}/projects/${e}/daily-reports`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw new Error("Failed to create daily report");return await s.json()}catch(s){return console.error("Error creating daily report:",s),this.createMockDailyReport(e,t)}}async updateDailyReport(e,t,s){try{const a=await fetch(`${this.baseUrl}/projects/${e}/daily-reports/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw new Error("Failed to update daily report");return await a.json()}catch(a){return console.error("Error updating daily report:",a),this.getMockDailyReports(e)[0]}}async getTasks(e,t){try{const s=new URLSearchParams;t&&Object.entries(t).forEach(([e,t])=>{t&&s.append(e,String(t))});const a=await fetch(`${this.baseUrl}/projects/${e}/tasks?${s}`);if(!a.ok)throw new Error("Failed to fetch tasks");return await a.json()}catch(s){return console.error("Error fetching tasks:",s),this.getMockTasks(e)}}async createTask(e,t){try{const s=await fetch(`${this.baseUrl}/projects/${e}/tasks`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw new Error("Failed to create task");return await s.json()}catch(s){return console.error("Error creating task:",s),this.createMockTask(e,t)}}async updateTask(e,t,s){try{const a=await fetch(`${this.baseUrl}/projects/${e}/tasks/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw new Error("Failed to update task");return await a.json()}catch(a){return console.error("Error updating task:",a),this.getMockTasks(e)[0]}}async uploadPhoto(e,t,s){try{const a=new FormData;a.append("file",t),a.append("metadata",JSON.stringify(s));const r=await fetch(`${this.baseUrl}/projects/${e}/photos`,{method:"POST",body:a});if(!r.ok)throw new Error("Failed to upload photo");return await r.json()}catch(a){return console.error("Error uploading photo:",a),this.createMockPhoto(t,s)}}async getPhotos(e,t){try{const s=new URLSearchParams;t&&Object.entries(t).forEach(([e,t])=>{t&&s.append(e,String(t))});const a=await fetch(`${this.baseUrl}/projects/${e}/photos?${s}`);if(!a.ok)throw new Error("Failed to fetch photos");return await a.json()}catch(s){return console.error("Error fetching photos:",s),this.getMockPhotos(e)}}async deletePhoto(e,t){try{if(!(await fetch(`${this.baseUrl}/projects/${e}/photos/${t}`,{method:"DELETE"})).ok)throw new Error("Failed to delete photo")}catch(s){console.error("Error deleting photo:",s)}}async createTimeEntry(e,t){try{const s=await fetch(`${this.baseUrl}/projects/${e}/time-entries`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw new Error("Failed to create time entry");return await s.json()}catch(s){return console.error("Error creating time entry:",s),this.createMockTimeEntry(e,t)}}async getTimeEntries(e,t,s){try{const a=new URLSearchParams;t&&a.append("userId",t),s&&(a.append("start",s.start.toISOString()),a.append("end",s.end.toISOString()));const r=await fetch(`${this.baseUrl}/projects/${e}/time-entries?${a}`);if(!r.ok)throw new Error("Failed to fetch time entries");return await r.json()}catch(a){return console.error("Error fetching time entries:",a),this.getMockTimeEntries(e)}}async getDrawings(e){try{const t=await fetch(`${this.baseUrl}/projects/${e}/drawings`);if(!t.ok)throw new Error("Failed to fetch drawings");return await t.json()}catch(t){return console.error("Error fetching drawings:",t),this.getMockDrawings(e)}}async addDrawingMarkup(e,t,s){try{const a=await fetch(`${this.baseUrl}/projects/${e}/drawings/${t}/markups`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw new Error("Failed to add drawing markup");return await a.json()}catch(a){return console.error("Error adding drawing markup:",a),{id:`markup-${Date.now()}`,...s}}}async syncOfflineData(){try{this.getOfflineData();const e=this.getPendingSyncOperations();for(const t of e)await this.processSyncOperation(t);await this.updateOfflineData()}catch(e){console.error("Error syncing offline data:",e)}}getOfflineData(){const e=localStorage.getItem(this.offlineStorage);return e?JSON.parse(e):{punchLists:[],tasks:[],photos:[],drawings:[],lastSync:new Date}}saveOfflineData(e){localStorage.setItem(this.offlineStorage,JSON.stringify(e))}getPendingSyncOperations(){const e=localStorage.getItem(`${this.offlineStorage}_sync`);return e?JSON.parse(e):[]}async processSyncOperation(e){try{console.log("Processing sync operation:",e)}catch(t){console.error("Error processing sync operation:",t),e.status="failed",e.error=t instanceof Error?t.message:"Unknown error",e.retryCount++}}async updateOfflineData(){console.log("Updating offline data...")}getMockPunchLists(e){return[{id:"punch-1",projectId:e,title:"Paint touch-up required in lobby",description:"Several scuff marks and scratches on walls need touch-up paint",category:Ts.ARCHITECTURAL,priority:Ps.MEDIUM,status:Ms.OPEN,assignedTo:"painter-1",assignedCompany:"ABC Painting",dueDate:new Date(Date.now()+6048e5),location:{building:"Main Building",floor:"1st Floor",room:"Lobby",area:"East Wall"},trade:"Painting",room:"Lobby",floor:"1st Floor",photos:[],attachments:[],verificationPhotos:[],comments:[],createdBy:"inspector-1",createdAt:new Date,updatedAt:new Date}]}createMockPunchList(e,t){return{id:`punch-${Date.now()}`,projectId:e,title:t.title||"New Punch Item",description:t.description||"",category:t.category||Ts.OTHER,priority:t.priority||Ps.MEDIUM,status:Ms.OPEN,assignedTo:t.assignedTo||"",assignedCompany:t.assignedCompany||"",dueDate:t.dueDate||new Date(Date.now()+6048e5),location:t.location||{},trade:t.trade||"",room:t.room||"",floor:t.floor||"",photos:[],attachments:[],verificationPhotos:[],comments:[],createdBy:"current-user",createdAt:new Date,updatedAt:new Date}}getMockDailyReports(e){return[{id:"report-1",projectId:e,date:new Date,reportedBy:"foreman-1",weather:"clear",temperature:{high:75,low:55,unit:"F"},crew:[],workPerformed:[],materials:[],equipment:[],safety:[],visitors:[],delays:[],issues:[],photos:[],notes:"Good progress on foundation work",submittedAt:new Date}]}createMockDailyReport(e,t){return{id:`report-${Date.now()}`,projectId:e,date:t.date||new Date,reportedBy:t.reportedBy||"current-user",weather:t.weather||"clear",temperature:t.temperature||{high:70,low:50,unit:"F"},crew:t.crew||[],workPerformed:t.workPerformed||[],materials:t.materials||[],equipment:t.equipment||[],safety:t.safety||[],visitors:t.visitors||[],delays:t.delays||[],issues:t.issues||[],photos:t.photos||[],notes:t.notes||"",submittedAt:new Date}}getMockTasks(e){return[{id:"task-1",projectId:e,title:"Install electrical outlets",description:"Install 20 electrical outlets in office areas",type:"construction",category:"electrical",priority:Ps.HIGH,status:Rs.IN_PROGRESS,assignedTo:["electrician-1"],assignedCompany:"XYZ Electric",dueDate:new Date(Date.now()+2592e5),estimatedHours:16,actualHours:8,location:{building:"Main Building",floor:"2nd Floor"},trade:"Electrical",phase:"Rough-in",prerequisites:[],dependencies:[],photos:[],attachments:[],comments:[],timeEntries:[],materials:[],equipment:[],safetyRequirements:[],qualityChecks:[],createdBy:"pm-1",createdAt:new Date,updatedAt:new Date,startedAt:new Date}]}createMockTask(e,t){return{id:`task-${Date.now()}`,projectId:e,title:t.title||"New Task",description:t.description||"",type:t.type||"construction",category:t.category||"other",priority:t.priority||Ps.MEDIUM,status:Rs.NOT_STARTED,assignedTo:t.assignedTo||[],assignedCompany:t.assignedCompany||"",dueDate:t.dueDate||new Date(Date.now()+6048e5),estimatedHours:t.estimatedHours||8,actualHours:0,location:t.location||{},trade:t.trade||"",phase:t.phase||"",prerequisites:[],dependencies:[],photos:[],attachments:[],comments:[],timeEntries:[],materials:[],equipment:[],safetyRequirements:[],qualityChecks:[],createdBy:"current-user",createdAt:new Date,updatedAt:new Date}}createMockPhoto(e,t){return{id:`photo-${Date.now()}`,url:URL.createObjectURL(e),thumbnailUrl:URL.createObjectURL(e),filename:e.name,size:e.size,mimeType:e.type,timestamp:new Date,metadata:{width:1920,height:1080,...t},tags:[],annotations:[],uploadedBy:"current-user",uploadedAt:new Date}}getMockPhotos(e){return[]}createMockTimeEntry(e,t){return{id:`time-${Date.now()}`,userId:t.userId||"current-user",projectId:e,taskId:t.taskId,date:t.date||new Date,startTime:t.startTime||new Date,endTime:t.endTime,duration:t.duration||480,breakTime:t.breakTime||60,overtimeHours:t.overtimeHours||0,description:t.description||"",location:t.location||"",costCode:t.costCode||"",billable:t.billable||!0,approved:!1,createdAt:new Date,updatedAt:new Date}}getMockTimeEntries(e){return[]}getMockDrawings(e){return[{id:"drawing-1",projectId:e,name:"Floor Plan - Level 1",number:"A-101",discipline:"Architectural",version:"1.0",url:"/mock-drawing.pdf",thumbnailUrl:"/mock-drawing-thumb.jpg",scale:"1/4\" = 1'",size:{width:36,height:24,units:"in"},layers:[],markups:[],lastModified:new Date}]}},_s=({projectId:e,userId:t,isOnline:s})=>{const[r,i]=a.useState("overview"),[n,l]=a.useState(!0),[o,c]=a.useState(!1),[m,u]=a.useState(!1),[x,h]=a.useState(null),[p,g]=a.useState({punchLists:[],tasks:[],dailyReports:[],photos:[]});a.useEffect(()=>{b(),y()},[e]);const y=()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{h(e)},e=>{console.error("Error getting location:",e)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})},b=async()=>{l(!0);try{const[t,s,a,r]=await Promise.all([Ls.getPunchLists(e),Ls.getTasks(e),Ls.getDailyReports(e),Ls.getPhotos(e)]);g({punchLists:t,tasks:s,dailyReports:a,photos:r})}catch(t){console.error("Error loading field data:",t)}finally{l(!1)}},j=[{id:"overview",label:"Overview",icon:wt},{id:"punch",label:"Punch Lists",icon:as},{id:"tasks",label:"Tasks",icon:pt},{id:"photos",label:"Photos",icon:ot},{id:"reports",label:"Daily Reports",icon:vs}];return n?d.jsx("div",{className:"flex items-center justify-center h-64",children:d.jsxs("div",{className:"text-center",children:[d.jsx(Bt,{className:"w-8 h-8 animate-spin text-blue-600 mx-auto mb-2"}),d.jsx("span",{className:"text-gray-600",children:"Loading field data..."})]})}):d.jsxs("div",{className:"bg-white rounded-lg shadow-lg min-h-screen",children:[d.jsx("div",{className:"border-b border-gray-200 px-4 py-3",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Field Management"}),d.jsx("div",{className:"flex items-center mt-1",children:s?d.jsxs("div",{className:"flex items-center text-green-600",children:[d.jsx(Cs,{className:"w-4 h-4 mr-1"}),d.jsx("span",{className:"text-sm",children:"Online"})]}):d.jsxs("div",{className:"flex items-center text-orange-600",children:[d.jsx(Ss,{className:"w-4 h-4 mr-1"}),d.jsx("span",{className:"text-sm",children:"Offline"})]})})]}),d.jsxs("div",{className:"flex space-x-2",children:[d.jsxs("button",{onClick:()=>u(!0),className:"flex items-center px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[d.jsx(Ht,{className:"w-4 h-4 mr-1"}),"Scan"]}),d.jsxs("button",{onClick:y,className:"flex items-center px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:[d.jsx(Ft,{className:"w-4 h-4 mr-1"}),"GPS"]}),d.jsxs("button",{onClick:async()=>{c(!0);try{await Ls.syncOfflineData(),await b()}catch(e){console.error("Error syncing data:",e)}finally{c(!1)}},disabled:o,className:"flex items-center px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[d.jsx(Bt,{className:"w-4 h-4 mr-1 "+(o?"animate-spin":"")}),"Sync"]})]})]})}),d.jsx("div",{className:"border-b border-gray-200 overflow-x-auto",children:d.jsx("nav",{className:"flex space-x-0",children:j.map(e=>{const t=e.icon;return d.jsxs("button",{onClick:()=>i(e.id),className:"flex flex-col items-center py-3 px-4 min-w-0 flex-1 "+(r===e.id?"border-b-2 border-blue-500 text-blue-600 bg-blue-50":"text-gray-500 hover:text-gray-700"),children:[d.jsx(t,{className:"w-5 h-5 mb-1"}),d.jsx("span",{className:"text-xs font-medium truncate",children:e.label})]},e.id)})})}),d.jsxs("div",{className:"p-4",children:["overview"===r&&d.jsx(Os,{fieldData:p}),"punch"===r&&d.jsx(Us,{punchLists:p.punchLists,projectId:e}),"tasks"===r&&d.jsx(Fs,{tasks:p.tasks,projectId:e}),"photos"===r&&d.jsx(qs,{photos:p.photos,projectId:e}),"reports"===r&&d.jsx($s,{reports:p.dailyReports,projectId:e})]}),m&&d.jsx(Vs,{onScan:e=>{console.log("QR Code scanned:",e),u(!1);try{const t=JSON.parse(e);"equipment"===t.type?alert(`Equipment scanned: ${t.name} (ID: ${t.id})`):"location"===t.type?alert(`Location scanned: ${t.name} (${t.building}, ${t.floor})`):"task"===t.type&&alert(`Task scanned: ${t.title} (ID: ${t.id})`)}catch(t){alert(`QR Code content: ${e}`)}},onClose:()=>u(!1)}),x&&d.jsxs("div",{className:"fixed bottom-4 left-4 bg-white border border-gray-200 rounded-lg p-3 shadow-lg z-40",children:[d.jsxs("div",{className:"flex items-center text-sm",children:[d.jsx(gt,{className:"w-4 h-4 text-green-600 mr-2"}),d.jsxs("span",{className:"text-gray-600",children:[x.coords.latitude.toFixed(6),", ",x.coords.longitude.toFixed(6)]})]}),d.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Accuracy: ",Math.round(x.coords.accuracy),"m"]})]})]})},Os=({fieldData:e})=>{const{punchLists:t,tasks:s,dailyReports:a,photos:r}=e,i={openPunches:t.filter(e=>e.status===Ms.OPEN).length,activeTasks:s.filter(e=>e.status===Rs.IN_PROGRESS).length,todayPhotos:r.filter(e=>{const t=new Date;return new Date(e.timestamp).toDateString()===t.toDateString()}).length,recentReports:a.length};return d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsx("div",{className:"bg-red-50 p-4 rounded-lg",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx(hs,{className:"w-6 h-6 text-red-600"}),d.jsxs("div",{className:"ml-3",children:[d.jsx("p",{className:"text-sm font-medium text-red-600",children:"Open Punches"}),d.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.openPunches})]})]})}),d.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx(pt,{className:"w-6 h-6 text-blue-600"}),d.jsxs("div",{className:"ml-3",children:[d.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Active Tasks"}),d.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.activeTasks})]})]})}),d.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx(ot,{className:"w-6 h-6 text-green-600"}),d.jsxs("div",{className:"ml-3",children:[d.jsx("p",{className:"text-sm font-medium text-green-600",children:"Today's Photos"}),d.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.todayPhotos})]})]})}),d.jsx("div",{className:"bg-purple-50 p-4 rounded-lg",children:d.jsxs("div",{className:"flex items-center",children:[d.jsx(wt,{className:"w-6 h-6 text-purple-600"}),d.jsxs("div",{className:"ml-3",children:[d.jsx("p",{className:"text-sm font-medium text-purple-600",children:"Reports"}),d.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.recentReports})]})]})})]}),d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Activity"}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[d.jsx(as,{className:"w-5 h-5 text-blue-600"}),d.jsxs("div",{className:"ml-3",children:[d.jsx("p",{className:"text-sm font-medium text-gray-900",children:"New punch item created"}),d.jsx("p",{className:"text-xs text-gray-600",children:"2 hours ago"})]})]}),d.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[d.jsx(ot,{className:"w-5 h-5 text-green-600"}),d.jsxs("div",{className:"ml-3",children:[d.jsx("p",{className:"text-sm font-medium text-gray-900",children:"5 photos uploaded"}),d.jsx("p",{className:"text-xs text-gray-600",children:"4 hours ago"})]})]}),d.jsxs("div",{className:"flex items-center p-3 bg-gray-50 rounded-lg",children:[d.jsx(pt,{className:"w-5 h-5 text-orange-600"}),d.jsxs("div",{className:"ml-3",children:[d.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Task completed"}),d.jsx("p",{className:"text-xs text-gray-600",children:"1 day ago"})]})]})]})]})]})},Us=({punchLists:e,projectId:t})=>{const[s,r]=a.useState("all"),[i,n]=a.useState(""),l=e.filter(e=>{const t="all"===s||e.status===s,a=e.title.toLowerCase().includes(i.toLowerCase())||e.description.toLowerCase().includes(i.toLowerCase());return t&&a}),o=e=>{switch(e){case Ms.OPEN:return"bg-red-100 text-red-800";case Ms.IN_PROGRESS:return"bg-blue-100 text-blue-800";case Ms.COMPLETED:return"bg-green-100 text-green-800";case Ms.VERIFIED:return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},c=e=>{switch(e){case Ps.CRITICAL:return"bg-red-500";case Ps.HIGH:return"bg-orange-500";case Ps.MEDIUM:return"bg-yellow-500";case Ps.LOW:return"bg-green-500";default:return"bg-gray-500"}};return d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex flex-col space-y-3",children:[d.jsxs("div",{className:"relative",children:[d.jsx(Jt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),d.jsx("input",{type:"text",placeholder:"Search punch items...",value:i,onChange:e=>n(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),d.jsxs("div",{className:"flex space-x-2 overflow-x-auto",children:[d.jsx("button",{onClick:()=>r("all"),className:"px-3 py-1 text-sm rounded-full whitespace-nowrap "+("all"===s?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"),children:"All"}),Object.values(Ms).map(e=>d.jsx("button",{onClick:()=>r(e),className:"px-3 py-1 text-sm rounded-full whitespace-nowrap "+(s===e?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"),children:e.replace("_"," ")},e))]})]}),d.jsxs("button",{className:"w-full flex items-center justify-center py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-5 h-5 mr-2"}),"Add Punch Item"]}),d.jsx("div",{className:"space-y-3",children:l.map(e=>d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[d.jsxs("div",{className:"flex items-start justify-between mb-2",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("h4",{className:"font-semibold text-gray-900",children:e.title}),d.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]}),d.jsx("div",{className:`w-3 h-3 rounded-full ${c(e.priority)}`})]}),d.jsxs("div",{className:"flex items-center justify-between mt-3",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${o(e.status)}`,children:e.status.replace("_"," ")}),d.jsx("span",{className:"text-xs text-gray-500",children:e.trade})]}),d.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[d.jsx(Lt,{className:"w-3 h-3 mr-1"}),e.location.room||e.location.area||"Location TBD"]})]}),d.jsxs("div",{className:"flex items-center justify-between mt-2 text-xs text-gray-500",children:[d.jsxs("span",{children:["Assigned to: ",e.assignedCompany]}),d.jsxs("span",{children:["Due: ",e.dueDate.toLocaleDateString()]})]})]},e.id))}),0===l.length&&d.jsxs("div",{className:"text-center py-8 text-gray-500",children:[d.jsx(as,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),d.jsx("p",{children:"No punch items found"})]})]})},Fs=({tasks:e,projectId:t})=>d.jsxs("div",{className:"space-y-4",children:[d.jsxs("button",{className:"w-full flex items-center justify-center py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-5 h-5 mr-2"}),"Add Task"]}),d.jsx("div",{className:"space-y-3",children:e.map(e=>d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[d.jsx("h4",{className:"font-semibold text-gray-900",children:e.title}),d.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),d.jsxs("div",{className:"flex items-center justify-between mt-3",children:[d.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full "+(e.status===Rs.COMPLETED?"bg-green-100 text-green-800":e.status===Rs.IN_PROGRESS?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:e.status.replace("_"," ")}),d.jsxs("span",{className:"text-xs text-gray-500",children:["Due: ",e.dueDate.toLocaleDateString()]})]})]},e.id))}),0===e.length&&d.jsxs("div",{className:"text-center py-8 text-gray-500",children:[d.jsx(pt,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),d.jsx("p",{children:"No tasks found"})]})]}),qs=({photos:e,projectId:t})=>{const[s,r]=a.useState(!1),i=async e=>{try{navigator.geolocation&&navigator.geolocation.getCurrentPosition(async s=>{const a={location:{latitude:s.coords.latitude,longitude:s.coords.longitude,accuracy:s.coords.accuracy},timestamp:new Date,camera:"Mobile Camera"};await Ls.uploadPhoto(t,e,a),r(!1),window.location.reload()},s=>{console.error("Error getting location:",s);const a={timestamp:new Date,camera:"Mobile Camera"};Ls.uploadPhoto(t,e,a),r(!1)})}catch(s){console.error("Error capturing photo:",s)}};return d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[d.jsxs("button",{onClick:()=>{r(!0)},className:"flex items-center justify-center py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(ot,{className:"w-5 h-5 mr-2"}),"Take Photo"]}),d.jsxs("label",{className:"flex items-center justify-center py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 cursor-pointer",children:[d.jsx(Upload,{className:"w-5 h-5 mr-2"}),"Upload",d.jsx("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:e=>{e.target.files&&Array.from(e.target.files).forEach(e=>{i(e)})}})]})]}),d.jsx("div",{className:"grid grid-cols-2 gap-3",children:e.map(e=>d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[d.jsx("img",{src:e.thumbnailUrl,alt:e.filename,className:"w-full h-32 object-cover"}),d.jsxs("div",{className:"p-2",children:[d.jsx("p",{className:"text-xs text-gray-600 truncate",children:e.filename}),d.jsx("p",{className:"text-xs text-gray-500",children:e.timestamp.toLocaleDateString()}),e.location&&d.jsxs("div",{className:"flex items-center mt-1",children:[d.jsx(Lt,{className:"w-3 h-3 text-gray-400 mr-1"}),d.jsxs("p",{className:"text-xs text-gray-400",children:[e.location.latitude.toFixed(4),", ",e.location.longitude.toFixed(4)]})]})]})]},e.id))}),0===e.length&&d.jsxs("div",{className:"text-center py-8 text-gray-500",children:[d.jsx(ot,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),d.jsx("p",{children:"No photos found"}),d.jsx("p",{className:"text-xs mt-1",children:"Take photos to document progress"})]}),s&&d.jsx(zs,{onCapture:i,onClose:()=>r(!1)})]})},$s=({reports:e,projectId:t})=>d.jsxs("div",{className:"space-y-4",children:[d.jsxs("button",{className:"w-full flex items-center justify-center py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-5 h-5 mr-2"}),"Create Daily Report"]}),d.jsx("div",{className:"space-y-3",children:e.map(e=>d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsx("h4",{className:"font-semibold text-gray-900",children:"Daily Report"}),d.jsx("span",{className:"text-sm text-gray-500",children:e.date.toLocaleDateString()})]}),d.jsx("p",{className:"text-sm text-gray-600",children:e.notes}),d.jsxs("div",{className:"flex items-center mt-3 space-x-4",children:[d.jsxs("span",{className:"text-xs text-gray-500",children:["Weather: ",e.weather]}),d.jsxs("span",{className:"text-xs text-gray-500",children:["Crew: ",e.crew.length]}),d.jsxs("span",{className:"text-xs text-gray-500",children:["Photos: ",e.photos.length]})]})]},e.id))}),0===e.length&&d.jsxs("div",{className:"text-center py-8 text-gray-500",children:[d.jsx(wt,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),d.jsx("p",{children:"No daily reports found"})]})]}),Vs=({onScan:e,onClose:t})=>{const[s,r]=a.useState(!1),[i,n]=a.useState(null);return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"QR Code Scanner"})}),d.jsxs("div",{className:"p-6",children:[!s&&!i&&d.jsxs("div",{className:"text-center",children:[d.jsx(Ht,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("p",{className:"text-gray-600 mb-4",children:"Scan QR codes for equipment, locations, or tasks"}),d.jsxs("button",{onClick:async()=>{try{if(r(!0),n(null),!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)throw new Error("Camera not available on this device");const t=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});setTimeout(()=>{const s=[JSON.stringify({type:"equipment",id:"EQ001",name:"Excavator CAT 320"}),JSON.stringify({type:"location",id:"LOC001",name:"Building A",building:"A",floor:"1"}),JSON.stringify({type:"task",id:"TASK001",title:"Install electrical outlets"}),"https://example.com/project/demo-project-1","Simple text QR code content"],a=s[Math.floor(Math.random()*s.length)];e(a),t.getTracks().forEach(e=>e.stop()),r(!1)},2e3)}catch(t){n(t instanceof Error?t.message:"Failed to access camera"),r(!1)}},className:"w-full flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:[d.jsx(Gt,{className:"w-4 h-4 mr-2"}),"Start Scanning"]})]}),s&&d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"w-48 h-48 bg-gray-200 rounded-lg mx-auto mb-4 flex items-center justify-center",children:d.jsx("div",{className:"animate-pulse",children:d.jsx(Ht,{className:"w-16 h-16 text-gray-400"})})}),d.jsx("p",{className:"text-gray-600 mb-4",children:"Point your camera at a QR code..."}),d.jsx("div",{className:"flex space-x-2",children:d.jsx("div",{className:"flex-1 h-2 bg-green-200 rounded-full overflow-hidden",children:d.jsx("div",{className:"h-full bg-green-600 rounded-full animate-pulse"})})})]}),i&&d.jsxs("div",{className:"text-center",children:[d.jsx(hs,{className:"w-16 h-16 text-red-400 mx-auto mb-4"}),d.jsx("p",{className:"text-red-600 mb-4",children:i}),d.jsx("button",{onClick:()=>n(null),className:"w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Try Again"})]})]}),d.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:d.jsx("button",{onClick:t,className:"w-full px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Close"})})]})})},zs=({onCapture:e,onClose:t})=>{const[s,r]=a.useState(!1);return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Take Photo"})}),d.jsx("div",{className:"p-6",children:s?d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"w-48 h-36 bg-gray-200 rounded-lg mx-auto mb-4 flex items-center justify-center",children:d.jsx("div",{className:"animate-pulse",children:d.jsx(ot,{className:"w-16 h-16 text-gray-400"})})}),d.jsx("p",{className:"text-gray-600",children:"Capturing photo..."})]}):d.jsxs("div",{className:"text-center space-y-4",children:[d.jsx("div",{className:"w-48 h-36 bg-gray-200 rounded-lg mx-auto flex items-center justify-center",children:d.jsx(ot,{className:"w-16 h-16 text-gray-400"})}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs("button",{onClick:()=>{r(!0),setTimeout(()=>{const t=document.createElement("canvas");t.width=640,t.height=480;const s=t.getContext("2d");s&&(s.fillStyle="#f0f0f0",s.fillRect(0,0,640,480),s.fillStyle="#333",s.font="24px Arial",s.textAlign="center",s.fillText("Mock Photo Capture",320,240),s.fillText((new Date).toLocaleString(),320,280),t.toBlob(t=>{if(t){const s=new File([t],`photo_${Date.now()}.jpg`,{type:"image/jpeg"});e(s)}},"image/jpeg",.8)),r(!1)},1500)},className:"w-full flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(ot,{className:"w-4 h-4 mr-2"}),"Capture Photo"]}),d.jsxs("label",{className:"w-full flex items-center justify-center px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 cursor-pointer",children:[d.jsx(Upload,{className:"w-4 h-4 mr-2"}),"Choose from Gallery",d.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:t=>{const s=t.target.files?.[0];s&&e(s)}})]})]})]})}),d.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:d.jsx("button",{onClick:t,disabled:s,className:"w-full px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Cancel"})})]})})};var Hs=(e=>(e.DRAWING="drawing",e.SPECIFICATION="specification",e.CONTRACT="contract",e.REPORT="report",e.PHOTO="photo",e.MANUAL="manual",e.CERTIFICATE="certificate",e.PERMIT="permit",e.CORRESPONDENCE="correspondence",e.FORM="form",e.OTHER="other",e))(Hs||{}),Bs=(e=>(e.ARCHITECTURAL="architectural",e.STRUCTURAL="structural",e.MECHANICAL="mechanical",e.ELECTRICAL="electrical",e.PLUMBING="plumbing",e.CIVIL="civil",e.LANDSCAPE="landscape",e.FIRE_PROTECTION="fire_protection",e.SECURITY="security",e.TELECOMMUNICATIONS="telecommunications",e.GENERAL="general",e))(Bs||{}),Ws=(e=>(e.DRAFT="draft",e.UNDER_REVIEW="under_review",e.APPROVED="approved",e.PUBLISHED="published",e.SUPERSEDED="superseded",e.ARCHIVED="archived",e.REJECTED="rejected",e))(Ws||{}),Gs=(e=>(e.LOW="low",e.MEDIUM="medium",e.HIGH="high",e.CRITICAL="critical",e))(Gs||{}),Js=(e=>(e.OPEN="open",e.UNDER_REVIEW="under_review",e.RESPONDED="responded",e.CLOSED="closed",e.CANCELLED="cancelled",e))(Js||{}),Ys=(e=>(e.NOT_SUBMITTED="not_submitted",e.SUBMITTED="submitted",e.UNDER_REVIEW="under_review",e.APPROVED="approved",e.APPROVED_WITH_COMMENTS="approved_with_comments",e.REJECTED="rejected",e.RESUBMIT="resubmit",e))(Ys||{}),Qs=(e=>(e.DRAFT="draft",e.SUBMITTED="submitted",e.UNDER_REVIEW="under_review",e.APPROVED="approved",e.REJECTED="rejected",e.IMPLEMENTED="implemented",e.CANCELLED="cancelled",e))(Qs||{});const Xs=new class{constructor(){this.baseUrl="/api/documents",this.mockData=this.initializeMockData()}async getDocuments(e,t){try{const s=new URLSearchParams;t&&Object.entries(t).forEach(([e,t])=>{t&&Array.isArray(t)?t.forEach(t=>s.append(e,String(t))):t&&s.append(e,String(t))});const a=await fetch(`${this.baseUrl}/projects/${e}?${s}`);if(!a.ok)throw new Error("Failed to fetch documents");return await a.json()}catch(s){return console.error("Error fetching documents:",s),this.getMockDocuments(e,t)}}async uploadDocument(e,t,s){try{const a=new FormData;a.append("file",t),a.append("metadata",JSON.stringify(s));const r=await fetch(`${this.baseUrl}/projects/${e}/upload`,{method:"POST",body:a});if(!r.ok)throw new Error("Failed to upload document");return await r.json()}catch(a){return console.error("Error uploading document:",a),this.createMockDocument(e,t,s)}}async updateDocument(e,t,s){try{const a=await fetch(`${this.baseUrl}/projects/${e}/documents/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw new Error("Failed to update document");return await a.json()}catch(a){return console.error("Error updating document:",a),this.mockData.documents[0]}}async deleteDocument(e,t){try{if(!(await fetch(`${this.baseUrl}/projects/${e}/documents/${t}`,{method:"DELETE"})).ok)throw new Error("Failed to delete document")}catch(s){console.error("Error deleting document:",s)}}async createRevision(e,t,s,a){try{const r=new FormData;r.append("file",s),r.append("description",a);const i=await fetch(`${this.baseUrl}/projects/${e}/documents/${t}/revisions`,{method:"POST",body:r});if(!i.ok)throw new Error("Failed to create revision");return await i.json()}catch(r){return console.error("Error creating revision:",r),this.createMockRevision(t,s,a)}}async addMarkup(e,t,s){try{const a=await fetch(`${this.baseUrl}/projects/${e}/documents/${t}/markups`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw new Error("Failed to add markup");return await a.json()}catch(a){return console.error("Error adding markup:",a),this.createMockMarkup(t,s)}}async updateMarkup(e,t,s,a){try{const r=await fetch(`${this.baseUrl}/projects/${e}/documents/${t}/markups/${s}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!r.ok)throw new Error("Failed to update markup");return await r.json()}catch(r){return console.error("Error updating markup:",r),this.mockData.markups[0]}}async deleteMarkup(e,t,s){try{if(!(await fetch(`${this.baseUrl}/projects/${e}/documents/${t}/markups/${s}`,{method:"DELETE"})).ok)throw new Error("Failed to delete markup")}catch(a){console.error("Error deleting markup:",a)}}async getRFIs(e,t){try{const s=new URLSearchParams;t&&Object.entries(t).forEach(([e,t])=>{t&&s.append(e,String(t))});const a=await fetch(`${this.baseUrl}/projects/${e}/rfis?${s}`);if(!a.ok)throw new Error("Failed to fetch RFIs");return await a.json()}catch(s){return console.error("Error fetching RFIs:",s),this.getMockRFIs(e)}}async createRFI(e,t){try{const s=await fetch(`${this.baseUrl}/projects/${e}/rfis`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw new Error("Failed to create RFI");return await s.json()}catch(s){return console.error("Error creating RFI:",s),this.createMockRFI(e,t)}}async updateRFI(e,t,s){try{const a=await fetch(`${this.baseUrl}/projects/${e}/rfis/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw new Error("Failed to update RFI");return await a.json()}catch(a){return console.error("Error updating RFI:",a),this.mockData.rfis[0]}}async respondToRFI(e,t,s){try{const a=await fetch(`${this.baseUrl}/projects/${e}/rfis/${t}/respond`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw new Error("Failed to respond to RFI");return await a.json()}catch(a){return console.error("Error responding to RFI:",a),this.mockData.rfis[0]}}async getSubmittals(e,t){try{const s=new URLSearchParams;t&&Object.entries(t).forEach(([e,t])=>{t&&s.append(e,String(t))});const a=await fetch(`${this.baseUrl}/projects/${e}/submittals?${s}`);if(!a.ok)throw new Error("Failed to fetch submittals");return await a.json()}catch(s){return console.error("Error fetching submittals:",s),this.getMockSubmittals(e)}}async createSubmittal(e,t){try{const s=await fetch(`${this.baseUrl}/projects/${e}/submittals`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw new Error("Failed to create submittal");return await s.json()}catch(s){return console.error("Error creating submittal:",s),this.createMockSubmittal(e,t)}}async updateSubmittal(e,t,s){try{const a=await fetch(`${this.baseUrl}/projects/${e}/submittals/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw new Error("Failed to update submittal");return await a.json()}catch(a){return console.error("Error updating submittal:",a),this.mockData.submittals[0]}}async reviewSubmittal(e,t,s){try{const a=await fetch(`${this.baseUrl}/projects/${e}/submittals/${t}/review`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw new Error("Failed to review submittal");return await a.json()}catch(a){return console.error("Error reviewing submittal:",a),this.mockData.submittals[0]}}async getChangeOrders(e,t){try{const s=new URLSearchParams;t&&Object.entries(t).forEach(([e,t])=>{t&&s.append(e,String(t))});const a=await fetch(`${this.baseUrl}/projects/${e}/change-orders?${s}`);if(!a.ok)throw new Error("Failed to fetch change orders");return await a.json()}catch(s){return console.error("Error fetching change orders:",s),this.getMockChangeOrders(e)}}async createChangeOrder(e,t){try{const s=await fetch(`${this.baseUrl}/projects/${e}/change-orders`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!s.ok)throw new Error("Failed to create change order");return await s.json()}catch(s){return console.error("Error creating change order:",s),this.createMockChangeOrder(e,t)}}async updateChangeOrder(e,t,s){try{const a=await fetch(`${this.baseUrl}/projects/${e}/change-orders/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw new Error("Failed to update change order");return await a.json()}catch(a){return console.error("Error updating change order:",a),this.mockData.changeOrders[0]}}async approveChangeOrder(e,t,s){try{const a=await fetch(`${this.baseUrl}/projects/${e}/change-orders/${t}/approve`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw new Error("Failed to approve change order");return await a.json()}catch(a){return console.error("Error approving change order:",a),this.mockData.changeOrders[0]}}async updateWorkflow(e,t,s,a){try{const r=await fetch(`${this.baseUrl}/projects/${e}/documents/${t}/workflow`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:s,comments:a})});if(!r.ok)throw new Error("Failed to update workflow");return await r.json()}catch(r){return console.error("Error updating workflow:",r),this.createMockWorkflow()}}initializeMockData(){return{documents:this.createMockDocuments(),rfis:this.createMockRFIs(),submittals:this.createMockSubmittals(),changeOrders:this.createMockChangeOrders(),markups:this.createMockMarkups()}}getMockDocuments(e,t){let s=this.mockData.documents.filter(t=>t.projectId===e);if(t&&(t.type?.length&&(s=s.filter(e=>t.type.includes(e.type))),t.category?.length&&(s=s.filter(e=>t.category.includes(e.category))),t.status?.length&&(s=s.filter(e=>t.status.includes(e.status))),t.searchQuery)){const e=t.searchQuery.toLowerCase();s=s.filter(t=>t.name.toLowerCase().includes(e)||t.description.toLowerCase().includes(e))}return{documents:s,totalCount:s.length,facets:{types:{[Hs.DRAWING]:5,[Hs.SPECIFICATION]:3},categories:{[Bs.ARCHITECTURAL]:4,[Bs.STRUCTURAL]:2},statuses:{[Ws.APPROVED]:6,[Ws.UNDER_REVIEW]:2},disciplines:{Architecture:4,Structural:2,MEP:2},tags:{foundation:2,electrical:3,plumbing:1}}}}createMockDocument(e,t,s){return{id:`doc-${Date.now()}`,projectId:e,name:t.name,description:s.description||"",type:s.type||Hs.OTHER,category:s.category||Bs.GENERAL,discipline:s.discipline||"General",version:"1.0",status:Ws.DRAFT,file:{id:`file-${Date.now()}`,filename:t.name,originalName:t.name,url:URL.createObjectURL(t),size:t.size,mimeType:t.type,checksum:"mock-checksum",storageLocation:"mock-storage",uploadedBy:"current-user",uploadedAt:new Date},metadata:{title:s.title,author:s.author,keywords:s.keywords||[]},permissions:[],workflow:this.createMockWorkflow(),revisions:[],markups:[],comments:[],tags:s.tags||[],customFields:[],createdBy:"current-user",createdAt:new Date,updatedAt:new Date}}createMockDocuments(){return[{id:"doc-1",projectId:"demo-project-1",name:"Architectural Floor Plans - Level 1",description:"Detailed floor plans for the first level including all rooms and dimensions",type:Hs.DRAWING,category:Bs.ARCHITECTURAL,discipline:"Architecture",version:"2.1",status:Ws.APPROVED,file:{id:"file-1",filename:"A-101_Floor_Plan_L1_v2.1.pdf",originalName:"Floor Plan Level 1.pdf",url:"/mock-documents/floor-plan-l1.pdf",thumbnailUrl:"/mock-documents/floor-plan-l1-thumb.jpg",size:2048576,mimeType:"application/pdf",checksum:"abc123def456",storageLocation:"s3://docs/project-1/",uploadedBy:"architect-1",uploadedAt:new Date("2024-01-15")},metadata:{title:"Level 1 Floor Plan",author:"John Smith, AIA",keywords:["floor plan","level 1","architectural"],pageCount:1,dimensions:{width:36,height:24,units:"in"},scale:"1/4\" = 1'",drawingNumber:"A-101",sheetNumber:"1",revisionNumber:"2.1",issueDate:new Date("2024-01-15")},permissions:[],workflow:this.createMockWorkflow(),revisions:[],markups:[],comments:[],tags:["floor plan","architectural","level 1"],customFields:[],createdBy:"architect-1",createdAt:new Date("2024-01-10"),updatedAt:new Date("2024-01-15"),publishedAt:new Date("2024-01-15")}]}createMockWorkflow(){return{id:`workflow-${Date.now()}`,workflowId:"standard-approval",currentStep:{id:"step-1",name:"Initial Review",description:"Initial review by project manager",type:"review",order:1,required:!0,assigneeType:"role",assignees:["project-manager"],actions:[],conditions:[]},status:"in_progress",assignedTo:["pm-1"],startedAt:new Date,history:[]}}createMockRevision(e,t,s){return{id:`rev-${Date.now()}`,version:"2.0",description:s,changes:[],file:{id:`file-${Date.now()}`,filename:t.name,originalName:t.name,url:URL.createObjectURL(t),size:t.size,mimeType:t.type,checksum:"mock-checksum",storageLocation:"mock-storage",uploadedBy:"current-user",uploadedAt:new Date},createdBy:"current-user",createdAt:new Date}}createMockMarkup(e,t){return{id:`markup-${Date.now()}`,documentId:e,pageNumber:t.pageNumber||1,type:t.type||"annotation",coordinates:t.coordinates||{x:100,y:100},content:t.content||"New markup",color:t.color||"#ff0000",strokeWidth:t.strokeWidth||2,opacity:t.opacity||1,locked:!1,visible:!0,layer:"default",createdBy:"current-user",createdAt:new Date,updatedAt:new Date,replies:[],status:"open"}}createMockMarkups(){return[]}getMockRFIs(e){return this.mockData.rfis.filter(t=>t.projectId===e)}createMockRFI(e,t){return{id:`rfi-${Date.now()}`,projectId:e,number:`RFI-${String(Date.now()).slice(-3)}`,title:t.title||"New RFI",description:t.description||"",question:t.question||"",priority:t.priority||Gs.MEDIUM,status:Js.OPEN,category:t.category||"design_clarification",discipline:t.discipline||"General",requestedBy:"current-user",requestedCompany:"ABC Construction",assignedTo:t.assignedTo||"architect-1",assignedCompany:"XYZ Architects",dueDate:t.dueDate||new Date(Date.now()+6048e5),relatedDocuments:[],relatedDrawings:[],attachments:[],photos:[],markups:[],comments:[],workflow:this.createMockWorkflow(),createdAt:new Date,updatedAt:new Date}}createMockRFIs(){return[{id:"rfi-1",projectId:"demo-project-1",number:"RFI-001",title:"Clarification on Foundation Details",description:"Need clarification on foundation reinforcement details in section A-A",question:"What is the required rebar spacing for the foundation footings shown in drawing S-101?",priority:Gs.HIGH,status:Js.UNDER_REVIEW,category:"design_clarification",discipline:"Structural",requestedBy:"foreman-1",requestedCompany:"ABC Construction",assignedTo:"engineer-1",assignedCompany:"XYZ Engineering",dueDate:new Date(Date.now()+2592e5),relatedDocuments:["doc-1"],relatedDrawings:["S-101"],attachments:[],photos:[],markups:[],comments:[],workflow:this.createMockWorkflow(),costImpact:5e3,scheduleImpact:2,createdAt:new Date(Date.now()-1728e5),updatedAt:new Date}]}getMockSubmittals(e){return this.mockData.submittals.filter(t=>t.projectId===e)}createMockSubmittal(e,t){return{id:`submittal-${Date.now()}`,projectId:e,number:`SUB-${String(Date.now()).slice(-3)}`,title:t.title||"New Submittal",description:t.description||"",type:t.type||"product_data",category:t.category||"general",discipline:t.discipline||"General",specification:t.specification||"",submittedBy:"current-user",submittedCompany:"ABC Construction",reviewedBy:[],status:Ys.SUBMITTED,priority:t.priority||Gs.MEDIUM,dueDate:t.dueDate||new Date(Date.now()+12096e5),submissionDate:new Date,documents:[],reviews:[],comments:[],workflow:this.createMockWorkflow(),deliveryMethod:"electronic",copies:1,distributionList:[],createdAt:new Date,updatedAt:new Date}}createMockSubmittals(){return[{id:"submittal-1",projectId:"demo-project-1",number:"SUB-001",title:"Structural Steel Shop Drawings",description:"Shop drawings for structural steel beams and connections",type:"shop_drawings",category:"structural",discipline:"Structural",specification:"05 12 00",submittedBy:"steel-contractor",submittedCompany:"Steel Works Inc",reviewedBy:["engineer-1"],status:Ys.UNDER_REVIEW,priority:Gs.HIGH,dueDate:new Date(Date.now()+6048e5),submissionDate:new Date(Date.now()-864e5),documents:[],reviews:[],comments:[],workflow:this.createMockWorkflow(),deliveryMethod:"electronic",copies:3,distributionList:["engineer-1","architect-1","pm-1"],createdAt:new Date(Date.now()-2592e5),updatedAt:new Date}]}getMockChangeOrders(e){return this.mockData.changeOrders.filter(t=>t.projectId===e)}createMockChangeOrder(e,t){return{id:`co-${Date.now()}`,projectId:e,number:`CO-${String(Date.now()).slice(-3)}`,title:t.title||"New Change Order",description:t.description||"",type:t.type||"addition",reason:t.reason||"scope_change",status:Qs.DRAFT,priority:t.priority||Gs.MEDIUM,requestedBy:"current-user",assignedTo:t.assignedTo||"pm-1",costImpact:t.costImpact||0,scheduleImpact:t.scheduleImpact||0,scope:{addedWork:[],deletedWork:[],modifiedWork:[],materials:[],labor:[],equipment:[]},justification:t.justification||"",relatedDocuments:[],relatedRFIs:[],relatedSubmittals:[],attachments:[],approvals:[],workflow:this.createMockWorkflow(),implementation:{status:"not_started",photos:[]},createdAt:new Date,updatedAt:new Date}}createMockChangeOrders(){return[{id:"co-1",projectId:"demo-project-1",number:"CO-001",title:"Additional Electrical Outlets",description:"Add 20 additional electrical outlets in office areas per owner request",type:"addition",reason:"owner_request",status:Qs.UNDER_REVIEW,priority:Gs.MEDIUM,requestedBy:"owner-1",assignedTo:"pm-1",costImpact:15e3,scheduleImpact:3,scope:{addedWork:[{id:"work-1",description:"Install additional electrical outlets",quantity:20,unit:"EA",unitCost:750,totalCost:15e3,costCode:"16-10-00",phase:"Electrical Rough-in",location:"Office Areas"}],deletedWork:[],modifiedWork:[],materials:[],labor:[],equipment:[]},justification:"Owner requires additional outlets for increased equipment density in office areas",relatedDocuments:[],relatedRFIs:[],relatedSubmittals:[],attachments:[],approvals:[],workflow:this.createMockWorkflow(),implementation:{status:"not_started",photos:[]},createdAt:new Date(Date.now()-432e6),updatedAt:new Date}]}},Ks=({projectId:e,userId:t})=>{const[s,r]=a.useState("documents"),[i,n]=a.useState("list"),[l,o]=a.useState(!0),[c,m]=a.useState(""),[u,x]=a.useState(!1),[h,p]=a.useState([]),[g,y]=a.useState({documents:[],rfis:[],submittals:[],changeOrders:[],totalCounts:{documents:0,rfis:0,submittals:0,changeOrders:0}}),[b,j]=a.useState({type:[],category:[],status:[],discipline:[],tags:[],searchQuery:""});a.useEffect(()=>{f()},[e,b]),a.useEffect(()=>{const e=setTimeout(()=>{j(e=>({...e,searchQuery:c}))},300);return()=>clearTimeout(e)},[c]);const f=async()=>{o(!0);try{const[t,s,a,r]=await Promise.all([Xs.getDocuments(e,b),Xs.getRFIs(e),Xs.getSubmittals(e),Xs.getChangeOrders(e)]);y({documents:t.documents,rfis:s,submittals:a,changeOrders:r,totalCounts:{documents:t.totalCount,rfis:s.length,submittals:a.length,changeOrders:r.length}})}catch(t){console.error("Error loading document data:",t)}finally{o(!1)}},v=[{id:"documents",label:"Documents",icon:wt,count:g.totalCounts.documents,color:"blue"},{id:"rfis",label:"RFIs",icon:_t,count:g.totalCounts.rfis,color:"orange"},{id:"submittals",label:"Submittals",icon:gs,count:g.totalCounts.submittals,color:"green"},{id:"change-orders",label:"Change Orders",icon:rs,count:g.totalCounts.changeOrders,color:"purple"}];return l?d.jsxs("div",{className:"flex items-center justify-center h-64",children:[d.jsx(Bt,{className:"w-8 h-8 animate-spin text-blue-600"}),d.jsx("span",{className:"ml-2 text-gray-600",children:"Loading documents..."})]}):d.jsxs("div",{className:"bg-white rounded-lg shadow-lg",children:[d.jsxs("div",{className:"border-b border-gray-200 px-6 py-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Document Management"}),d.jsx("p",{className:"text-gray-600",children:"Centralized document control and collaboration"})]}),d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsx("button",{onClick:()=>n("grid"===i?"list":"grid"),className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"grid"===i?d.jsx(Pt,{className:"w-4 h-4"}):d.jsx(At,{className:"w-4 h-4"})}),d.jsxs("button",{onClick:()=>x(!u),className:"flex items-center px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[d.jsx(Ct,{className:"w-4 h-4 mr-2"}),"Filters"]}),d.jsxs("label",{className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer",children:[d.jsx(gs,{className:"w-4 h-4 mr-2"}),"Upload",d.jsx("input",{type:"file",multiple:!0,className:"hidden",onChange:t=>t.target.files&&(async t=>{for(const a of Array.from(t))try{await Xs.uploadDocument(e,a,{type:Hs.OTHER,category:Bs.GENERAL,description:`Uploaded file: ${a.name}`})}catch(s){console.error("Error uploading file:",s)}f()})(t.target.files)})]})]})]}),d.jsxs("div",{className:"mt-4 relative",children:[d.jsx(Jt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),d.jsx("input",{type:"text",placeholder:"Search documents, RFIs, submittals...",value:c,onChange:e=>m(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),u&&d.jsx("div",{className:"border-b border-gray-200 px-6 py-4 bg-gray-50",children:d.jsx(Zs,{filters:b,setFilters:j})}),d.jsx("div",{className:"border-b border-gray-200",children:d.jsx("nav",{className:"flex space-x-8 px-6",children:v.map(e=>{const t=e.icon;return d.jsxs("button",{onClick:()=>r(e.id),className:"flex items-center py-4 px-1 border-b-2 font-medium text-sm "+(s===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[d.jsx(t,{className:"w-4 h-4 mr-2"}),e.label,e.count>0&&d.jsx("span",{className:`ml-2 px-2 py-1 text-xs rounded-full bg-${e.color}-100 text-${e.color}-800`,children:e.count})]},e.id)})})}),d.jsxs("div",{className:"p-6",children:["documents"===s&&d.jsx(ea,{documents:g.documents,viewMode:i,selectedItems:h,setSelectedItems:p,onDelete:t=>(async(t,s)=>{try{"document"===s&&await Xs.deleteDocument(e,t),f()}catch(a){console.error("Error deleting item:",a)}})(t,"document"),projectId:e}),"rfis"===s&&d.jsx(sa,{rfis:g.rfis,projectId:e,onRefresh:f}),"submittals"===s&&d.jsx(aa,{submittals:g.submittals,projectId:e,onRefresh:f}),"change-orders"===s&&d.jsx(ra,{changeOrders:g.changeOrders,projectId:e,onRefresh:f})]})]})},Zs=({filters:e,setFilters:t})=>{const s=(s,a)=>{t({...e,[s]:a})};return d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),d.jsx("select",{multiple:!0,value:e.type||[],onChange:e=>s("type",Array.from(e.target.selectedOptions,e=>e.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:Object.values(Hs).map(e=>d.jsx("option",{value:e,children:e.replace("_"," ")},e))})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),d.jsx("select",{multiple:!0,value:e.category||[],onChange:e=>s("category",Array.from(e.target.selectedOptions,e=>e.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:Object.values(Bs).map(e=>d.jsx("option",{value:e,children:e.replace("_"," ")},e))})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),d.jsx("select",{multiple:!0,value:e.status||[],onChange:e=>s("status",Array.from(e.target.selectedOptions,e=>e.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:Object.values(Ws).map(e=>d.jsx("option",{value:e,children:e.replace("_"," ")},e))})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Discipline"}),d.jsx("input",{type:"text",placeholder:"Enter discipline",value:e.discipline?.join(", ")||"",onChange:e=>s("discipline",e.target.value.split(",").map(e=>e.trim()).filter(Boolean)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]})},ea=({documents:e,viewMode:t,selectedItems:s,setSelectedItems:a,onDelete:r,projectId:i})=>{const n=e=>{switch(e){case Ws.APPROVED:return"bg-green-100 text-green-800";case Ws.UNDER_REVIEW:return"bg-yellow-100 text-yellow-800";case Ws.DRAFT:return"bg-gray-100 text-gray-800";case Ws.REJECTED:return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},l=e=>{switch(e){case Hs.DRAWING:return d.jsx(wt,{className:"w-5 h-5 text-blue-600"});case Hs.SPECIFICATION:return d.jsx(wt,{className:"w-5 h-5 text-green-600"});case Hs.CONTRACT:return d.jsx(wt,{className:"w-5 h-5 text-purple-600"});case Hs.PHOTO:return d.jsx(wt,{className:"w-5 h-5 text-orange-600"});default:return d.jsx(wt,{className:"w-5 h-5 text-gray-600"})}};return 0===e.length?d.jsxs("div",{className:"text-center py-12",children:[d.jsx(St,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No documents found"}),d.jsx("p",{className:"text-gray-600 mb-4",children:"Upload your first document to get started"}),d.jsxs("label",{className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 cursor-pointer",children:[d.jsx(gs,{className:"w-4 h-4 mr-2"}),"Upload Document",d.jsx("input",{type:"file",multiple:!0,className:"hidden"})]})]}):"grid"===t?d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:e.map(e=>d.jsx(ta,{document:e,onDelete:r},e.id))}):d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[d.jsx("thead",{className:"bg-gray-50",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:d.jsx("input",{type:"checkbox",className:"rounded border-gray-300",onChange:t=>{t.target.checked?a(e.map(e=>e.id)):a([])}})}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Document"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Version"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Modified"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(e=>d.jsxs("tr",{className:"hover:bg-gray-50",children:[d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsx("input",{type:"checkbox",className:"rounded border-gray-300",checked:s.includes(e.id),onChange:t=>{t.target.checked?a([...s,e.id]):a(s.filter(t=>t!==e.id))}})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsxs("div",{className:"flex items-center",children:[l(e.type),d.jsxs("div",{className:"ml-3",children:[d.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.name}),d.jsx("div",{className:"text-sm text-gray-500",children:e.description})]})]})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsx("span",{className:"text-sm text-gray-900",children:e.type.replace("_"," ")})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${n(e.status)}`,children:e.status.replace("_"," ")})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.version}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.updatedAt.toLocaleDateString()}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{className:"text-blue-600 hover:text-blue-900",children:d.jsx(Nt,{className:"w-4 h-4"})}),d.jsx("button",{className:"text-green-600 hover:text-green-900",children:d.jsx(ft,{className:"w-4 h-4"})}),d.jsx("button",{className:"text-gray-600 hover:text-gray-900",children:d.jsx(rs,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>r(e.id),className:"text-red-600 hover:text-red-900",children:d.jsx(ms,{className:"w-4 h-4"})})]})})]},e.id))})]})})},ta=({document:e,onDelete:t})=>d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"flex items-start justify-between mb-3",children:[d.jsx(wt,{className:"w-8 h-8 text-blue-600"}),d.jsx("div",{className:"relative",children:d.jsx("button",{className:"text-gray-400 hover:text-gray-600",children:d.jsx(vt,{className:"w-4 h-4"})})})]}),d.jsx("h3",{className:"font-medium text-gray-900 mb-1 truncate",children:e.name}),d.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:e.description}),d.jsxs("div",{className:"flex items-center justify-between mb-3",children:[d.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${(e=>{switch(e){case Ws.APPROVED:return"bg-green-100 text-green-800";case Ws.UNDER_REVIEW:return"bg-yellow-100 text-yellow-800";case Ws.DRAFT:return"bg-gray-100 text-gray-800";case Ws.REJECTED:return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(e.status)}`,children:e.status.replace("_"," ")}),d.jsxs("span",{className:"text-xs text-gray-500",children:["v",e.version]})]}),d.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500",children:[d.jsx("span",{children:e.updatedAt.toLocaleDateString()}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{className:"text-blue-600 hover:text-blue-800",children:d.jsx(Nt,{className:"w-3 h-3"})}),d.jsx("button",{className:"text-green-600 hover:text-green-800",children:d.jsx(ft,{className:"w-3 h-3"})}),d.jsx("button",{onClick:()=>t(e.id),className:"text-red-600 hover:text-red-800",children:d.jsx(ms,{className:"w-3 h-3"})})]})]})]}),sa=({rfis:e,projectId:t,onRefresh:s})=>{const[r,i]=a.useState(!1),[n,l]=a.useState(null),[o,c]=a.useState(!1),m=e=>{switch(e){case Js.OPEN:return"bg-red-100 text-red-800";case Js.UNDER_REVIEW:return"bg-yellow-100 text-yellow-800";case Js.RESPONDED:return"bg-blue-100 text-blue-800";case Js.CLOSED:return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}},u=e=>{switch(e){case Gs.CRITICAL:return"bg-red-500";case Gs.HIGH:return"bg-orange-500";case Gs.MEDIUM:return"bg-yellow-500";case Gs.LOW:return"bg-green-500";default:return"bg-gray-500"}};return d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Request for Information (RFI)"}),d.jsx("p",{className:"text-sm text-gray-600",children:"Manage project clarifications and questions"})]}),d.jsxs("button",{onClick:()=>i(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-4 h-4 mr-2"}),"Create RFI"]})]}),0===e.length?d.jsxs("div",{className:"text-center py-12",children:[d.jsx(_t,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No RFIs found"}),d.jsx("p",{className:"text-gray-600 mb-4",children:"Create your first RFI to get clarification on project details"}),d.jsxs("button",{onClick:()=>i(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-4 h-4 mr-2"}),"Create RFI"]})]}):d.jsx("div",{className:"grid gap-4",children:e.map(e=>d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"flex items-start justify-between mb-4",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center mb-2",children:[d.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:e.title}),d.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["#",e.number]}),d.jsx("div",{className:`ml-2 w-3 h-3 rounded-full ${u(e.priority)}`})]}),d.jsx("p",{className:"text-gray-600 mb-3",children:e.description}),d.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg mb-3",children:[d.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Question:"}),d.jsx("p",{className:"text-sm text-gray-900",children:e.question})]})]}),d.jsxs("div",{className:"ml-4 flex flex-col items-end space-y-2",children:[d.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${m(e.status)}`,children:e.status.replace("_"," ")}),d.jsxs("div",{className:"flex space-x-1",children:[d.jsx("button",{onClick:()=>{l(e),c(!0)},className:"p-1 text-blue-600 hover:text-blue-800",title:"Respond",children:d.jsx(_t,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-1 text-gray-600 hover:text-gray-800",title:"Edit",children:d.jsx(rs,{className:"w-4 h-4"})})]})]})]}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Requested by:"}),d.jsx("p",{className:"font-medium",children:e.requestedCompany})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Assigned to:"}),d.jsx("p",{className:"font-medium",children:e.assignedCompany})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Due date:"}),d.jsx("p",{className:"font-medium",children:e.dueDate.toLocaleDateString()})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Discipline:"}),d.jsx("p",{className:"font-medium",children:e.discipline})]})]}),e.costImpact&&d.jsxs("div",{className:"mt-3 flex items-center space-x-4 text-sm",children:[d.jsxs("span",{className:"text-red-600",children:["Cost Impact: $",e.costImpact.toLocaleString()]}),e.scheduleImpact&&d.jsxs("span",{className:"text-orange-600",children:["Schedule Impact: ",e.scheduleImpact," days"]})]}),e.response&&d.jsxs("div",{className:"mt-4 bg-blue-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-sm font-medium text-blue-700 mb-1",children:"Response:"}),d.jsx("p",{className:"text-sm text-blue-900",children:e.response.content}),d.jsxs("p",{className:"text-xs text-blue-600 mt-2",children:["Responded by ",e.response.respondedBy," on ",e.response.respondedAt.toLocaleDateString()]})]})]},e.id))}),r&&d.jsx(ia,{projectId:t,onClose:()=>i(!1),onSuccess:()=>{i(!1),s()}}),o&&n&&d.jsx(na,{rfi:n,projectId:t,onClose:()=>{c(!1),l(null)},onSuccess:()=>{c(!1),l(null),s()}})]})},aa=({submittals:e,projectId:t,onRefresh:s})=>{const[r,i]=a.useState(!1),[n,l]=a.useState(null),[o,c]=a.useState(!1),m=e=>{switch(e){case Ys.NOT_SUBMITTED:return"bg-gray-100 text-gray-800";case Ys.SUBMITTED:return"bg-blue-100 text-blue-800";case Ys.UNDER_REVIEW:return"bg-yellow-100 text-yellow-800";case Ys.APPROVED:case Ys.APPROVED_WITH_COMMENTS:return"bg-green-100 text-green-800";case Ys.REJECTED:return"bg-red-100 text-red-800";case Ys.RESUBMIT:return"bg-orange-100 text-orange-800";default:return"bg-gray-100 text-gray-800"}},u=e=>{switch(e){case Gs.CRITICAL:return"bg-red-500";case Gs.HIGH:return"bg-orange-500";case Gs.MEDIUM:return"bg-yellow-500";case Gs.LOW:return"bg-green-500";default:return"bg-gray-500"}};return d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Submittal Management"}),d.jsx("p",{className:"text-sm text-gray-600",children:"Track and review project submittals"})]}),d.jsxs("button",{onClick:()=>i(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-4 h-4 mr-2"}),"Create Submittal"]})]}),0===e.length?d.jsxs("div",{className:"text-center py-12",children:[d.jsx(gs,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No submittals found"}),d.jsx("p",{className:"text-gray-600 mb-4",children:"Create your first submittal to track project approvals"}),d.jsxs("button",{onClick:()=>i(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-4 h-4 mr-2"}),"Create Submittal"]})]}):d.jsx("div",{className:"grid gap-4",children:e.map(e=>d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"flex items-start justify-between mb-4",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center mb-2",children:[d.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:e.title}),d.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["#",e.number]}),d.jsx("div",{className:`ml-2 w-3 h-3 rounded-full ${u(e.priority)}`})]}),d.jsx("p",{className:"text-gray-600 mb-3",children:e.description}),d.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[d.jsxs("span",{children:[d.jsx("strong",{children:"Type:"})," ",e.type.replace("_"," ")]}),d.jsxs("span",{children:[d.jsx("strong",{children:"Specification:"})," ",e.specification]}),d.jsxs("span",{children:[d.jsx("strong",{children:"Discipline:"})," ",e.discipline]})]})]}),d.jsxs("div",{className:"ml-4 flex flex-col items-end space-y-2",children:[d.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${m(e.status)}`,children:e.status.replace("_"," ")}),d.jsxs("div",{className:"flex space-x-1",children:[d.jsx("button",{onClick:()=>{l(e),c(!0)},className:"p-1 text-blue-600 hover:text-blue-800",title:"Review",children:d.jsx(ut,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-1 text-gray-600 hover:text-gray-800",title:"Edit",children:d.jsx(rs,{className:"w-4 h-4"})})]})]})]}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Submitted by:"}),d.jsx("p",{className:"font-medium",children:e.submittedCompany})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Due date:"}),d.jsx("p",{className:"font-medium",children:e.dueDate.toLocaleDateString()})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Submission date:"}),d.jsx("p",{className:"font-medium",children:e.submissionDate.toLocaleDateString()})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Copies:"}),d.jsx("p",{className:"font-medium",children:e.copies})]})]}),e.reviews.length>0&&d.jsxs("div",{className:"mt-4 bg-blue-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-sm font-medium text-blue-700 mb-1",children:"Latest Review:"}),d.jsx("p",{className:"text-sm text-blue-900",children:e.reviews[e.reviews.length-1].comments}),d.jsxs("p",{className:"text-xs text-blue-600 mt-2",children:["Reviewed by ",e.reviews[e.reviews.length-1].reviewedBy," on ",e.reviews[e.reviews.length-1].reviewedAt.toLocaleDateString()]})]})]},e.id))}),r&&d.jsx(la,{projectId:t,onClose:()=>i(!1),onSuccess:()=>{i(!1),s()}}),o&&n&&d.jsx(oa,{submittal:n,projectId:t,onClose:()=>{c(!1),l(null)},onSuccess:()=>{c(!1),l(null),s()}})]})},ra=({changeOrders:e,projectId:t,onRefresh:s})=>{const[r,i]=a.useState(!1),[n,l]=a.useState(null),[o,c]=a.useState(!1),m=e=>{switch(e){case Qs.DRAFT:return"bg-gray-100 text-gray-800";case Qs.SUBMITTED:return"bg-blue-100 text-blue-800";case Qs.UNDER_REVIEW:return"bg-yellow-100 text-yellow-800";case Qs.APPROVED:return"bg-green-100 text-green-800";case Qs.REJECTED:return"bg-red-100 text-red-800";case Qs.IMPLEMENTED:return"bg-purple-100 text-purple-800";case Qs.CANCELLED:default:return"bg-gray-100 text-gray-800"}},u=e=>{switch(e){case Gs.CRITICAL:return"bg-red-500";case Gs.HIGH:return"bg-orange-500";case Gs.MEDIUM:return"bg-yellow-500";case Gs.LOW:return"bg-green-500";default:return"bg-gray-500"}};return d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Change Order Management"}),d.jsx("p",{className:"text-sm text-gray-600",children:"Track project scope and cost changes"})]}),d.jsxs("button",{onClick:()=>i(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-4 h-4 mr-2"}),"Create Change Order"]})]}),0===e.length?d.jsxs("div",{className:"text-center py-12",children:[d.jsx(rs,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No change orders found"}),d.jsx("p",{className:"text-gray-600 mb-4",children:"Create your first change order to track project modifications"}),d.jsxs("button",{onClick:()=>i(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-4 h-4 mr-2"}),"Create Change Order"]})]}):d.jsx("div",{className:"grid gap-4",children:e.map(e=>{return d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"flex items-start justify-between mb-4",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center mb-2",children:[d.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:e.title}),d.jsxs("span",{className:"ml-2 text-sm text-gray-500",children:["#",e.number]}),d.jsx("div",{className:`ml-2 w-3 h-3 rounded-full ${u(e.priority)}`})]}),d.jsx("p",{className:"text-gray-600 mb-3",children:e.description}),d.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[d.jsxs("span",{children:[d.jsx("strong",{children:"Type:"})," ",e.type.replace("_"," ")]}),d.jsxs("span",{children:[d.jsx("strong",{children:"Reason:"})," ",e.reason.replace("_"," ")]})]})]}),d.jsxs("div",{className:"ml-4 flex flex-col items-end space-y-2",children:[d.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${m(e.status)}`,children:e.status.replace("_"," ")}),d.jsxs("div",{className:"flex space-x-1",children:[d.jsx("button",{onClick:()=>{l(e),c(!0)},className:"p-1 text-green-600 hover:text-green-800",title:"Approve",children:d.jsx(ut,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-1 text-gray-600 hover:text-gray-800",title:"Edit",children:d.jsx(rs,{className:"w-4 h-4"})})]})]})]}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm mb-4",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Cost Impact:"}),d.jsx("p",{className:"font-medium "+(e.costImpact>=0?"text-red-600":"text-green-600"),children:(t=e.costImpact,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t))})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Schedule Impact:"}),d.jsxs("p",{className:"font-medium "+(e.scheduleImpact>0?"text-red-600":e.scheduleImpact<0?"text-green-600":"text-gray-900"),children:[e.scheduleImpact>0?"+":"",e.scheduleImpact," days"]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Requested by:"}),d.jsx("p",{className:"font-medium",children:e.requestedBy})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Assigned to:"}),d.jsx("p",{className:"font-medium",children:e.assignedTo})]})]}),d.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg mb-3",children:[d.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Justification:"}),d.jsx("p",{className:"text-sm text-gray-900",children:e.justification})]}),e.scope&&d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.scope.addedWork.length>0&&d.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[d.jsx("p",{className:"font-medium text-green-700 mb-1",children:"Added Work:"}),d.jsxs("p",{className:"text-green-900",children:[e.scope.addedWork.length," items"]})]}),e.scope.deletedWork.length>0&&d.jsxs("div",{className:"bg-red-50 p-3 rounded-lg",children:[d.jsx("p",{className:"font-medium text-red-700 mb-1",children:"Deleted Work:"}),d.jsxs("p",{className:"text-red-900",children:[e.scope.deletedWork.length," items"]})]}),e.scope.modifiedWork.length>0&&d.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[d.jsx("p",{className:"font-medium text-blue-700 mb-1",children:"Modified Work:"}),d.jsxs("p",{className:"text-blue-900",children:[e.scope.modifiedWork.length," items"]})]})]}),e.approvals.length>0&&d.jsxs("div",{className:"mt-4 bg-blue-50 p-3 rounded-lg",children:[d.jsx("p",{className:"text-sm font-medium text-blue-700 mb-1",children:"Approvals:"}),d.jsx("div",{className:"space-y-1",children:e.approvals.map((e,t)=>d.jsxs("p",{className:"text-sm text-blue-900",children:[e.approverType,": ",e.status," by ",e.approver,e.approvedAt&&` on ${e.approvedAt.toLocaleDateString()}`]},t))})]})]},e.id);var t})}),r&&d.jsx(ca,{projectId:t,onClose:()=>i(!1),onSuccess:()=>{i(!1),s()}}),o&&n&&d.jsx(da,{changeOrder:n,projectId:t,onClose:()=>{c(!1),l(null)},onSuccess:()=>{c(!1),l(null),s()}})]})},ia=({projectId:e,onClose:t,onSuccess:s})=>{const[r,i]=a.useState({title:"",description:"",question:"",priority:Gs.MEDIUM,category:"design_clarification",discipline:"",assignedTo:"",assignedCompany:"",dueDate:new Date(Date.now()+6048e5).toISOString().split("T")[0],costImpact:"",scheduleImpact:""}),[n,l]=a.useState(!1);return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create New RFI"})}),d.jsxs("form",{onSubmit:async t=>{t.preventDefault(),l(!0);try{await Xs.createRFI(e,{...r,dueDate:new Date(r.dueDate),costImpact:r.costImpact?parseFloat(r.costImpact):void 0,scheduleImpact:r.scheduleImpact?parseInt(r.scheduleImpact):void 0}),s()}catch(a){console.error("Error creating RFI:",a)}finally{l(!1)}},className:"p-6 space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),d.jsx("input",{type:"text",required:!0,value:r.title,onChange:e=>i({...r,title:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Brief description of the RFI"})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),d.jsx("textarea",{value:r.description,onChange:e=>i({...r,description:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Detailed description of the issue or context"})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Question *"}),d.jsx("textarea",{required:!0,value:r.question,onChange:e=>i({...r,question:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Specific question that needs to be answered"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),d.jsxs("select",{value:r.priority,onChange:e=>i({...r,priority:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:Gs.LOW,children:"Low"}),d.jsx("option",{value:Gs.MEDIUM,children:"Medium"}),d.jsx("option",{value:Gs.HIGH,children:"High"}),d.jsx("option",{value:Gs.CRITICAL,children:"Critical"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Discipline"}),d.jsx("input",{type:"text",value:r.discipline,onChange:e=>i({...r,discipline:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Architectural, Structural"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assigned To"}),d.jsx("input",{type:"text",value:r.assignedTo,onChange:e=>i({...r,assignedTo:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Person responsible for response"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assigned Company"}),d.jsx("input",{type:"text",value:r.assignedCompany,onChange:e=>i({...r,assignedCompany:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Company responsible for response"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),d.jsx("input",{type:"date",value:r.dueDate,onChange:e=>i({...r,dueDate:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cost Impact ($)"}),d.jsx("input",{type:"number",value:r.costImpact,onChange:e=>i({...r,costImpact:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Estimated cost impact"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Schedule Impact (days)"}),d.jsx("input",{type:"number",value:r.scheduleImpact,onChange:e=>i({...r,scheduleImpact:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Estimated schedule impact"})]})]}),d.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[d.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),d.jsx("button",{type:"submit",disabled:n,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:n?"Creating...":"Create RFI"})]})]})]})})},na=({rfi:e,projectId:t,onClose:s,onSuccess:r})=>{const[i,n]=a.useState(""),[l,o]=a.useState(!1),[c,m]=a.useState(""),[u,x]=a.useState(!1);return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[d.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Respond to RFI #",e.number]}),d.jsx("p",{className:"text-sm text-gray-600",children:e.title})]}),d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[d.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Original Question:"}),d.jsx("p",{className:"text-gray-700",children:e.question})]}),d.jsxs("form",{onSubmit:async s=>{s.preventDefault(),x(!0);try{await Xs.respondToRFI(t,e.id,{content:i,followUpRequired:l,followUpActions:l?c.split("\n").filter(Boolean):[]}),r()}catch(a){console.error("Error responding to RFI:",a)}finally{x(!1)}},className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Response *"}),d.jsx("textarea",{required:!0,value:i,onChange:e=>n(e.target.value),rows:6,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Provide a detailed response to the question"})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",id:"followUpRequired",checked:l,onChange:e=>o(e.target.checked),className:"rounded border-gray-300"}),d.jsx("label",{htmlFor:"followUpRequired",className:"ml-2 text-sm text-gray-700",children:"Follow-up actions required"})]}),l&&d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Follow-up Actions"}),d.jsx("textarea",{value:c,onChange:e=>m(e.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"List required follow-up actions (one per line)"})]}),d.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[d.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),d.jsx("button",{type:"submit",disabled:u,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:u?"Submitting...":"Submit Response"})]})]})]})]})})},la=({projectId:e,onClose:t,onSuccess:s})=>{const[r,i]=a.useState({title:"",description:"",type:"product_data",category:"general",discipline:"",specification:"",priority:Gs.MEDIUM,dueDate:new Date(Date.now()+12096e5).toISOString().split("T")[0],copies:"1",deliveryMethod:"electronic"}),[n,l]=a.useState(!1);return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create New Submittal"})}),d.jsxs("form",{onSubmit:async t=>{t.preventDefault(),l(!0);try{await Xs.createSubmittal(e,{...r,dueDate:new Date(r.dueDate),copies:parseInt(r.copies)}),s()}catch(a){console.error("Error creating submittal:",a)}finally{l(!1)}},className:"p-6 space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),d.jsx("input",{type:"text",required:!0,value:r.title,onChange:e=>i({...r,title:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Submittal title"})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),d.jsx("textarea",{value:r.description,onChange:e=>i({...r,description:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Detailed description of the submittal"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),d.jsxs("select",{value:r.type,onChange:e=>i({...r,type:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"shop_drawings",children:"Shop Drawings"}),d.jsx("option",{value:"product_data",children:"Product Data"}),d.jsx("option",{value:"samples",children:"Samples"}),d.jsx("option",{value:"certificates",children:"Certificates"}),d.jsx("option",{value:"test_reports",children:"Test Reports"}),d.jsx("option",{value:"operation_manuals",children:"Operation Manuals"}),d.jsx("option",{value:"warranty",children:"Warranty"}),d.jsx("option",{value:"other",children:"Other"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),d.jsxs("select",{value:r.category,onChange:e=>i({...r,category:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"architectural",children:"Architectural"}),d.jsx("option",{value:"structural",children:"Structural"}),d.jsx("option",{value:"mechanical",children:"Mechanical"}),d.jsx("option",{value:"electrical",children:"Electrical"}),d.jsx("option",{value:"plumbing",children:"Plumbing"}),d.jsx("option",{value:"fire_protection",children:"Fire Protection"}),d.jsx("option",{value:"specialty",children:"Specialty"}),d.jsx("option",{value:"general",children:"General"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Discipline"}),d.jsx("input",{type:"text",value:r.discipline,onChange:e=>i({...r,discipline:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., HVAC, Electrical"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Specification"}),d.jsx("input",{type:"text",value:r.specification,onChange:e=>i({...r,specification:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., 05 12 00"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),d.jsxs("select",{value:r.priority,onChange:e=>i({...r,priority:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:Gs.LOW,children:"Low"}),d.jsx("option",{value:Gs.MEDIUM,children:"Medium"}),d.jsx("option",{value:Gs.HIGH,children:"High"}),d.jsx("option",{value:Gs.CRITICAL,children:"Critical"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),d.jsx("input",{type:"date",value:r.dueDate,onChange:e=>i({...r,dueDate:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Copies Required"}),d.jsx("input",{type:"number",min:"1",value:r.copies,onChange:e=>i({...r,copies:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Delivery Method"}),d.jsxs("select",{value:r.deliveryMethod,onChange:e=>i({...r,deliveryMethod:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"electronic",children:"Electronic"}),d.jsx("option",{value:"hard_copy",children:"Hard Copy"}),d.jsx("option",{value:"both",children:"Both"})]})]})]}),d.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[d.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),d.jsx("button",{type:"submit",disabled:n,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:n?"Creating...":"Create Submittal"})]})]})]})})},oa=({submittal:e,projectId:t,onClose:s,onSuccess:r})=>{const[i,n]=a.useState({status:"approved",comments:"",actionRequired:!1,actions:""}),[l,o]=a.useState(!1);return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[d.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Review Submittal #",e.number]}),d.jsx("p",{className:"text-sm text-gray-600",children:e.title})]}),d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[d.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Submittal Details:"}),d.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[d.jsxs("div",{children:[d.jsx("strong",{children:"Type:"})," ",e.type.replace("_"," ")]}),d.jsxs("div",{children:[d.jsx("strong",{children:"Specification:"})," ",e.specification]}),d.jsxs("div",{children:[d.jsx("strong",{children:"Discipline:"})," ",e.discipline]}),d.jsxs("div",{children:[d.jsx("strong",{children:"Due Date:"})," ",e.dueDate.toLocaleDateString()]})]}),d.jsx("p",{className:"text-gray-700 mt-2",children:e.description})]}),d.jsxs("form",{onSubmit:async s=>{s.preventDefault(),o(!0);try{await Xs.reviewSubmittal(t,e.id,{...i,actions:i.actionRequired?i.actions.split("\n").filter(Boolean):[]}),r()}catch(a){console.error("Error reviewing submittal:",a)}finally{o(!1)}},className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Review Status *"}),d.jsxs("select",{required:!0,value:i.status,onChange:e=>n({...i,status:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"approved",children:"Approved"}),d.jsx("option",{value:"approved_with_comments",children:"Approved with Comments"}),d.jsx("option",{value:"rejected",children:"Rejected"}),d.jsx("option",{value:"revise_and_resubmit",children:"Revise and Resubmit"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Comments *"}),d.jsx("textarea",{required:!0,value:i.comments,onChange:e=>n({...i,comments:e.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Provide detailed review comments"})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",id:"actionRequired",checked:i.actionRequired,onChange:e=>n({...i,actionRequired:e.target.checked}),className:"rounded border-gray-300"}),d.jsx("label",{htmlFor:"actionRequired",className:"ml-2 text-sm text-gray-700",children:"Action items required"})]}),i.actionRequired&&d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Action Items"}),d.jsx("textarea",{value:i.actions,onChange:e=>n({...i,actions:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"List required action items (one per line)"})]}),d.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[d.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),d.jsx("button",{type:"submit",disabled:l,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:l?"Submitting...":"Submit Review"})]})]})]})]})})},ca=({projectId:e,onClose:t,onSuccess:s})=>{const[r,i]=a.useState({title:"",description:"",type:"addition",reason:"scope_change",priority:Gs.MEDIUM,costImpact:"",scheduleImpact:"",justification:"",assignedTo:""}),[n,l]=a.useState(!1);return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create New Change Order"})}),d.jsxs("form",{onSubmit:async t=>{t.preventDefault(),l(!0);try{await Xs.createChangeOrder(e,{...r,costImpact:r.costImpact?parseFloat(r.costImpact):0,scheduleImpact:r.scheduleImpact?parseInt(r.scheduleImpact):0}),s()}catch(a){console.error("Error creating change order:",a)}finally{l(!1)}},className:"p-6 space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),d.jsx("input",{type:"text",required:!0,value:r.title,onChange:e=>i({...r,title:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Brief description of the change"})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),d.jsx("textarea",{value:r.description,onChange:e=>i({...r,description:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Detailed description of the change"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),d.jsxs("select",{value:r.type,onChange:e=>i({...r,type:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"addition",children:"Addition"}),d.jsx("option",{value:"deletion",children:"Deletion"}),d.jsx("option",{value:"modification",children:"Modification"}),d.jsx("option",{value:"time_extension",children:"Time Extension"}),d.jsx("option",{value:"credit",children:"Credit"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reason"}),d.jsxs("select",{value:r.reason,onChange:e=>i({...r,reason:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"design_change",children:"Design Change"}),d.jsx("option",{value:"scope_change",children:"Scope Change"}),d.jsx("option",{value:"unforeseen_conditions",children:"Unforeseen Conditions"}),d.jsx("option",{value:"owner_request",children:"Owner Request"}),d.jsx("option",{value:"regulatory_change",children:"Regulatory Change"}),d.jsx("option",{value:"material_substitution",children:"Material Substitution"}),d.jsx("option",{value:"error_omission",children:"Error/Omission"}),d.jsx("option",{value:"value_engineering",children:"Value Engineering"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),d.jsxs("select",{value:r.priority,onChange:e=>i({...r,priority:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:Gs.LOW,children:"Low"}),d.jsx("option",{value:Gs.MEDIUM,children:"Medium"}),d.jsx("option",{value:Gs.HIGH,children:"High"}),d.jsx("option",{value:Gs.CRITICAL,children:"Critical"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assigned To"}),d.jsx("input",{type:"text",value:r.assignedTo,onChange:e=>i({...r,assignedTo:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Person responsible for review"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cost Impact ($)"}),d.jsx("input",{type:"number",step:"0.01",value:r.costImpact,onChange:e=>i({...r,costImpact:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Positive for cost increase, negative for savings"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Schedule Impact (days)"}),d.jsx("input",{type:"number",value:r.scheduleImpact,onChange:e=>i({...r,scheduleImpact:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Positive for delay, negative for acceleration"})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Justification *"}),d.jsx("textarea",{required:!0,value:r.justification,onChange:e=>i({...r,justification:e.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Detailed justification for the change order"})]})]}),d.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[d.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),d.jsx("button",{type:"submit",disabled:n,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:n?"Creating...":"Create Change Order"})]})]})]})})},da=({changeOrder:e,projectId:t,onClose:s,onSuccess:r})=>{const[i,n]=a.useState({status:"approved",comments:"",conditions:""}),[l,o]=a.useState(!1);return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[d.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Approve Change Order #",e.number]}),d.jsx("p",{className:"text-sm text-gray-600",children:e.title})]}),d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[d.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Change Order Summary:"}),d.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-3",children:[d.jsxs("div",{children:[d.jsx("strong",{children:"Type:"})," ",e.type.replace("_"," ")]}),d.jsxs("div",{children:[d.jsx("strong",{children:"Reason:"})," ",e.reason.replace("_"," ")]}),d.jsxs("div",{children:[d.jsx("strong",{children:"Cost Impact:"})," ",d.jsx("span",{className:e.costImpact>=0?"text-red-600":"text-green-600",children:(c=e.costImpact,new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(c))})]}),d.jsxs("div",{children:[d.jsx("strong",{children:"Schedule Impact:"})," ",d.jsxs("span",{className:e.scheduleImpact>0?"text-red-600":e.scheduleImpact<0?"text-green-600":"text-gray-900",children:[e.scheduleImpact>0?"+":"",e.scheduleImpact," days"]})]})]}),d.jsxs("p",{className:"text-gray-700",children:[d.jsx("strong",{children:"Description:"})," ",e.description]}),d.jsxs("p",{className:"text-gray-700 mt-2",children:[d.jsx("strong",{children:"Justification:"})," ",e.justification]})]}),d.jsxs("form",{onSubmit:async s=>{s.preventDefault(),o(!0);try{await Xs.approveChangeOrder(t,e.id,{...i,conditions:i.conditions?i.conditions.split("\n").filter(Boolean):[]}),r()}catch(a){console.error("Error approving change order:",a)}finally{o(!1)}},className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Approval Status *"}),d.jsxs("select",{required:!0,value:i.status,onChange:e=>n({...i,status:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"approved",children:"Approved"}),d.jsx("option",{value:"rejected",children:"Rejected"}),d.jsx("option",{value:"conditional",children:"Conditional Approval"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Comments *"}),d.jsx("textarea",{required:!0,value:i.comments,onChange:e=>n({...i,comments:e.target.value}),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Provide detailed approval comments"})]}),"conditional"===i.status&&d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Conditions"}),d.jsx("textarea",{value:i.conditions,onChange:e=>n({...i,conditions:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"List approval conditions (one per line)"})]}),d.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[d.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),d.jsx("button",{type:"submit",disabled:l,className:"px-4 py-2 text-white rounded-lg disabled:opacity-50 "+("approved"===i.status?"bg-green-600 hover:bg-green-700":"rejected"===i.status?"bg-red-600 hover:bg-red-700":"bg-yellow-600 hover:bg-yellow-700"),children:l?"Submitting...":""+("approved"===i.status?"Approve":"rejected"===i.status?"Reject":"Conditionally Approve")})]})]})]})]})});var c};const ma=new class{constructor(){this.baseUrl="/api/analytics"}async getProjectMetrics(e,t){try{const s=new URLSearchParams;t&&(s.append("start",t.dateRange.start.toISOString()),s.append("end",t.dateRange.end.toISOString()),t.granularity&&s.append("granularity",t.granularity),t.metrics&&t.metrics.forEach(e=>s.append("metrics",e)));const a=await fetch(`${this.baseUrl}/projects/${e}/metrics?${s}`);if(!a.ok)throw new Error("Failed to fetch project metrics");return await a.json()}catch(s){return console.error("Error fetching project metrics:",s),this.getMockProjectMetrics(e)}}async getBudgetAnalysis(e){try{const t=await fetch(`${this.baseUrl}/projects/${e}/budget`);if(!t.ok)throw new Error("Failed to fetch budget analysis");return await t.json()}catch(t){return console.error("Error fetching budget analysis:",t),this.getMockBudgetMetrics()}}async getScheduleAnalysis(e){try{const t=await fetch(`${this.baseUrl}/projects/${e}/schedule`);if(!t.ok)throw new Error("Failed to fetch schedule analysis");return await t.json()}catch(t){return console.error("Error fetching schedule analysis:",t),this.getMockScheduleMetrics()}}async getQualityMetrics(e){try{const t=await fetch(`${this.baseUrl}/projects/${e}/quality`);if(!t.ok)throw new Error("Failed to fetch quality metrics");return await t.json()}catch(t){return console.error("Error fetching quality metrics:",t),this.getMockQualityMetrics()}}async getSafetyMetrics(e){try{const t=await fetch(`${this.baseUrl}/projects/${e}/safety`);if(!t.ok)throw new Error("Failed to fetch safety metrics");return await t.json()}catch(t){return console.error("Error fetching safety metrics:",t),this.getMockSafetyMetrics()}}async getProductivityMetrics(e){try{const t=await fetch(`${this.baseUrl}/projects/${e}/productivity`);if(!t.ok)throw new Error("Failed to fetch productivity metrics");return await t.json()}catch(t){return console.error("Error fetching productivity metrics:",t),this.getMockProductivityMetrics()}}async getRiskAnalysis(e){try{const t=await fetch(`${this.baseUrl}/projects/${e}/risks`);if(!t.ok)throw new Error("Failed to fetch risk analysis");return await t.json()}catch(t){return console.error("Error fetching risk analysis:",t),this.getMockRiskMetrics()}}async getTeamMetrics(e){try{const t=await fetch(`${this.baseUrl}/projects/${e}/team`);if(!t.ok)throw new Error("Failed to fetch team metrics");return await t.json()}catch(t){return console.error("Error fetching team metrics:",t),this.getMockTeamMetrics()}}async getDashboardWidgets(e){try{const t=await fetch(`${this.baseUrl}/projects/${e}/dashboard`);if(!t.ok)throw new Error("Failed to fetch dashboard widgets");return await t.json()}catch(t){return console.error("Error fetching dashboard widgets:",t),this.getMockDashboardWidgets()}}async updateDashboardWidget(e,t,s){try{const a=await fetch(`${this.baseUrl}/projects/${e}/dashboard/${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw new Error("Failed to update dashboard widget");return await a.json()}catch(a){return console.error("Error updating dashboard widget:",a),this.getMockDashboardWidgets()[0]}}getMockProjectMetrics(e){const t=new Date,s=[];for(let a=30;a>=0;a--){const r=new Date(t.getTime()-24*a*60*60*1e3);s.push({id:`metrics-${a}`,projectId:e,date:r,budget:this.getMockBudgetMetrics(),schedule:this.getMockScheduleMetrics(),quality:this.getMockQualityMetrics(),safety:this.getMockSafetyMetrics(),productivity:this.getMockProductivityMetrics(),risks:this.getMockRiskMetrics(),team:this.getMockTeamMetrics()})}return s}getMockBudgetMetrics(){return{totalBudget:25e5,spentToDate:175e4,committedCosts:2e5,forecastAtCompletion:245e4,varianceAtCompletion:-5e4,costPerformanceIndex:1.02,budgetPerformanceIndex:.98,earnedValue:18e5,plannedValue:185e4,actualCost:175e4,costByCategory:{Labor:85e4,Materials:65e4,Equipment:15e4,Subcontractors:1e5},changeOrderValue:75e3,contingencyUsed:125e3,contingencyRemaining:125e3}}getMockScheduleMetrics(){return{totalDuration:365,elapsedDays:245,remainingDays:125,percentComplete:67,schedulePerformanceIndex:.97,criticalPathDelay:5,milestonesTotal:12,milestonesCompleted:8,milestonesOverdue:1,tasksTotal:156,tasksCompleted:104,tasksInProgress:28,tasksOverdue:8,forecastCompletion:new Date(Date.now()+11232e6),originalCompletion:new Date(Date.now()+108e8),scheduleVariance:5}}getMockQualityMetrics(){return{inspectionsPassed:45,inspectionsFailed:3,inspectionsTotal:48,defectRate:2.1,reworkHours:120,reworkCost:15e3,qualityScore:94,punchListItems:23,punchListResolved:18,nonConformanceReports:2,customerSatisfactionScore:4.6,qualityTrends:[{date:new Date(Date.now()-2592e6),score:92,defectRate:2.5,inspectionPassRate:92},{date:new Date(Date.now()-1296e6),score:93,defectRate:2.3,inspectionPassRate:94},{date:new Date,score:94,defectRate:2.1,inspectionPassRate:94}]}}getMockSafetyMetrics(){return{incidentRate:.8,nearMissReports:12,safetyTrainingHours:480,safetyInspections:24,safetyViolations:3,daysWithoutIncident:45,safetyScore:96,ppeComplianceRate:98,safetyMeetingsHeld:16,hazardsIdentified:28,hazardsResolved:25}}getMockProductivityMetrics(){return{laborHoursPlanned:12e3,laborHoursActual:11800,laborEfficiency:102,equipmentUtilization:87,materialWastePercentage:3.2,dailyProductionRate:95,unitsCompleted:2340,unitsPlanned:2400,productivityTrends:[{date:new Date(Date.now()-2592e6),efficiency:98,outputRate:92,laborHours:400},{date:new Date(Date.now()-1296e6),efficiency:100,outputRate:94,laborHours:420},{date:new Date,efficiency:102,outputRate:95,laborHours:380}],teamProductivity:{"team-1":105,"team-2":98,"team-3":103}}}getMockRiskMetrics(){return{totalRisks:18,highRisks:2,mediumRisks:8,lowRisks:8,mitigatedRisks:12,riskScore:24,riskTrends:[{date:new Date(Date.now()-2592e6),totalRisks:22,riskScore:32,mitigatedRisks:8},{date:new Date(Date.now()-1296e6),totalRisks:20,riskScore:28,mitigatedRisks:10},{date:new Date,totalRisks:18,riskScore:24,mitigatedRisks:12}],topRisks:[{id:"risk-1",title:"Weather delays",probability:.7,impact:.8,riskScore:.56,status:"open",category:"Schedule"},{id:"risk-2",title:"Material price increase",probability:.6,impact:.7,riskScore:.42,status:"mitigated",category:"Cost"}]}}getMockTeamMetrics(){return{totalMembers:45,activeMembers:42,utilizationRate:89,overtimeHours:240,absenteeismRate:3.2,turnoverRate:8.5,trainingHours:180,performanceScore:87,teamSatisfaction:4.2,skillsGapAnalysis:[{skill:"Advanced Welding",required:8,current:6,gap:2},{skill:"Project Management",required:5,current:3,gap:2},{skill:"Safety Training",required:45,current:42,gap:3}]}}getMockDashboardWidgets(){return[{id:"budget-overview",type:"chart",title:"Budget Performance",data:{planned:185e4,actual:175e4,forecast:245e4},config:{chartType:"bar",showTrend:!0,size:"medium"}},{id:"schedule-progress",type:"gauge",title:"Schedule Progress",data:{value:67,target:70},config:{thresholds:{warning:60,critical:50},size:"small"}},{id:"quality-score",type:"metric",title:"Quality Score",data:{value:94,trend:2,previous:92},config:{showTrend:!0,size:"small"}}]}},ua=({projectId:e,userId:t})=>{const[s,r]=a.useState(!0),[i,n]=a.useState("overview"),[l,o]=a.useState({start:new Date(Date.now()-2592e6),end:new Date}),[c,m]=a.useState({budget:null,schedule:null,quality:null,safety:null,productivity:null,risks:null,team:null}),[u,x]=a.useState([]);a.useEffect(()=>{h()},[e,l]);const h=async()=>{r(!0);try{const[t,s,a,r,i,n,l,o]=await Promise.all([ma.getBudgetAnalysis(e),ma.getScheduleAnalysis(e),ma.getQualityMetrics(e),ma.getSafetyMetrics(e),ma.getProductivityMetrics(e),ma.getRiskAnalysis(e),ma.getTeamMetrics(e),ma.getDashboardWidgets(e)]);m({budget:t,schedule:s,quality:a,safety:r,productivity:i,risks:n,team:l}),x(o)}catch(t){console.error("Error loading analytics data:",t)}finally{r(!1)}},p=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),g=e=>`${e.toFixed(1)}%`,y=(e,t)=>e>=t.good?"text-green-600":e>=t.warning?"text-yellow-600":"text-red-600",b=[{id:"overview",label:"Overview",icon:ct},{id:"budget",label:"Budget",icon:jt},{id:"schedule",label:"Schedule",icon:pt},{id:"quality",label:"Quality",icon:os},{id:"safety",label:"Safety",icon:Zt},{id:"productivity",label:"Productivity",icon:st},{id:"risks",label:"Risks",icon:hs},{id:"team",label:"Team",icon:vs}];return s?d.jsxs("div",{className:"flex items-center justify-center h-64",children:[d.jsx(Bt,{className:"w-8 h-8 animate-spin text-blue-600"}),d.jsx("span",{className:"ml-2 text-gray-600",children:"Loading analytics..."})]}):d.jsxs("div",{className:"bg-white rounded-lg shadow-lg",children:[d.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Project Analytics"}),d.jsx("p",{className:"text-gray-600",children:"Real-time insights and performance metrics"})]}),d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("label",{className:"text-sm text-gray-600",children:"From:"}),d.jsx("input",{type:"date",value:l.start.toISOString().split("T")[0],onChange:e=>o({...l,start:new Date(e.target.value)}),className:"px-2 py-1 border border-gray-300 rounded text-sm"}),d.jsx("label",{className:"text-sm text-gray-600",children:"To:"}),d.jsx("input",{type:"date",value:l.end.toISOString().split("T")[0],onChange:e=>o({...l,end:new Date(e.target.value)}),className:"px-2 py-1 border border-gray-300 rounded text-sm"})]}),d.jsxs("button",{onClick:h,className:"flex items-center px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[d.jsx(Bt,{className:"w-4 h-4 mr-2"}),"Refresh"]}),d.jsxs("button",{className:"flex items-center px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(ft,{className:"w-4 h-4 mr-2"}),"Export"]})]})]})}),d.jsx("div",{className:"border-b border-gray-200",children:d.jsx("nav",{className:"flex space-x-8 px-6",children:b.map(e=>{const t=e.icon;return d.jsxs("button",{onClick:()=>n(e.id),className:"flex items-center py-4 px-1 border-b-2 font-medium text-sm "+(i===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[d.jsx(t,{className:"w-4 h-4 mr-2"}),e.label]},e.id)})})}),d.jsxs("div",{className:"p-6",children:["overview"===i&&d.jsx(xa,{metrics:c,formatCurrency:p,formatPercentage:g,getHealthColor:y}),"budget"===i&&c.budget&&d.jsx(ha,{budget:c.budget,formatCurrency:p,getHealthColor:y}),"schedule"===i&&c.schedule&&d.jsx(pa,{schedule:c.schedule,formatPercentage:g,getHealthColor:y}),"quality"===i&&c.quality&&d.jsx(ga,{quality:c.quality,formatPercentage:g,getHealthColor:y}),"safety"===i&&c.safety&&d.jsx(ya,{safety:c.safety,formatPercentage:g,getHealthColor:y}),"productivity"===i&&c.productivity&&d.jsx(ba,{productivity:c.productivity,formatPercentage:g,getHealthColor:y}),"risks"===i&&c.risks&&d.jsx(ja,{risks:c.risks,getHealthColor:y}),"team"===i&&c.team&&d.jsx(fa,{team:c.team,formatPercentage:g,getHealthColor:y})]})]})},xa=({metrics:e,formatCurrency:t,formatPercentage:s,getHealthColor:a})=>{const r=[{title:"Budget Performance",value:e.budget?s(e.budget.earnedValue/e.budget.actualCost*100):"N/A",trend:e.budget?e.budget.costPerformanceIndex>1?"up":"down":"neutral",color:e.budget?a(100*e.budget.costPerformanceIndex,{good:100,warning:95}):"text-gray-600",icon:jt,subtitle:e.budget?`CPI: ${e.budget.costPerformanceIndex.toFixed(2)}`:""},{title:"Schedule Progress",value:e.schedule?s(e.schedule.percentComplete):"N/A",trend:e.schedule?e.schedule.schedulePerformanceIndex>1?"up":"down":"neutral",color:e.schedule?a(100*e.schedule.schedulePerformanceIndex,{good:100,warning:95}):"text-gray-600",icon:pt,subtitle:e.schedule?`SPI: ${e.schedule.schedulePerformanceIndex.toFixed(2)}`:""},{title:"Quality Score",value:e.quality?`${e.quality.qualityScore}/100`:"N/A",trend:"up",color:e.quality?a(e.quality.qualityScore,{good:90,warning:80}):"text-gray-600",icon:os,subtitle:e.quality?`${s(e.quality.inspectionsPassed/e.quality.inspectionsTotal*100)} pass rate`:""},{title:"Safety Score",value:e.safety?`${e.safety.safetyScore}/100`:"N/A",trend:"up",color:e.safety?a(e.safety.safetyScore,{good:95,warning:90}):"text-gray-600",icon:Zt,subtitle:e.safety?`${e.safety.daysWithoutIncident} days incident-free`:""},{title:"Team Productivity",value:e.productivity?s(e.productivity.laborEfficiency):"N/A",trend:e.productivity?e.productivity.laborEfficiency>100?"up":"down":"neutral",color:e.productivity?a(e.productivity.laborEfficiency,{good:100,warning:95}):"text-gray-600",icon:st,subtitle:e.team?`${e.team.activeMembers}/${e.team.totalMembers} active`:""},{title:"Risk Level",value:e.risks?`${e.risks.riskScore}/100`:"N/A",trend:"down",color:e.risks?a(100-e.risks.riskScore,{good:80,warning:60}):"text-gray-600",icon:hs,subtitle:e.risks?`${e.risks.highRisks} high risks`:""}];return d.jsxs("div",{className:"space-y-6",children:[d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map((e,t)=>{const s=e.icon,a="up"===e.trend?xs:"down"===e.trend?us:st;return d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:d.jsx(s,{className:"w-5 h-5 text-blue-600"})}),d.jsx("h3",{className:"ml-3 text-sm font-medium text-gray-900",children:e.title})]}),d.jsx(a,{className:`w-4 h-4 ${e.color}`})]}),d.jsxs("div",{className:"space-y-1",children:[d.jsx("p",{className:`text-2xl font-bold ${e.color}`,children:e.value}),e.subtitle&&d.jsx("p",{className:"text-sm text-gray-600",children:e.subtitle})]})]},t)})}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Project Health Summary"}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-600",children:"Overall Health"}),d.jsx("span",{className:"text-sm font-medium text-green-600",children:"Good"})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-600",children:"Budget Variance"}),d.jsx("span",{className:"text-sm font-medium text-green-600",children:e.budget?t(e.budget.varianceAtCompletion):"N/A"})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-600",children:"Schedule Variance"}),d.jsx("span",{className:"text-sm font-medium text-red-600",children:e.schedule?`${e.schedule.scheduleVariance} days`:"N/A"})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-600",children:"Open Issues"}),d.jsx("span",{className:"text-sm font-medium text-yellow-600",children:e.quality?e.quality.punchListItems:"N/A"})]})]})]}),d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Activity"}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(ut,{className:"w-4 h-4 text-green-600 mr-3"}),d.jsx("span",{className:"text-sm text-gray-900",children:"Foundation inspection passed"}),d.jsx("span",{className:"text-xs text-gray-500 ml-auto",children:"2 hours ago"})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx(hs,{className:"w-4 h-4 text-yellow-600 mr-3"}),d.jsx("span",{className:"text-sm text-gray-900",children:"Material delivery delayed"}),d.jsx("span",{className:"text-xs text-gray-500 ml-auto",children:"4 hours ago"})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx(ut,{className:"w-4 h-4 text-green-600 mr-3"}),d.jsx("span",{className:"text-sm text-gray-900",children:"Safety training completed"}),d.jsx("span",{className:"text-xs text-gray-500 ml-auto",children:"1 day ago"})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx(st,{className:"w-4 h-4 text-blue-600 mr-3"}),d.jsx("span",{className:"text-sm text-gray-900",children:"Weekly progress report generated"}),d.jsx("span",{className:"text-xs text-gray-500 ml-auto",children:"2 days ago"})]})]})]})]})]})},ha=({budget:e})=>d.jsxs("div",{className:"text-center py-8",children:[d.jsx(jt,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Budget Analytics"}),d.jsx("p",{className:"text-gray-600",children:"Detailed budget analysis will be implemented next"}),d.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Total Budget: ",e?`$${e.totalBudget.toLocaleString()}`:"N/A"]})]}),pa=({schedule:e})=>d.jsxs("div",{className:"text-center py-8",children:[d.jsx(pt,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Schedule Analytics"}),d.jsx("p",{className:"text-gray-600",children:"Detailed schedule analysis will be implemented next"}),d.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Progress: ",e?`${e.percentComplete}%`:"N/A"]})]}),ga=({quality:e})=>d.jsxs("div",{className:"text-center py-8",children:[d.jsx(os,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Quality Analytics"}),d.jsx("p",{className:"text-gray-600",children:"Detailed quality analysis will be implemented next"}),d.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Quality Score: ",e?`${e.qualityScore}/100`:"N/A"]})]}),ya=({safety:e})=>d.jsxs("div",{className:"text-center py-8",children:[d.jsx(Zt,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Safety Analytics"}),d.jsx("p",{className:"text-gray-600",children:"Detailed safety analysis will be implemented next"}),d.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Safety Score: ",e?`${e.safetyScore}/100`:"N/A"]})]}),ba=({productivity:e})=>d.jsxs("div",{className:"text-center py-8",children:[d.jsx(st,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Productivity Analytics"}),d.jsx("p",{className:"text-gray-600",children:"Detailed productivity analysis will be implemented next"}),d.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Efficiency: ",e?`${e.laborEfficiency}%`:"N/A"]})]}),ja=({risks:e})=>d.jsxs("div",{className:"text-center py-8",children:[d.jsx(hs,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Risk Analytics"}),d.jsx("p",{className:"text-gray-600",children:"Detailed risk analysis will be implemented next"}),d.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Total Risks: ",e?e.totalRisks:"N/A"]})]}),fa=({team:e})=>d.jsxs("div",{className:"text-center py-8",children:[d.jsx(vs,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Team Analytics"}),d.jsx("p",{className:"text-gray-600",children:"Detailed team analysis will be implemented next"}),d.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Team Members: ",e?`${e.activeMembers}/${e.totalMembers}`:"N/A"]})]}),va=({projectId:e,userId:t})=>{const[s,r]=a.useState("dashboard"),[i,n]=a.useState(!0),[l,o]=a.useState([]),[c,m]=a.useState(null),[u,x]=a.useState(!1),[h,p]=a.useState({start:new Date(Date.now()-2592e6),end:new Date}),[g,y]=a.useState(null);a.useEffect(()=>{b()},[e,h]);const b=async()=>{n(!0);try{const[t,s,a,r,i]=await Promise.all([ma.getBudgetAnalysis(e),ma.getScheduleAnalysis(e),ma.getQualityMetrics(e),ma.getSafetyMetrics(e),ma.getProductivityMetrics(e)]),n={labels:["Planned","Actual","Forecast"],datasets:[{label:"Budget ($)",data:[t.plannedValue,t.actualCost,t.forecastAtCompletion],backgroundColor:["#3B82F6","#EF4444","#F59E0B"],borderWidth:1}]},l={labels:["Completed","In Progress","Not Started","Overdue"],datasets:[{label:"Tasks",data:[s.tasksCompleted,s.tasksInProgress,s.tasksTotal-s.tasksCompleted-s.tasksInProgress,s.tasksOverdue],backgroundColor:["#10B981","#3B82F6","#6B7280","#EF4444"]}]},c={labels:["Passed","Failed"],datasets:[{label:"Inspections",data:[a.inspectionsPassed,a.inspectionsFailed],backgroundColor:["#10B981","#EF4444"]}]},d={labels:["Safety Score","PPE Compliance","Training Completion"],datasets:[{label:"Safety Metrics (%)",data:[r.safetyScore,r.ppeComplianceRate,85],backgroundColor:["#10B981","#3B82F6","#F59E0B"]}]},m={labels:["Week 1","Week 2","Week 3","Week 4"],datasets:[{label:"Labor Efficiency (%)",data:[98,102,105,i.laborEfficiency],borderColor:"#3B82F6",backgroundColor:"rgba(59, 130, 246, 0.1)",borderWidth:2}]};y({budgetChart:n,scheduleChart:l,qualityChart:c,safetyChart:d,productivityChart:m,summaryMetrics:{totalBudget:t.totalBudget,budgetVariance:t.varianceAtCompletion,scheduleProgress:s.percentComplete,qualityScore:a.qualityScore,safetyScore:r.safetyScore,productivity:i.laborEfficiency}}),o(j())}catch(t){console.error("Error loading reporting data:",t)}finally{n(!1)}},j=()=>[{id:"report-1",name:"Weekly Progress Report",description:"Comprehensive weekly project progress summary",type:"custom",chartType:"bar",dateRange:{start:new Date(Date.now()-6048e5),end:new Date},filters:{},data:{},createdBy:t,createdAt:new Date(Date.now()-6048e5),lastRun:new Date,isScheduled:!0,scheduleFrequency:"weekly"},{id:"report-2",name:"Budget Variance Analysis",description:"Detailed budget performance and variance analysis",type:"budget",chartType:"line",dateRange:{start:new Date(Date.now()-2592e6),end:new Date},filters:{},data:{},createdBy:t,createdAt:new Date(Date.now()-12096e5),lastRun:new Date(Date.now()-864e5),isScheduled:!1},{id:"report-3",name:"Safety Performance Dashboard",description:"Safety metrics and incident tracking report",type:"safety",chartType:"pie",dateRange:{start:new Date(Date.now()-2592e6),end:new Date},filters:{},data:{},createdBy:t,createdAt:new Date(Date.now()-18144e5),lastRun:new Date(Date.now()-1728e5),isScheduled:!0,scheduleFrequency:"monthly"}],f=e=>{const t=c||{name:"Dashboard Report"};console.log(`Exporting ${t.name} as ${e.toUpperCase()}`);const s=document.createElement("a"),a=new Blob([`Mock ${e.toUpperCase()} export data for ${t.name}`],{type:"text/plain"});s.href=URL.createObjectURL(a),s.download=`${t.name.replace(/\s+/g,"_")}.${e}`,document.body.appendChild(s),s.click(),document.body.removeChild(s)},v=[{id:"dashboard",label:"Dashboard",icon:ct},{id:"reports",label:"Reports",icon:wt},{id:"custom",label:"Custom Reports",icon:Xt},{id:"scheduled",label:"Scheduled",icon:lt}];return i?d.jsxs("div",{className:"flex items-center justify-center h-64",children:[d.jsx(Bt,{className:"w-8 h-8 animate-spin text-blue-600"}),d.jsx("span",{className:"ml-2 text-gray-600",children:"Loading reports..."})]}):d.jsxs("div",{className:"bg-white rounded-lg shadow-lg",children:[d.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Advanced Reporting"}),d.jsx("p",{className:"text-gray-600",children:"Comprehensive analytics and custom reports"})]}),d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("label",{className:"text-sm text-gray-600",children:"From:"}),d.jsx("input",{type:"date",value:h.start.toISOString().split("T")[0],onChange:e=>p({...h,start:new Date(e.target.value)}),className:"px-2 py-1 border border-gray-300 rounded text-sm"}),d.jsx("label",{className:"text-sm text-gray-600",children:"To:"}),d.jsx("input",{type:"date",value:h.end.toISOString().split("T")[0],onChange:e=>p({...h,end:new Date(e.target.value)}),className:"px-2 py-1 border border-gray-300 rounded text-sm"})]}),d.jsxs("button",{onClick:()=>x(!0),className:"flex items-center px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-4 h-4 mr-2"}),"New Report"]}),d.jsxs("div",{className:"relative",children:[d.jsxs("button",{className:"flex items-center px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[d.jsx(ft,{className:"w-4 h-4 mr-2"}),"Export"]}),d.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-lg z-10 hidden group-hover:block",children:[d.jsx("button",{onClick:()=>f("pdf"),className:"w-full text-left px-4 py-2 hover:bg-gray-50",children:"Export as PDF"}),d.jsx("button",{onClick:()=>f("excel"),className:"w-full text-left px-4 py-2 hover:bg-gray-50",children:"Export as Excel"}),d.jsx("button",{onClick:()=>f("csv"),className:"w-full text-left px-4 py-2 hover:bg-gray-50",children:"Export as CSV"})]})]})]})]})}),d.jsx("div",{className:"border-b border-gray-200",children:d.jsx("nav",{className:"flex space-x-8 px-6",children:v.map(e=>{const t=e.icon;return d.jsxs("button",{onClick:()=>r(e.id),className:"flex items-center py-4 px-1 border-b-2 font-medium text-sm "+(s===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[d.jsx(t,{className:"w-4 h-4 mr-2"}),e.label]},e.id)})})}),d.jsxs("div",{className:"p-6",children:["dashboard"===s&&g&&d.jsx(Na,{data:g,onExport:f}),"reports"===s&&d.jsx(Sa,{reports:l,onSelectReport:m,onExport:f}),"custom"===s&&d.jsx(Ca,{onCreateReport:()=>x(!0)}),"scheduled"===s&&d.jsx(Ea,{reports:l.filter(e=>e.isScheduled)})]}),u&&d.jsx(Da,{projectId:e,onClose:()=>x(!1),onSuccess:e=>{o([...l,e]),x(!1)}})]})},Na=({data:e,onExport:t})=>d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[d.jsx(wa,{title:"Total Budget",value:`$${e.summaryMetrics.totalBudget.toLocaleString()}`,change:e.summaryMetrics.budgetVariance,icon:jt,color:"blue"}),d.jsx(wa,{title:"Schedule Progress",value:`${e.summaryMetrics.scheduleProgress}%`,change:2.5,icon:pt,color:"green"}),d.jsx(wa,{title:"Quality Score",value:`${e.summaryMetrics.qualityScore}/100`,change:1.2,icon:os,color:"purple"})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.jsx(ka,{title:"Budget Performance",chartType:"bar",data:e.budgetChart}),d.jsx(ka,{title:"Schedule Status",chartType:"pie",data:e.scheduleChart}),d.jsx(ka,{title:"Quality Metrics",chartType:"pie",data:e.qualityChart}),d.jsx(ka,{title:"Productivity Trend",chartType:"line",data:e.productivityChart})]})]}),wa=({title:e,value:t,change:s,icon:a,color:r})=>d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("div",{className:`p-2 rounded-lg ${{blue:"bg-blue-100 text-blue-600",green:"bg-green-100 text-green-600",purple:"bg-purple-100 text-purple-600",red:"bg-red-100 text-red-600"}[r]}`,children:d.jsx(a,{className:"w-5 h-5"})}),d.jsxs("div",{className:"flex items-center text-sm "+(s>=0?"text-green-600":"text-red-600"),children:[s>=0?d.jsx(xs,{className:"w-4 h-4 mr-1"}):d.jsx(xs,{className:"w-4 h-4 mr-1 rotate-180"}),Math.abs(s),"%"]})]}),d.jsxs("div",{className:"mt-4",children:[d.jsx("h3",{className:"text-sm font-medium text-gray-600",children:e}),d.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:t})]})]}),ka=({title:e,chartType:t,data:s})=>d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:e}),d.jsx("div",{className:"h-64 flex items-center justify-center bg-gray-50 rounded-lg",children:d.jsxs("div",{className:"text-center",children:["bar"===t&&d.jsx(ct,{className:"w-16 h-16 text-gray-400 mx-auto mb-2"}),"line"===t&&d.jsx(dt,{className:"w-16 h-16 text-gray-400 mx-auto mb-2"}),"pie"===t&&d.jsx(mt,{className:"w-16 h-16 text-gray-400 mx-auto mb-2"}),d.jsxs("p",{className:"text-gray-600",children:[e," Chart"]}),d.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[s.datasets[0]?.data.length||0," data points"]})]})})]}),Sa=({reports:e,onSelectReport:t,onExport:s})=>d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Saved Reports"}),d.jsxs("button",{className:"flex items-center px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[d.jsx(Ct,{className:"w-4 h-4 mr-2"}),"Filter"]})]}),d.jsx("div",{className:"grid gap-4",children:e.map(e=>d.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex-1",children:[d.jsx("h4",{className:"text-lg font-medium text-gray-900",children:e.name}),d.jsx("p",{className:"text-gray-600 mt-1",children:e.description}),d.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-sm text-gray-500",children:[d.jsxs("span",{children:["Type: ",e.type]}),d.jsxs("span",{children:["Chart: ",e.chartType]}),d.jsxs("span",{children:["Last run: ",e.lastRun.toLocaleDateString()]}),e.isScheduled&&d.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs",children:[d.jsx(lt,{className:"w-3 h-3 mr-1"}),e.scheduleFrequency]})]})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{onClick:()=>t(e),className:"p-2 text-blue-600 hover:text-blue-800",title:"View Report",children:d.jsx(Nt,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-2 text-gray-600 hover:text-gray-800",title:"Edit Report",children:d.jsx(rs,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-2 text-green-600 hover:text-green-800",title:"Share Report",children:d.jsx(Kt,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-2 text-red-600 hover:text-red-800",title:"Delete Report",children:d.jsx(ms,{className:"w-4 h-4"})})]})]})},e.id))})]}),Ca=({onCreateReport:e})=>d.jsxs("div",{className:"text-center py-12",children:[d.jsx(wt,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Custom Report Builder"}),d.jsx("p",{className:"text-gray-600 mb-6",children:"Create custom reports with your own metrics and visualizations"}),d.jsxs("button",{onClick:e,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-4 h-4 mr-2"}),"Create Custom Report"]})]}),Ea=({reports:e})=>d.jsxs("div",{className:"space-y-4",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Scheduled Reports"}),0===e.length?d.jsxs("div",{className:"text-center py-12",children:[d.jsx(lt,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Scheduled Reports"}),d.jsx("p",{className:"text-gray-600",children:"Set up automatic report generation and delivery"})]}):d.jsx("div",{className:"grid gap-4",children:e.map(e=>d.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"font-medium text-gray-900",children:e.name}),d.jsxs("p",{className:"text-sm text-gray-600",children:["Runs ",e.scheduleFrequency,"  Last run: ",e.lastRun.toLocaleDateString()]})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:"inline-flex items-center px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs",children:"Active"}),d.jsx("button",{className:"p-1 text-gray-600 hover:text-gray-800",children:d.jsx(Xt,{className:"w-4 h-4"})})]})]})},e.id))})]}),Da=({projectId:e,onClose:t,onSuccess:s})=>{const[r,i]=a.useState({name:"",description:"",type:"custom",chartType:"bar",isScheduled:!1,scheduleFrequency:"weekly"});return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create New Report"})}),d.jsxs("form",{onSubmit:e=>{e.preventDefault();const t={id:`report-${Date.now()}`,...r,dateRange:{start:new Date(Date.now()-2592e6),end:new Date},filters:{},data:{},createdBy:"current-user",createdAt:new Date,lastRun:new Date,scheduleFrequency:r.isScheduled?r.scheduleFrequency:void 0};s(t)},className:"p-6 space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Report Name *"}),d.jsx("input",{type:"text",required:!0,value:r.name,onChange:e=>i({...r,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter report name"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),d.jsx("textarea",{value:r.description,onChange:e=>i({...r,description:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Describe what this report shows"})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Report Type"}),d.jsxs("select",{value:r.type,onChange:e=>i({...r,type:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"budget",children:"Budget"}),d.jsx("option",{value:"schedule",children:"Schedule"}),d.jsx("option",{value:"quality",children:"Quality"}),d.jsx("option",{value:"safety",children:"Safety"}),d.jsx("option",{value:"productivity",children:"Productivity"}),d.jsx("option",{value:"custom",children:"Custom"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Chart Type"}),d.jsxs("select",{value:r.chartType,onChange:e=>i({...r,chartType:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"bar",children:"Bar Chart"}),d.jsx("option",{value:"line",children:"Line Chart"}),d.jsx("option",{value:"pie",children:"Pie Chart"}),d.jsx("option",{value:"area",children:"Area Chart"}),d.jsx("option",{value:"table",children:"Table"})]})]})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",id:"isScheduled",checked:r.isScheduled,onChange:e=>i({...r,isScheduled:e.target.checked}),className:"rounded border-gray-300"}),d.jsx("label",{htmlFor:"isScheduled",className:"ml-2 text-sm text-gray-700",children:"Schedule automatic generation"})]}),r.isScheduled&&d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Frequency"}),d.jsxs("select",{value:r.scheduleFrequency,onChange:e=>i({...r,scheduleFrequency:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"daily",children:"Daily"}),d.jsx("option",{value:"weekly",children:"Weekly"}),d.jsx("option",{value:"monthly",children:"Monthly"})]})]}),d.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[d.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),d.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Create Report"})]})]})]})})},Aa=({projectId:e,userId:t})=>{const[s,r]=a.useState("chat"),[i,n]=a.useState(null),[l,o]=a.useState([]),[c,m]=a.useState([]),[u,x]=a.useState([]),[h,p]=a.useState([]),[g,y]=a.useState(""),[b,j]=a.useState(!1),[f,v]=a.useState(!1),[N,w]=a.useState(""),[k,S]=a.useState([]),C=a.useRef(null),E=a.useRef(null);a.useEffect(()=>{D();const e=setInterval(()=>{A()},5e3);return()=>clearInterval(e)},[e]),a.useEffect(()=>{I()},[l]);const D=async()=>{try{m(M()),x(P()),p(L()),S(["user-1","user-2","user-3"]);const e=M()[0];n(e),o(R(e.id))}catch(e){console.error("Error loading collaboration data:",e)}},A=()=>{const e=["Great progress on the foundation work!","Can someone review the latest drawings?","Safety meeting at 2 PM today","Material delivery scheduled for tomorrow","Quality inspection passed "];if(Math.random()>.7&&i){const t={id:`msg-${Date.now()}`,content:e[Math.floor(Math.random()*e.length)],senderId:"user-"+Math.floor(5*Math.random()),senderName:["John Smith","Sarah Johnson","Mike Wilson","Lisa Chen","David Brown"][Math.floor(5*Math.random())],timestamp:new Date,type:"text"};o(e=>[...e,t])}},I=()=>{C.current?.scrollIntoView({behavior:"smooth"})},T=()=>{if(!g.trim()||!i)return;const e={id:`msg-${Date.now()}`,content:g,senderId:t,senderName:"You",timestamp:new Date,type:"text"};o(t=>[...t,e]),y("")},M=()=>[{id:"general",name:"General",description:"General project discussion",type:"public",members:["user-1","user-2","user-3","user-4"],isArchived:!1,unreadCount:3,isPinned:!0,createdAt:new Date(Date.now()-2592e6)},{id:"field-updates",name:"Field Updates",description:"Daily field reports and updates",type:"public",members:["user-1","user-2","user-5"],isArchived:!1,unreadCount:1,isPinned:!1,createdAt:new Date(Date.now()-1728e6)},{id:"safety",name:"Safety",description:"Safety discussions and alerts",type:"public",members:["user-1","user-3","user-4","user-5"],isArchived:!1,unreadCount:0,isPinned:!0,createdAt:new Date(Date.now()-1296e6)},{id:"management",name:"Management",description:"Project management team",type:"private",members:["user-1","user-2"],isArchived:!1,unreadCount:2,isPinned:!1,createdAt:new Date(Date.now()-864e6)}],R=e=>[{id:"msg-1",content:"Good morning team! Ready for another productive day.",senderId:"user-1",senderName:"John Smith",timestamp:new Date(Date.now()-72e5),type:"text"},{id:"msg-2",content:"Foundation work is progressing well. Should be done by Friday.",senderId:"user-2",senderName:"Sarah Johnson",timestamp:new Date(Date.now()-36e5),type:"text"},{id:"msg-3",content:"Great to hear! Can you share some photos of the progress?",senderId:"user-3",senderName:"Mike Wilson",timestamp:new Date(Date.now()-18e5),type:"text"},{id:"msg-4",content:"Here are the latest photos from the site.",senderId:"user-2",senderName:"Sarah Johnson",timestamp:new Date(Date.now()-9e5),type:"image",attachments:[{id:"att-1",name:"foundation-progress.jpg",type:"image/jpeg",size:2048576,url:"/mock-images/foundation.jpg",thumbnailUrl:"/mock-images/foundation-thumb.jpg"}]}],P=()=>[{id:"notif-1",type:"mention",title:"You were mentioned",message:"John Smith mentioned you in #general",timestamp:new Date(Date.now()-18e5),isRead:!1,priority:"medium",relatedUser:"John Smith"},{id:"notif-2",type:"task",title:"Task assigned",message:"New task: Review electrical plans",timestamp:new Date(Date.now()-72e5),isRead:!1,priority:"high"},{id:"notif-3",type:"document",title:"Document updated",message:"Architectural drawings v2.1 uploaded",timestamp:new Date(Date.now()-144e5),isRead:!0,priority:"low"}],L=()=>[{id:"activity-1",type:"document",title:"Document uploaded",description:"Sarah uploaded foundation drawings v2.1",user:"Sarah Johnson",timestamp:new Date(Date.now()-36e5)},{id:"activity-2",type:"task",title:"Task completed",description:"Mike completed electrical rough-in inspection",user:"Mike Wilson",timestamp:new Date(Date.now()-72e5)},{id:"activity-3",type:"meeting",title:"Meeting scheduled",description:"Weekly progress meeting scheduled for Friday 2 PM",user:"John Smith",timestamp:new Date(Date.now()-108e5)}],_=[{id:"chat",label:"Chat",icon:_t},{id:"activity",label:"Activity",icon:pt},{id:"team",label:"Team",icon:vs},{id:"calls",label:"Calls",icon:$t}],O=u.filter(e=>!e.isRead).length;return d.jsxs("div",{className:"bg-white rounded-lg shadow-lg h-[calc(100vh-8rem)]",children:[d.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Team Collaboration"}),d.jsx("p",{className:"text-gray-600",children:"Real-time communication and project updates"})]}),d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:"text",placeholder:"Search messages...",value:N,onChange:e=>w(e.target.value),className:"pl-8 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-64"}),d.jsx(Jt,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"})]}),d.jsxs("div",{className:"relative",children:[d.jsxs("button",{onClick:()=>v(!f),className:"relative p-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[d.jsx(it,{className:"w-5 h-5"}),O>0&&d.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:O})]}),f&&d.jsx(Ma,{notifications:u,onMarkAsRead:e=>{x(t=>t.map(t=>t.id===e?{...t,isRead:!0}:t))},onClose:()=>v(!1)})]}),d.jsx("button",{className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:d.jsx(Xt,{className:"w-5 h-5"})})]})]})}),d.jsx("div",{className:"border-b border-gray-200",children:d.jsx("nav",{className:"flex space-x-8 px-6",children:_.map(e=>{const t=e.icon;return d.jsxs("button",{onClick:()=>r(e.id),className:"flex items-center py-4 px-1 border-b-2 font-medium text-sm "+(s===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[d.jsx(t,{className:"w-4 h-4 mr-2"}),e.label]},e.id)})})}),d.jsxs("div",{className:"flex h-[calc(100%-8rem)]",children:["chat"===s&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"w-80 border-r border-gray-200 flex flex-col",children:[d.jsx("div",{className:"p-4 border-b border-gray-200",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h3",{className:"font-semibold text-gray-900",children:"Channels"}),d.jsx("button",{className:"p-1 hover:bg-gray-100 rounded",children:d.jsx(zt,{className:"w-4 h-4"})})]})}),d.jsx("div",{className:"flex-1 overflow-y-auto",children:c.map(e=>d.jsx(Ia,{channel:e,isSelected:i?.id===e.id,onClick:()=>{n(e),o(R(e.id))}},e.id))})]}),d.jsx("div",{className:"flex-1 flex flex-col",children:i?d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"p-4 border-b border-gray-200",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsxs("h3",{className:"font-semibold text-gray-900",children:["#",i.name]}),d.jsx("p",{className:"text-sm text-gray-600",children:i.description})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{className:"p-2 hover:bg-gray-100 rounded",children:d.jsx($t,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-2 hover:bg-gray-100 rounded",children:d.jsx(Ns,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-2 hover:bg-gray-100 rounded",children:d.jsx(vt,{className:"w-4 h-4"})})]})]})}),d.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[l.map(e=>d.jsx(Ta,{message:e,currentUserId:t},e.id)),d.jsx("div",{ref:C})]}),d.jsx("div",{className:"p-4 border-t border-gray-200",children:d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{onClick:()=>E.current?.click(),className:"p-2 hover:bg-gray-100 rounded",children:d.jsx(qt,{className:"w-4 h-4"})}),d.jsx("input",{type:"file",ref:E,multiple:!0,className:"hidden",onChange:e=>{const s=e.target.files;s&&i&&Array.from(s).forEach(e=>{const s={id:`msg-${Date.now()}-${e.name}`,content:`Shared a file: ${e.name}`,senderId:t,senderName:"You",timestamp:new Date,type:"file",attachments:[{id:`att-${Date.now()}`,name:e.name,type:e.type,size:e.size,url:URL.createObjectURL(e)}]};o(e=>[...e,s])})}}),d.jsxs("div",{className:"flex-1 relative",children:[d.jsx("input",{type:"text",value:g,onChange:e=>y(e.target.value),onKeyPress:e=>"Enter"===e.key&&T(),placeholder:`Message #${i.name}`,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"}),d.jsx("button",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 p-1 hover:bg-gray-100 rounded",children:d.jsx(ss,{className:"w-4 h-4"})})]}),d.jsx("button",{onClick:T,disabled:!g.trim(),className:"p-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:d.jsx(Yt,{className:"w-4 h-4"})})]})})]}):d.jsx("div",{className:"flex-1 flex items-center justify-center",children:d.jsxs("div",{className:"text-center",children:[d.jsx(_t,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Select a channel"}),d.jsx("p",{className:"text-gray-600",children:"Choose a channel to start messaging"})]})})})]}),"activity"===s&&d.jsx("div",{className:"flex-1 p-6",children:d.jsx(Ra,{activities:h})}),"team"===s&&d.jsx("div",{className:"flex-1 p-6",children:d.jsx(Pa,{onlineUsers:k})}),"calls"===s&&d.jsx("div",{className:"flex-1 p-6",children:d.jsx(La,{})})]})]})},Ia=({channel:e,isSelected:t,onClick:s})=>d.jsxs("button",{onClick:s,className:"w-full text-left p-3 hover:bg-gray-50 "+(t?"bg-blue-50 border-r-2 border-blue-500":""),children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center",children:["private"===e.type?d.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full mr-2"}):d.jsx(Tt,{className:"w-4 h-4 text-gray-400 mr-2"}),d.jsx("span",{className:"font-medium text-gray-900",children:e.name}),e.isPinned&&d.jsx(Vt,{className:"w-3 h-3 text-gray-400 ml-1"})]}),e.unreadCount>0&&d.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full px-2 py-1 min-w-[1.25rem] text-center",children:e.unreadCount})]}),d.jsx("p",{className:"text-sm text-gray-600 truncate mt-1",children:e.description})]}),Ta=({message:e,currentUserId:t})=>{const s=e.senderId===t;return d.jsx("div",{className:"flex "+(s?"justify-end":"justify-start"),children:d.jsxs("div",{className:"max-w-xs lg:max-w-md "+(s?"order-2":"order-1"),children:[!s&&d.jsxs("div",{className:"flex items-center mb-1",children:[d.jsx("div",{className:"w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-medium mr-2",children:e.senderName.charAt(0)}),d.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.senderName}),d.jsx("span",{className:"text-xs text-gray-500 ml-2",children:e.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),d.jsxs("div",{className:"rounded-lg px-4 py-2 "+(s?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"),children:[d.jsx("p",{className:"text-sm",children:e.content}),e.attachments&&e.attachments.length>0&&d.jsx("div",{className:"mt-2 space-y-2",children:e.attachments.map(e=>d.jsxs("div",{className:"flex items-center space-x-2 text-xs",children:[d.jsx(qt,{className:"w-3 h-3"}),d.jsx("span",{children:e.name}),d.jsxs("span",{children:["(",(e.size/1024/1024).toFixed(1)," MB)"]})]},e.id))})]}),s&&d.jsx("div",{className:"text-xs text-gray-500 text-right mt-1",children:e.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})})},Ma=({notifications:e,onMarkAsRead:t,onClose:s})=>d.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:[d.jsx("div",{className:"p-4 border-b border-gray-200",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h3",{className:"font-semibold text-gray-900",children:"Notifications"}),d.jsx("button",{onClick:s,className:"p-1 hover:bg-gray-100 rounded",children:d.jsx(As,{className:"w-4 h-4"})})]})}),d.jsx("div",{className:"max-h-96 overflow-y-auto",children:0===e.length?d.jsxs("div",{className:"p-4 text-center text-gray-500",children:[d.jsx(it,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),d.jsx("p",{children:"No notifications"})]}):e.map(e=>d.jsx("div",{className:"p-4 border-b border-gray-100 hover:bg-gray-50 cursor-pointer "+(e.isRead?"":"bg-blue-50"),onClick:()=>t(e.id),children:d.jsxs("div",{className:"flex items-start space-x-3",children:[d.jsxs("div",{className:"p-1 rounded-full "+("high"===e.priority?"bg-red-100":"medium"===e.priority?"bg-yellow-100":"bg-gray-100"),children:["mention"===e.type&&d.jsx(at,{className:"w-4 h-4 text-blue-600"}),"task"===e.type&&d.jsx(ut,{className:"w-4 h-4 text-green-600"}),"document"===e.type&&d.jsx(FileText,{className:"w-4 h-4 text-purple-600"}),"system"===e.type&&d.jsx(Mt,{className:"w-4 h-4 text-gray-600"})]}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.title}),d.jsx("p",{className:"text-sm text-gray-600 truncate",children:e.message}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),!e.isRead&&d.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full"})]})},e.id))})]}),Ra=({activities:e})=>d.jsxs("div",{className:"space-y-4",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Recent Activity"}),d.jsx("div",{className:"space-y-4",children:e.map(e=>d.jsxs("div",{className:"flex items-start space-x-3 p-4 bg-gray-50 rounded-lg",children:[d.jsxs("div",{className:"p-2 bg-blue-100 rounded-lg",children:["document"===e.type&&d.jsx(FileText,{className:"w-4 h-4 text-blue-600"}),"task"===e.type&&d.jsx(ut,{className:"w-4 h-4 text-green-600"}),"meeting"===e.type&&d.jsx(Calendar,{className:"w-4 h-4 text-purple-600"}),"message"===e.type&&d.jsx(_t,{className:"w-4 h-4 text-orange-600"}),"file"===e.type&&d.jsx(qt,{className:"w-4 h-4 text-gray-600"})]}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.title}),d.jsx("p",{className:"text-sm text-gray-600",children:e.description}),d.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[e.user,"  ",e.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]})]},e.id))})]}),Pa=({onlineUsers:e})=>d.jsxs("div",{className:"space-y-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Team Members"}),d.jsx("div",{className:"space-y-4",children:[{id:"user-1",name:"John Smith",role:"Project Manager",avatar:"JS",status:"online"},{id:"user-2",name:"Sarah Johnson",role:"Site Supervisor",avatar:"SJ",status:"online"},{id:"user-3",name:"Mike Wilson",role:"Safety Officer",avatar:"MW",status:"away"},{id:"user-4",name:"Lisa Chen",role:"Quality Inspector",avatar:"LC",status:"offline"},{id:"user-5",name:"David Brown",role:"Foreman",avatar:"DB",status:"online"}].map(e=>d.jsxs("div",{className:"flex items-center space-x-3 p-3 hover:bg-gray-50 rounded-lg",children:[d.jsxs("div",{className:"relative",children:[d.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-medium",children:e.avatar}),d.jsx("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 rounded-full border-2 border-white "+("online"===e.status?"bg-green-500":"away"===e.status?"bg-yellow-500":"bg-gray-400")})]}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"font-medium text-gray-900",children:e.name}),d.jsx("p",{className:"text-sm text-gray-600",children:e.role})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{className:"p-1 hover:bg-gray-100 rounded",children:d.jsx(_t,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-1 hover:bg-gray-100 rounded",children:d.jsx($t,{className:"w-4 h-4"})})]})]},e.id))})]}),La=()=>d.jsxs("div",{className:"text-center py-12",children:[d.jsx(Ns,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Video Calls"}),d.jsx("p",{className:"text-gray-600 mb-6",children:"Start a video call with your team members"}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("button",{className:"w-full flex items-center justify-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(Ns,{className:"w-4 h-4 mr-2"}),"Start Video Call"]}),d.jsxs("button",{className:"w-full flex items-center justify-center px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[d.jsx($t,{className:"w-4 h-4 mr-2"}),"Start Audio Call"]})]})]}),_a=({projectId:e,userId:t})=>{const[s,r]=a.useState("overview"),[i,n]=a.useState(!0),[l,o]=a.useState([]),[c,m]=a.useState([]),[u,x]=a.useState(null),[h,p]=a.useState(null),[g,y]=a.useState(!1),[b,j]=a.useState(""),[f,v]=a.useState("all"),[N,w]=a.useState("all");a.useEffect(()=>{k()},[e]);const k=async()=>{n(!0);try{const e=S(),t=C(),s=E(e,t);o(e),m(t),x(s)}catch(e){console.error("Error loading quality data:",e)}finally{n(!1)}},S=()=>[{id:"insp-1",title:"Foundation Concrete Pour",description:"Quality inspection of foundation concrete pour",type:"quality",status:"completed",priority:"high",inspector:"user-1",inspectorName:"John Smith",scheduledDate:new Date(Date.now()-1728e5),completedDate:new Date(Date.now()-864e5),location:"Building A - Foundation",trade:"Concrete",score:92,checklist:[{id:"check-1",title:"Concrete Mix Verification",description:"Verify concrete mix meets specifications",category:"Materials",isRequired:!0,status:"passed",inspector:"John Smith",inspectedAt:new Date(Date.now()-864e5)},{id:"check-2",title:"Reinforcement Placement",description:"Check rebar placement and spacing",category:"Structure",isRequired:!0,status:"passed",inspector:"John Smith",inspectedAt:new Date(Date.now()-864e5)},{id:"check-3",title:"Surface Finish",description:"Inspect concrete surface finish quality",category:"Finish",isRequired:!1,status:"failed",notes:"Minor surface imperfections noted",inspector:"John Smith",inspectedAt:new Date(Date.now()-864e5)}],photos:[{id:"photo-1",url:"/mock-photos/foundation-1.jpg",thumbnailUrl:"/mock-photos/foundation-1-thumb.jpg",caption:"Foundation concrete pour in progress",timestamp:new Date(Date.now()-864e5)}],defects:[],notes:"Overall good quality with minor surface finish issues",approvedBy:"Sarah Johnson",approvedAt:new Date(Date.now()-432e5)},{id:"insp-2",title:"Electrical Rough-In",description:"Electrical rough-in inspection before drywall",type:"safety",status:"in_progress",priority:"medium",inspector:"user-2",inspectorName:"Mike Wilson",scheduledDate:new Date,location:"Building A - 2nd Floor",trade:"Electrical",checklist:[{id:"check-4",title:"Wire Gauge Compliance",description:"Verify wire gauge meets code requirements",category:"Code Compliance",isRequired:!0,status:"pending"},{id:"check-5",title:"Junction Box Installation",description:"Check junction box placement and securing",category:"Installation",isRequired:!0,status:"pending"}],photos:[],defects:[]},{id:"insp-3",title:"HVAC Ductwork",description:"HVAC ductwork installation inspection",type:"quality",status:"scheduled",priority:"medium",inspector:"user-3",inspectorName:"Lisa Chen",scheduledDate:new Date(Date.now()+1728e5),location:"Building A - Mechanical Room",trade:"HVAC",checklist:[],photos:[],defects:[]}],C=()=>[{id:"defect-1",title:"Concrete Surface Imperfection",description:"Minor surface imperfections in foundation concrete",severity:"minor",category:"Concrete",location:"Building A - Foundation",discoveredBy:"John Smith",discoveredAt:new Date(Date.now()-864e5),status:"open",assignedTo:"Concrete Crew",dueDate:new Date(Date.now()+2592e5),photos:["/mock-photos/defect-1.jpg"]},{id:"defect-2",title:"Misaligned Window Frame",description:"Window frame not properly aligned with opening",severity:"major",category:"Windows",location:"Building A - 1st Floor",discoveredBy:"Sarah Johnson",discoveredAt:new Date(Date.now()-2592e5),status:"resolved",assignedTo:"Window Installer",dueDate:new Date(Date.now()-864e5),photos:["/mock-photos/defect-2.jpg"],resolutionNotes:"Window frame realigned and secured properly",resolvedBy:"Window Installer",resolvedAt:new Date(Date.now()-864e5)}],E=(e,t)=>{const s=e.length,a=e.filter(e=>"completed"===e.status&&(e.score||0)>=80).length,r=e.filter(e=>"failed"===e.status).length,i=e.filter(e=>["scheduled","in_progress"].includes(e.status)).length,n=e.filter(e=>"completed"===e.status&&e.score),l=n.length>0?n.reduce((e,t)=>e+(t.score||0),0)/n.length:0;return{totalInspections:s,passedInspections:a,failedInspections:r,pendingInspections:i,averageScore:l,defectRate:s>0?t.length/s*100:0,reworkCost:15e3,complianceRate:s>0?a/s*100:0,trendsData:[{date:new Date(Date.now()-2592e6),score:85,defects:5,inspections:8},{date:new Date(Date.now()-1296e6),score:88,defects:3,inspections:12},{date:new Date,score:l,defects:t.length,inspections:s}]}},D=l.filter(e=>{const t=e.title.toLowerCase().includes(b.toLowerCase())||e.location.toLowerCase().includes(b.toLowerCase())||e.trade.toLowerCase().includes(b.toLowerCase()),s="all"===f||e.status===f,a="all"===N||e.type===N;return t&&s&&a}),A=[{id:"overview",label:"Overview",icon:ct},{id:"inspections",label:"Inspections",icon:ht},{id:"defects",label:"Defects",icon:hs},{id:"checklists",label:"Checklists",icon:as},{id:"compliance",label:"Compliance",icon:Zt}];return i?d.jsxs("div",{className:"flex items-center justify-center h-64",children:[d.jsx(Bt,{className:"w-8 h-8 animate-spin text-blue-600"}),d.jsx("span",{className:"ml-2 text-gray-600",children:"Loading quality data..."})]}):d.jsxs("div",{className:"bg-white rounded-lg shadow-lg",children:[d.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Quality Control"}),d.jsx("p",{className:"text-gray-600",children:"Inspection workflows, compliance tracking, and quality metrics"})]}),d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("input",{type:"text",placeholder:"Search inspections...",value:b,onChange:e=>j(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-64"}),d.jsxs("select",{value:f,onChange:e=>v(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"all",children:"All Status"}),d.jsx("option",{value:"scheduled",children:"Scheduled"}),d.jsx("option",{value:"in_progress",children:"In Progress"}),d.jsx("option",{value:"completed",children:"Completed"}),d.jsx("option",{value:"failed",children:"Failed"})]}),d.jsxs("select",{value:N,onChange:e=>w(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"all",children:"All Types"}),d.jsx("option",{value:"quality",children:"Quality"}),d.jsx("option",{value:"safety",children:"Safety"}),d.jsx("option",{value:"compliance",children:"Compliance"}),d.jsx("option",{value:"final",children:"Final"})]})]}),d.jsxs("button",{onClick:()=>y(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-4 h-4 mr-2"}),"New Inspection"]})]})]})}),d.jsx("div",{className:"border-b border-gray-200",children:d.jsx("nav",{className:"flex space-x-8 px-6",children:A.map(e=>{const t=e.icon;return d.jsxs("button",{onClick:()=>r(e.id),className:"flex items-center py-4 px-1 border-b-2 font-medium text-sm "+(s===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[d.jsx(t,{className:"w-4 h-4 mr-2"}),e.label]},e.id)})})}),d.jsxs("div",{className:"p-6",children:["overview"===s&&u&&d.jsx(Oa,{metrics:u,inspections:l,defects:c}),"inspections"===s&&d.jsx(Fa,{inspections:D,onSelectInspection:p,onCreateInspection:()=>y(!0)}),"defects"===s&&d.jsx($a,{defects:c,getStatusColor:e=>{switch(e){case"completed":case"passed":case"resolved":case"closed":return"text-green-600 bg-green-100";case"in_progress":return"text-blue-600 bg-blue-100";case"scheduled":case"pending":return"text-yellow-600 bg-yellow-100";case"failed":case"open":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}}}),"checklists"===s&&d.jsx(Va,{}),"compliance"===s&&d.jsx(za,{metrics:u})]}),g&&d.jsx(Ha,{projectId:e,onClose:()=>y(!1),onSuccess:e=>{o([...l,e]),y(!1)}}),h&&d.jsx(Ba,{inspection:h,onClose:()=>p(null),onUpdate:e=>{o(l.map(t=>t.id===e.id?e:t)),p(null)}})]})},Oa=({metrics:e,inspections:t,defects:s})=>{const a=[{title:"Quality Score",value:`${e.averageScore.toFixed(1)}/100`,change:2.5,icon:os,color:"blue"},{title:"Compliance Rate",value:`${e.complianceRate.toFixed(1)}%`,change:1.8,icon:Zt,color:"green"},{title:"Defect Rate",value:`${e.defectRate.toFixed(1)}%`,change:-.5,icon:hs,color:"red"},{title:"Rework Cost",value:`$${e.reworkCost.toLocaleString()}`,change:-12.3,icon:xs,color:"purple"}];return d.jsxs("div",{className:"space-y-6",children:[d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:a.map((e,t)=>{const s=e.icon;return d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("div",{className:`p-2 rounded-lg bg-${e.color}-100`,children:d.jsx(s,{className:`w-5 h-5 text-${e.color}-600`})}),d.jsxs("div",{className:"flex items-center text-sm "+(e.change>=0?"text-green-600":"text-red-600"),children:[d.jsx(xs,{className:"w-4 h-4 mr-1 "+(e.change<0?"rotate-180":"")}),Math.abs(e.change),"%"]})]}),d.jsxs("div",{className:"mt-4",children:[d.jsx("h3",{className:"text-sm font-medium text-gray-600",children:e.title}),d.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:e.value})]})]},t)})}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Inspection Status"}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-600",children:"Completed"}),d.jsx("span",{className:"text-sm font-medium text-green-600",children:e.passedInspections})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-600",children:"In Progress"}),d.jsx("span",{className:"text-sm font-medium text-blue-600",children:e.pendingInspections})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-600",children:"Failed"}),d.jsx("span",{className:"text-sm font-medium text-red-600",children:e.failedInspections})]})]})]}),d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Inspections"}),d.jsx("div",{className:"space-y-3",children:t.slice(0,5).map(e=>d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.title}),d.jsx("p",{className:"text-xs text-gray-500",children:e.location})]}),d.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${Ua(e.status)}`,children:e.status.replace("_"," ")})]},e.id))})]})]})]})},Ua=e=>{switch(e){case"completed":case"passed":case"resolved":case"closed":return"text-green-600 bg-green-100";case"in_progress":return"text-blue-600 bg-blue-100";case"scheduled":case"pending":return"text-yellow-600 bg-yellow-100";case"failed":case"open":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},Fa=({inspections:e,onSelectInspection:t,onCreateInspection:s})=>0===e.length?d.jsxs("div",{className:"text-center py-12",children:[d.jsx(ht,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No inspections found"}),d.jsx("p",{className:"text-gray-600 mb-4",children:"Create your first inspection to get started"}),d.jsxs("button",{onClick:s,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-4 h-4 mr-2"}),"Create Inspection"]})]}):d.jsx("div",{className:"space-y-4",children:d.jsx("div",{className:"grid gap-4",children:e.map(e=>d.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center mb-2",children:[d.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:e.title}),d.jsx("span",{className:`ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full ${Ua(e.status)}`,children:e.status.replace("_"," ")}),d.jsx(kt,{className:`ml-2 w-4 h-4 ${qa(e.priority)}`})]}),d.jsx("p",{className:"text-gray-600 mb-3",children:e.description}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Inspector:"}),d.jsx("p",{className:"font-medium",children:e.inspectorName})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Location:"}),d.jsx("p",{className:"font-medium",children:e.location})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Trade:"}),d.jsx("p",{className:"font-medium",children:e.trade})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Scheduled:"}),d.jsx("p",{className:"font-medium",children:e.scheduledDate.toLocaleDateString()})]})]}),e.score&&d.jsxs("div",{className:"mt-3",children:[d.jsx("span",{className:"text-sm text-gray-500",children:"Quality Score: "}),d.jsxs("span",{className:"font-medium "+(e.score>=90?"text-green-600":e.score>=70?"text-yellow-600":"text-red-600"),children:[e.score,"/100"]})]})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{onClick:()=>t(e),className:"p-2 text-blue-600 hover:text-blue-800",title:"View Details",children:d.jsx(Nt,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-2 text-gray-600 hover:text-gray-800",title:"Edit",children:d.jsx(rs,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-2 text-green-600 hover:text-green-800",title:"Download Report",children:d.jsx(ft,{className:"w-4 h-4"})})]})]})},e.id))})}),qa=e=>{switch(e){case"critical":return"text-red-600";case"high":return"text-orange-600";case"medium":return"text-yellow-600";case"low":return"text-green-600";default:return"text-gray-600"}},$a=({defects:e,getStatusColor:t})=>d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Quality Defects"}),d.jsxs("button",{className:"flex items-center px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[d.jsx(Ct,{className:"w-4 h-4 mr-2"}),"Filter"]})]}),0===e.length?d.jsxs("div",{className:"text-center py-12",children:[d.jsx(ut,{className:"w-16 h-16 text-green-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No defects found"}),d.jsx("p",{className:"text-gray-600",children:"Great job! No quality defects have been reported."})]}):d.jsx("div",{className:"grid gap-4",children:e.map(e=>d.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center mb-2",children:[d.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:e.title}),d.jsx("span",{className:`ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t(e.status)}`,children:e.status.replace("_"," ")}),d.jsx("span",{className:"ml-2 text-xs font-medium "+("critical"===e.severity?"text-red-600":"major"===e.severity?"text-orange-600":"text-yellow-600"),children:e.severity.toUpperCase()})]}),d.jsx("p",{className:"text-gray-600 mb-3",children:e.description}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Location:"}),d.jsx("p",{className:"font-medium",children:e.location})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Discovered by:"}),d.jsx("p",{className:"font-medium",children:e.discoveredBy})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Assigned to:"}),d.jsx("p",{className:"font-medium",children:e.assignedTo||"Unassigned"})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Due date:"}),d.jsx("p",{className:"font-medium",children:e.dueDate?.toLocaleDateString()||"Not set"})]})]}),e.resolutionNotes&&d.jsxs("div",{className:"mt-3 p-3 bg-green-50 rounded-lg",children:[d.jsx("p",{className:"text-sm font-medium text-green-700",children:"Resolution:"}),d.jsx("p",{className:"text-sm text-green-900",children:e.resolutionNotes})]})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{className:"p-2 text-blue-600 hover:text-blue-800",title:"View Photos",children:d.jsx(ot,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-2 text-gray-600 hover:text-gray-800",title:"Edit",children:d.jsx(rs,{className:"w-4 h-4"})})]})]})},e.id))})]}),Va=()=>d.jsxs("div",{className:"text-center py-12",children:[d.jsx(as,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Inspection Checklists"}),d.jsx("p",{className:"text-gray-600 mb-6",children:"Manage standardized inspection checklists and templates"}),d.jsxs("button",{className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-4 h-4 mr-2"}),"Create Checklist Template"]})]}),za=({metrics:e})=>d.jsxs("div",{className:"text-center py-12",children:[d.jsx(Zt,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Compliance Tracking"}),d.jsx("p",{className:"text-gray-600 mb-4",children:"Monitor compliance with building codes and standards"}),e&&d.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg inline-block",children:[d.jsx("p",{className:"text-sm text-blue-600",children:"Current Compliance Rate"}),d.jsxs("p",{className:"text-2xl font-bold text-blue-900",children:[e.complianceRate.toFixed(1),"%"]})]})]}),Ha=({projectId:e,onClose:t,onSuccess:s})=>{const[r,i]=a.useState({title:"",description:"",type:"quality",priority:"medium",inspector:"",scheduledDate:(new Date).toISOString().split("T")[0],location:"",trade:""});return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl mx-4",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create New Inspection"})}),d.jsxs("form",{onSubmit:e=>{e.preventDefault();const t={id:`insp-${Date.now()}`,...r,status:"scheduled",inspectorName:"Current User",scheduledDate:new Date(r.scheduledDate),checklist:[],photos:[],defects:[]};s(t)},className:"p-6 space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),d.jsx("input",{type:"text",required:!0,value:r.title,onChange:e=>i({...r,title:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Inspection title"})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),d.jsx("textarea",{value:r.description,onChange:e=>i({...r,description:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Detailed description of the inspection"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),d.jsxs("select",{value:r.type,onChange:e=>i({...r,type:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"quality",children:"Quality"}),d.jsx("option",{value:"safety",children:"Safety"}),d.jsx("option",{value:"compliance",children:"Compliance"}),d.jsx("option",{value:"final",children:"Final"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),d.jsxs("select",{value:r.priority,onChange:e=>i({...r,priority:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"low",children:"Low"}),d.jsx("option",{value:"medium",children:"Medium"}),d.jsx("option",{value:"high",children:"High"}),d.jsx("option",{value:"critical",children:"Critical"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),d.jsx("input",{type:"text",value:r.location,onChange:e=>i({...r,location:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Building A - 2nd Floor"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trade"}),d.jsx("input",{type:"text",value:r.trade,onChange:e=>i({...r,trade:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Electrical, Plumbing"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Scheduled Date"}),d.jsx("input",{type:"date",value:r.scheduledDate,onChange:e=>i({...r,scheduledDate:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Inspector"}),d.jsx("input",{type:"text",value:r.inspector,onChange:e=>i({...r,inspector:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Inspector name"})]})]}),d.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[d.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),d.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Create Inspection"})]})]})]})})},Ba=({inspection:e,onClose:t,onUpdate:s})=>d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e.title}),d.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded",children:d.jsx(X,{className:"w-5 h-5"})})]})}),d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Inspection Details"}),d.jsxs("div",{className:"space-y-3 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Status:"}),d.jsx("span",{className:`ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full ${Ua(e.status)}`,children:e.status.replace("_"," ")})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Inspector:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.inspectorName})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Location:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.location})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Trade:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.trade})]}),e.score&&d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Quality Score:"}),d.jsxs("span",{className:"ml-2 font-medium",children:[e.score,"/100"]})]})]})]}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Checklist Progress"}),d.jsx("div",{className:"space-y-2",children:e.checklist.map(e=>d.jsxs("div",{className:"flex items-center space-x-2",children:["passed"===e.status?d.jsx(ut,{className:"w-4 h-4 text-green-600"}):"failed"===e.status?d.jsx(xt,{className:"w-4 h-4 text-red-600"}):d.jsx(pt,{className:"w-4 h-4 text-gray-400"}),d.jsx("span",{className:"text-sm",children:e.title})]},e.id))})]})]}),e.notes&&d.jsxs("div",{className:"mt-6",children:[d.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Notes"}),d.jsx("p",{className:"text-sm text-gray-700 bg-gray-50 p-3 rounded-lg",children:e.notes})]})]}),d.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:d.jsxs("div",{className:"flex justify-end space-x-3",children:[d.jsx("button",{onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Close"}),d.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Edit Inspection"})]})})]})}),Wa=({projectId:e,userId:t})=>{const[s,r]=a.useState("overview"),[i,n]=a.useState(!0),[l,o]=a.useState([]),[c,m]=a.useState([]),[u,x]=a.useState([]),[h,p]=a.useState(null),[g,y]=a.useState(null),[b,j]=a.useState(!1),[f,v]=a.useState(""),[N,w]=a.useState("all"),[k,S]=a.useState("all");a.useEffect(()=>{C()},[e]);const C=async()=>{n(!0);try{const e=E(),t=D(),s=A(),a=I(e,t,s);o(e),m(t),x(s),p(a)}catch(e){console.error("Error loading safety data:",e)}finally{n(!1)}},E=()=>[{id:"incident-1",title:"Minor Cut on Hand",description:"Worker sustained minor cut while handling metal sheeting",type:"injury",severity:"minor",status:"resolved",reportedBy:"John Smith",reportedAt:new Date(Date.now()-1728e5),location:"Building A - 2nd Floor",involvedPersons:["Mike Johnson"],witnesses:["Sarah Wilson"],photos:["/mock-photos/incident-1.jpg"],rootCause:"Improper handling technique",correctiveActions:["Additional training on material handling","Provide cut-resistant gloves"],investigator:"Safety Officer",investigatedAt:new Date(Date.now()-864e5),lostTimeHours:0,medicalTreatment:!0,oshaRecordable:!1},{id:"incident-2",title:"Near Miss - Falling Object",description:"Tool fell from scaffolding, narrowly missing worker below",type:"near_miss",severity:"serious",status:"investigating",reportedBy:"Lisa Chen",reportedAt:new Date(Date.now()-144e5),location:"Building A - Exterior",involvedPersons:["David Brown"],witnesses:["Tom Wilson","Anna Davis"],photos:["/mock-photos/incident-2.jpg"],correctiveActions:["Install tool lanyards","Review scaffolding safety procedures"],investigator:"Safety Officer"}],D=()=>[{id:"training-1",title:"Fall Protection Training",description:"Comprehensive training on fall protection systems and procedures",type:"certification",duration:240,instructor:"Safety Officer",scheduledDate:new Date(Date.now()+2592e5),attendees:[],requiredAttendees:["user-1","user-2","user-3","user-4"],materials:["Fall Protection Manual","Safety Harness Demo"],quiz:{questions:20,passingScore:80,results:{}},certificateValid:new Date(Date.now()+31536e6),isRequired:!0,status:"scheduled"},{id:"training-2",title:"Weekly Toolbox Talk - Electrical Safety",description:"Weekly safety meeting focusing on electrical hazards",type:"toolbox_talk",duration:30,instructor:"Electrical Foreman",scheduledDate:new Date(Date.now()-1728e5),completedDate:new Date(Date.now()-1728e5),attendees:["user-1","user-2","user-3"],requiredAttendees:["user-1","user-2","user-3","user-4"],materials:["Electrical Safety Checklist"],isRequired:!0,status:"completed"}],A=()=>[{id:"inspection-1",title:"Daily Safety Inspection",type:"daily",inspector:"Safety Officer",scheduledDate:new Date,completedDate:new Date,location:"Entire Site",score:92,hazardsIdentified:3,hazardsResolved:2,photos:["/mock-photos/safety-inspection-1.jpg"],notes:"Overall good compliance, minor housekeeping issues noted",status:"completed",checklist:[{id:"check-1",item:"PPE Compliance",category:"Personal Protective Equipment",isCompliant:!0,notes:"All workers wearing required PPE"},{id:"check-2",item:"Housekeeping",category:"Site Conditions",isCompliant:!1,notes:"Debris accumulation in work area",actionRequired:"Clean up debris by end of day"},{id:"check-3",item:"Fall Protection",category:"Fall Protection",isCompliant:!0,notes:"Proper fall protection systems in place"}]}],I=(e,t,s)=>{const a=e.length,r=e.filter(e=>"injury"===e.type).length,i=e.filter(e=>"near_miss"===e.type).length,n=e.filter(e=>e.lostTimeHours&&e.lostTimeHours>0).length,l=e.filter(e=>e.oshaRecordable).length,o=t.filter(e=>"completed"===e.status),c=t.reduce((e,t)=>e+t.requiredAttendees.length,0),d=o.reduce((e,t)=>e+t.attendees.length,0),m=c>0?d/c*100:100,u=s.filter(e=>"completed"===e.status),x=u.length>0?u.reduce((e,t)=>e+(t.score||0),0)/u.length:0;return{totalIncidents:a,injuryRate:r,nearMissRate:i,daysWithoutIncident:45,lostTimeIncidents:n,oshaRecordableIncidents:l,safetyScore:x,trainingComplianceRate:m,ppeComplianceRate:98,hazardsIdentified:s.reduce((e,t)=>e+t.hazardsIdentified,0),hazardsResolved:s.reduce((e,t)=>e+t.hazardsResolved,0),safetyMeetingsHeld:o.filter(e=>"toolbox_talk"===e.type).length,trendsData:[{date:new Date(Date.now()-2592e6),incidents:1,nearMisses:2,trainingHours:120,safetyScore:88},{date:new Date(Date.now()-1296e6),incidents:0,nearMisses:1,trainingHours:80,safetyScore:92},{date:new Date,incidents:a,nearMisses:i,trainingHours:160,safetyScore:x}]}},T=e=>{switch(e){case"completed":case"resolved":case"closed":return"text-green-600 bg-green-100";case"in_progress":case"investigating":return"text-blue-600 bg-blue-100";case"scheduled":case"reported":return"text-yellow-600 bg-yellow-100";case"failed":case"critical":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},M=l.filter(e=>{const t=e.title.toLowerCase().includes(f.toLowerCase())||e.location.toLowerCase().includes(f.toLowerCase())||e.type.toLowerCase().includes(f.toLowerCase()),s="all"===N||e.status===N,a="all"===k||e.type===k;return t&&s&&a}),R=[{id:"overview",label:"Overview",icon:ct},{id:"incidents",label:"Incidents",icon:hs},{id:"training",label:"Training",icon:Dt},{id:"inspections",label:"Inspections",icon:ht},{id:"compliance",label:"Compliance",icon:Zt}];return i?d.jsxs("div",{className:"flex items-center justify-center h-64",children:[d.jsx(Bt,{className:"w-8 h-8 animate-spin text-blue-600"}),d.jsx("span",{className:"ml-2 text-gray-600",children:"Loading safety data..."})]}):d.jsxs("div",{className:"bg-white rounded-lg shadow-lg",children:[d.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Safety Management"}),d.jsx("p",{className:"text-gray-600",children:"Incident tracking, training, and safety compliance"})]}),d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("input",{type:"text",placeholder:"Search incidents...",value:f,onChange:e=>v(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-64"}),d.jsxs("select",{value:N,onChange:e=>w(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"all",children:"All Status"}),d.jsx("option",{value:"reported",children:"Reported"}),d.jsx("option",{value:"investigating",children:"Investigating"}),d.jsx("option",{value:"resolved",children:"Resolved"}),d.jsx("option",{value:"closed",children:"Closed"})]}),d.jsxs("select",{value:k,onChange:e=>S(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"all",children:"All Types"}),d.jsx("option",{value:"injury",children:"Injury"}),d.jsx("option",{value:"near_miss",children:"Near Miss"}),d.jsx("option",{value:"property_damage",children:"Property Damage"}),d.jsx("option",{value:"environmental",children:"Environmental"})]})]}),d.jsxs("button",{onClick:()=>j(!0),className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:[d.jsx(zt,{className:"w-4 h-4 mr-2"}),"Report Incident"]})]})]})}),d.jsx("div",{className:"border-b border-gray-200",children:d.jsx("nav",{className:"flex space-x-8 px-6",children:R.map(e=>{const t=e.icon;return d.jsxs("button",{onClick:()=>r(e.id),className:"flex items-center py-4 px-1 border-b-2 font-medium text-sm "+(s===e.id?"border-red-500 text-red-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[d.jsx(t,{className:"w-4 h-4 mr-2"}),e.label]},e.id)})})}),d.jsxs("div",{className:"p-6",children:["overview"===s&&h&&d.jsx(Ga,{metrics:h,incidents:l,trainings:c,inspections:u}),"incidents"===s&&d.jsx(Qa,{incidents:M,onSelectIncident:y,onCreateIncident:()=>j(!0),getStatusColor:T,getSeverityColor:e=>{switch(e){case"critical":return"text-red-600";case"serious":return"text-orange-600";case"moderate":return"text-yellow-600";case"minor":return"text-green-600";default:return"text-gray-600"}}}),"training"===s&&d.jsx(Xa,{trainings:c,getStatusColor:T}),"inspections"===s&&d.jsx(Ka,{inspections:u,getStatusColor:T}),"compliance"===s&&d.jsx(Za,{metrics:h})]}),b&&d.jsx(er,{projectId:e,onClose:()=>j(!1),onSuccess:e=>{o([...l,e]),j(!1)}}),g&&d.jsx(tr,{incident:g,onClose:()=>y(null),onUpdate:e=>{o(l.map(t=>t.id===e.id?e:t)),y(null)}})]})},Ga=({metrics:e,incidents:t,trainings:s,inspections:a})=>{const r=[{title:"Days Without Incident",value:e.daysWithoutIncident.toString(),change:5,icon:Zt,color:"green"},{title:"Safety Score",value:`${e.safetyScore.toFixed(1)}/100`,change:2.3,icon:os,color:"blue"},{title:"Training Compliance",value:`${e.trainingComplianceRate.toFixed(1)}%`,change:1.5,icon:Dt,color:"purple"},{title:"PPE Compliance",value:`${e.ppeComplianceRate.toFixed(1)}%`,change:.8,icon:It,color:"orange"}];return d.jsxs("div",{className:"space-y-6",children:[d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:r.map((e,t)=>{const s=e.icon;return d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("div",{className:`p-2 rounded-lg bg-${e.color}-100`,children:d.jsx(s,{className:`w-5 h-5 text-${e.color}-600`})}),d.jsxs("div",{className:"flex items-center text-sm "+(e.change>=0?"text-green-600":"text-red-600"),children:[d.jsx(xs,{className:"w-4 h-4 mr-1 "+(e.change<0?"rotate-180":"")}),Math.abs(e.change),"%"]})]}),d.jsxs("div",{className:"mt-4",children:[d.jsx("h3",{className:"text-sm font-medium text-gray-600",children:e.title}),d.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:e.value})]})]},t)})}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Incident Summary"}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-600",children:"Total Incidents"}),d.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.totalIncidents})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-600",children:"Injuries"}),d.jsx("span",{className:"text-sm font-medium text-red-600",children:e.injuryRate})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-600",children:"Near Misses"}),d.jsx("span",{className:"text-sm font-medium text-yellow-600",children:e.nearMissRate})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-600",children:"OSHA Recordable"}),d.jsx("span",{className:"text-sm font-medium text-orange-600",children:e.oshaRecordableIncidents})]})]})]}),d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Incidents"}),d.jsx("div",{className:"space-y-3",children:t.slice(0,5).map(e=>d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.title}),d.jsx("p",{className:"text-xs text-gray-500",children:e.location})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:`text-xs font-medium ${Ya(e.severity)}`,children:e.severity.toUpperCase()}),d.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${Ja(e.status)}`,children:e.status.replace("_"," ")})]})]},e.id))})]})]})]})},Ja=e=>{switch(e){case"completed":case"resolved":case"closed":return"text-green-600 bg-green-100";case"in_progress":case"investigating":return"text-blue-600 bg-blue-100";case"scheduled":case"reported":return"text-yellow-600 bg-yellow-100";case"failed":case"critical":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},Ya=e=>{switch(e){case"critical":return"text-red-600";case"serious":return"text-orange-600";case"moderate":return"text-yellow-600";case"minor":return"text-green-600";default:return"text-gray-600"}},Qa=({incidents:e,onSelectIncident:t,onCreateIncident:s,getStatusColor:a,getSeverityColor:r})=>0===e.length?d.jsxs("div",{className:"text-center py-12",children:[d.jsx(Zt,{className:"w-16 h-16 text-green-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No incidents reported"}),d.jsx("p",{className:"text-gray-600 mb-4",children:"Great job maintaining a safe workplace!"}),d.jsxs("button",{onClick:s,className:"inline-flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:[d.jsx(zt,{className:"w-4 h-4 mr-2"}),"Report Incident"]})]}):d.jsx("div",{className:"space-y-4",children:d.jsx("div",{className:"grid gap-4",children:e.map(e=>d.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center mb-2",children:[d.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:e.title}),d.jsx("span",{className:`ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full ${a(e.status)}`,children:e.status.replace("_"," ")}),d.jsx("span",{className:`ml-2 text-xs font-medium ${r(e.severity)}`,children:e.severity.toUpperCase()})]}),d.jsx("p",{className:"text-gray-600 mb-3",children:e.description}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Type:"}),d.jsx("p",{className:"font-medium",children:e.type.replace("_"," ")})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Location:"}),d.jsx("p",{className:"font-medium",children:e.location})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Reported by:"}),d.jsx("p",{className:"font-medium",children:e.reportedBy})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Date:"}),d.jsx("p",{className:"font-medium",children:e.reportedAt.toLocaleDateString()})]})]}),void 0!==e.lostTimeHours&&d.jsxs("div",{className:"mt-3",children:[d.jsx("span",{className:"text-sm text-gray-500",children:"Lost Time: "}),d.jsxs("span",{className:"font-medium "+(e.lostTimeHours>0?"text-red-600":"text-green-600"),children:[e.lostTimeHours," hours"]})]})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{onClick:()=>t(e),className:"p-2 text-blue-600 hover:text-blue-800",title:"View Details",children:d.jsx(Nt,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-2 text-gray-600 hover:text-gray-800",title:"Edit",children:d.jsx(rs,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-2 text-green-600 hover:text-green-800",title:"Download Report",children:d.jsx(ft,{className:"w-4 h-4"})})]})]})},e.id))})}),Xa=({trainings:e,getStatusColor:t})=>d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Safety Training"}),d.jsxs("button",{className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-4 h-4 mr-2"}),"Schedule Training"]})]}),d.jsx("div",{className:"grid gap-4",children:e.map(e=>d.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center mb-2",children:[d.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:e.title}),d.jsx("span",{className:`ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t(e.status)}`,children:e.status.replace("_"," ")}),e.isRequired&&d.jsx("span",{className:"ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:"Required"})]}),d.jsx("p",{className:"text-gray-600 mb-3",children:e.description}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Type:"}),d.jsx("p",{className:"font-medium",children:e.type.replace("_"," ")})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Duration:"}),d.jsxs("p",{className:"font-medium",children:[e.duration," minutes"]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Instructor:"}),d.jsx("p",{className:"font-medium",children:e.instructor})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Scheduled:"}),d.jsx("p",{className:"font-medium",children:e.scheduledDate.toLocaleDateString()})]})]}),d.jsxs("div",{className:"mt-3",children:[d.jsx("span",{className:"text-sm text-gray-500",children:"Attendance: "}),d.jsxs("span",{className:"font-medium",children:[e.attendees.length,"/",e.requiredAttendees.length," attendees"]})]})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{className:"p-2 text-blue-600 hover:text-blue-800",title:"View Details",children:d.jsx(Nt,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-2 text-gray-600 hover:text-gray-800",title:"Edit",children:d.jsx(rs,{className:"w-4 h-4"})})]})]})},e.id))})]}),Ka=({inspections:e,getStatusColor:t})=>d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Safety Inspections"}),d.jsxs("button",{className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-4 h-4 mr-2"}),"Schedule Inspection"]})]}),d.jsx("div",{className:"grid gap-4",children:e.map(e=>d.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center mb-2",children:[d.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:e.title}),d.jsx("span",{className:`ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t(e.status)}`,children:e.status.replace("_"," ")})]}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Type:"}),d.jsx("p",{className:"font-medium",children:e.type})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Inspector:"}),d.jsx("p",{className:"font-medium",children:e.inspector})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Location:"}),d.jsx("p",{className:"font-medium",children:e.location})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Date:"}),d.jsx("p",{className:"font-medium",children:e.scheduledDate.toLocaleDateString()})]})]}),e.score&&d.jsxs("div",{className:"mt-3",children:[d.jsx("span",{className:"text-sm text-gray-500",children:"Safety Score: "}),d.jsxs("span",{className:"font-medium "+(e.score>=90?"text-green-600":e.score>=70?"text-yellow-600":"text-red-600"),children:[e.score,"/100"]})]}),d.jsxs("div",{className:"mt-3",children:[d.jsx("span",{className:"text-sm text-gray-500",children:"Hazards: "}),d.jsxs("span",{className:"font-medium",children:[e.hazardsResolved,"/",e.hazardsIdentified," resolved"]})]})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{className:"p-2 text-blue-600 hover:text-blue-800",title:"View Details",children:d.jsx(Nt,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-2 text-gray-600 hover:text-gray-800",title:"Edit",children:d.jsx(rs,{className:"w-4 h-4"})})]})]})},e.id))})]}),Za=({metrics:e})=>d.jsxs("div",{className:"text-center py-12",children:[d.jsx(Zt,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Safety Compliance"}),d.jsx("p",{className:"text-gray-600 mb-4",children:"Monitor compliance with safety regulations and standards"}),e&&d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 max-w-2xl mx-auto",children:[d.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[d.jsx("p",{className:"text-sm text-green-600",children:"Training Compliance"}),d.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[e.trainingComplianceRate.toFixed(1),"%"]})]}),d.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[d.jsx("p",{className:"text-sm text-blue-600",children:"PPE Compliance"}),d.jsxs("p",{className:"text-2xl font-bold text-blue-900",children:[e.ppeComplianceRate.toFixed(1),"%"]})]}),d.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[d.jsx("p",{className:"text-sm text-purple-600",children:"Safety Score"}),d.jsxs("p",{className:"text-2xl font-bold text-purple-900",children:[e.safetyScore.toFixed(1),"/100"]})]})]})]}),er=({projectId:e,onClose:t,onSuccess:s})=>{const[r,i]=a.useState({title:"",description:"",type:"near_miss",severity:"minor",location:"",involvedPersons:"",witnesses:""});return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl mx-4",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Report Safety Incident"})}),d.jsxs("form",{onSubmit:e=>{e.preventDefault();const t={id:`incident-${Date.now()}`,...r,status:"reported",reportedBy:"Current User",reportedAt:new Date,involvedPersons:r.involvedPersons.split(",").map(e=>e.trim()).filter(Boolean),witnesses:r.witnesses.split(",").map(e=>e.trim()).filter(Boolean),photos:[],correctiveActions:[]};s(t)},className:"p-6 space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),d.jsx("input",{type:"text",required:!0,value:r.title,onChange:e=>i({...r,title:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Brief description of the incident"})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),d.jsx("textarea",{required:!0,value:r.description,onChange:e=>i({...r,description:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Detailed description of what happened"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),d.jsxs("select",{value:r.type,onChange:e=>i({...r,type:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"injury",children:"Injury"}),d.jsx("option",{value:"near_miss",children:"Near Miss"}),d.jsx("option",{value:"property_damage",children:"Property Damage"}),d.jsx("option",{value:"environmental",children:"Environmental"}),d.jsx("option",{value:"security",children:"Security"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Severity"}),d.jsxs("select",{value:r.severity,onChange:e=>i({...r,severity:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"minor",children:"Minor"}),d.jsx("option",{value:"moderate",children:"Moderate"}),d.jsx("option",{value:"serious",children:"Serious"}),d.jsx("option",{value:"critical",children:"Critical"})]})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location *"}),d.jsx("input",{type:"text",required:!0,value:r.location,onChange:e=>i({...r,location:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Building A - 2nd Floor"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Involved Persons"}),d.jsx("input",{type:"text",value:r.involvedPersons,onChange:e=>i({...r,involvedPersons:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Names separated by commas"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Witnesses"}),d.jsx("input",{type:"text",value:r.witnesses,onChange:e=>i({...r,witnesses:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Names separated by commas"})]})]}),d.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[d.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),d.jsx("button",{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Report Incident"})]})]})]})})},tr=({incident:e,onClose:t,onUpdate:s})=>d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e.title}),d.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded",children:d.jsx(X,{className:"w-5 h-5"})})]})}),d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Incident Details"}),d.jsxs("div",{className:"space-y-3 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Status:"}),d.jsx("span",{className:`ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full ${Ja(e.status)}`,children:e.status.replace("_"," ")})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Type:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.type.replace("_"," ")})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Severity:"}),d.jsx("span",{className:`ml-2 font-medium ${Ya(e.severity)}`,children:e.severity})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Location:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.location})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Reported by:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.reportedBy})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Date:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.reportedAt.toLocaleDateString()})]})]})]}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Investigation Status"}),d.jsxs("div",{className:"space-y-3 text-sm",children:[e.investigator&&d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Investigator:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.investigator})]}),e.rootCause&&d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Root Cause:"}),d.jsx("p",{className:"mt-1 text-gray-700",children:e.rootCause})]}),e.correctiveActions.length>0&&d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Corrective Actions:"}),d.jsx("ul",{className:"mt-1 list-disc list-inside text-gray-700",children:e.correctiveActions.map((e,t)=>d.jsx("li",{children:e},t))})]})]})]})]}),d.jsxs("div",{className:"mt-6",children:[d.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Description"}),d.jsx("p",{className:"text-sm text-gray-700 bg-gray-50 p-3 rounded-lg",children:e.description})]})]}),d.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:d.jsxs("div",{className:"flex justify-end space-x-3",children:[d.jsx("button",{onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Close"}),d.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Edit Incident"})]})})]})}),sr=({projectId:e,userId:t})=>{const[s,r]=a.useState("overview"),[i,n]=a.useState(!0),[l,o]=a.useState([]),[c,m]=a.useState(null),[u,x]=a.useState(null),[h,p]=a.useState(!1),[g,y]=a.useState(""),[b,j]=a.useState("all"),[f,v]=a.useState("all");a.useEffect(()=>{N()},[e]);const N=async()=>{n(!0);try{const e=w(),t=k(e);o(e),m(t)}catch(e){console.error("Error loading equipment data:",e)}finally{n(!1)}},w=()=>[{id:"eq-1",name:"CAT 320 Excavator",type:"excavator",model:"320",manufacturer:"Caterpillar",serialNumber:"CAT320-001",year:2020,status:"in_use",location:"Building A - Site",assignedTo:"John Smith",assignedProject:e,purchaseDate:new Date("2020-01-15"),purchasePrice:35e4,currentValue:28e4,hoursUsed:2450,fuelConsumption:15.5,lastMaintenance:new Date(Date.now()-1296e6),nextMaintenance:new Date(Date.now()+3888e6),maintenanceInterval:250,photos:["/mock-photos/excavator-1.jpg"],documents:["manual.pdf","warranty.pdf"],qrCode:"EQ001",gpsLocation:{latitude:40.7128,longitude:-74.006,lastUpdated:new Date},specifications:{"Operating Weight":"20,500 kg","Engine Power":"122 kW","Bucket Capacity":"1.0 m","Max Digging Depth":"6.5 m"},utilization:[{date:new Date(Date.now()-864e5),hoursUsed:8,fuelUsed:124,operatorId:"john-smith",projectId:e},{date:new Date(Date.now()-1728e5),hoursUsed:7.5,fuelUsed:116,operatorId:"john-smith",projectId:e}],maintenanceHistory:[{id:"maint-1",equipmentId:"eq-1",type:"preventive",description:"250-hour service - oil change, filter replacement",performedBy:"Maintenance Team",performedAt:new Date(Date.now()-1296e6),cost:850,partsUsed:["Engine Oil","Oil Filter","Air Filter"],hoursAtMaintenance:2200,nextMaintenanceDue:new Date(Date.now()+3888e6),photos:["/mock-photos/maintenance-1.jpg"],status:"completed"}],inspectionHistory:[{id:"insp-1",equipmentId:"eq-1",inspector:"Safety Officer",inspectionDate:new Date,type:"daily",overallStatus:"pass",photos:[],defectsFound:[],correctiveActions:[],checklist:[{item:"Engine Oil Level",status:"pass"},{item:"Hydraulic Fluid Level",status:"pass"},{item:"Track Condition",status:"pass"},{item:"Bucket Condition",status:"pass"}]}]},{id:"eq-2",name:"Liebherr LTM 1050",type:"crane",model:"LTM 1050-3.1",manufacturer:"Liebherr",serialNumber:"LTM1050-002",year:2019,status:"maintenance",location:"Equipment Yard",purchaseDate:new Date("2019-06-10"),purchasePrice:85e4,currentValue:72e4,hoursUsed:1850,lastMaintenance:new Date(Date.now()-1728e5),nextMaintenance:new Date(Date.now()+2592e6),maintenanceInterval:200,photos:["/mock-photos/crane-1.jpg"],documents:["manual.pdf","certification.pdf"],qrCode:"EQ002",specifications:{"Max Lifting Capacity":"50 tons","Boom Length":"35 m","Engine Power":"270 kW","Travel Speed":"85 km/h"},utilization:[],maintenanceHistory:[{id:"maint-2",equipmentId:"eq-2",type:"corrective",description:"Hydraulic pump repair",performedBy:"Liebherr Service",performedAt:new Date(Date.now()-1728e5),cost:3500,partsUsed:["Hydraulic Pump","Seals Kit"],hoursAtMaintenance:1850,photos:["/mock-photos/maintenance-2.jpg"],status:"in_progress"}],inspectionHistory:[]},{id:"eq-3",name:"Generac Generator 100kW",type:"generator",model:"SG100",manufacturer:"Generac",serialNumber:"GEN100-003",year:2021,status:"available",location:"Storage Area",purchaseDate:new Date("2021-03-20"),purchasePrice:25e3,currentValue:22e3,hoursUsed:450,fuelConsumption:8.2,lastMaintenance:new Date(Date.now()-2592e6),nextMaintenance:new Date(Date.now()+1728e6),maintenanceInterval:100,photos:["/mock-photos/generator-1.jpg"],documents:["manual.pdf"],qrCode:"EQ003",specifications:{"Power Output":"100 kW","Fuel Type":"Diesel","Fuel Tank":"200 L",Runtime:"24 hours"},utilization:[],maintenanceHistory:[],inspectionHistory:[]}],k=e=>{const t=e.length,s=e.filter(e=>"available"===e.status).length,a=e.filter(e=>"in_use"===e.status).length,r=e.filter(e=>["maintenance","repair"].includes(e.status)).length;return{totalEquipment:t,availableEquipment:s,inUseEquipment:a,maintenanceEquipment:r,averageUtilization:75,totalValue:e.reduce((e,t)=>e+t.currentValue,0),maintenanceCosts:e.reduce((e,t)=>e+t.maintenanceHistory.reduce((e,t)=>e+t.cost,0),0),fuelCosts:15e3,utilizationTrends:[{date:new Date(Date.now()-2592e6),utilization:72,costs:12e3,maintenance:2},{date:new Date(Date.now()-1296e6),utilization:78,costs:14e3,maintenance:1},{date:new Date,utilization:75,costs:15e3,maintenance:r}]}},S=e=>{switch(e){case"available":return"text-green-600 bg-green-100";case"in_use":return"text-blue-600 bg-blue-100";case"maintenance":return"text-yellow-600 bg-yellow-100";case"repair":return"text-orange-600 bg-orange-100";case"out_of_service":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},C=l.filter(e=>{const t=e.name.toLowerCase().includes(g.toLowerCase())||e.model.toLowerCase().includes(g.toLowerCase())||e.manufacturer.toLowerCase().includes(g.toLowerCase()),s="all"===b||e.status===b,a="all"===f||e.type===f;return t&&s&&a}),E=[{id:"overview",label:"Overview",icon:ct},{id:"equipment",label:"Equipment",icon:ps},{id:"maintenance",label:"Maintenance",icon:Ds},{id:"utilization",label:"Utilization",icon:st},{id:"tracking",label:"Tracking",icon:Lt}];return i?d.jsxs("div",{className:"flex items-center justify-center h-64",children:[d.jsx(Bt,{className:"w-8 h-8 animate-spin text-blue-600"}),d.jsx("span",{className:"ml-2 text-gray-600",children:"Loading equipment data..."})]}):d.jsxs("div",{className:"bg-white rounded-lg shadow-lg",children:[d.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Equipment Management"}),d.jsx("p",{className:"text-gray-600",children:"Track, maintain, and optimize equipment utilization"})]}),d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("input",{type:"text",placeholder:"Search equipment...",value:g,onChange:e=>y(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-64"}),d.jsxs("select",{value:b,onChange:e=>j(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"all",children:"All Status"}),d.jsx("option",{value:"available",children:"Available"}),d.jsx("option",{value:"in_use",children:"In Use"}),d.jsx("option",{value:"maintenance",children:"Maintenance"}),d.jsx("option",{value:"repair",children:"Repair"}),d.jsx("option",{value:"out_of_service",children:"Out of Service"})]}),d.jsxs("select",{value:f,onChange:e=>v(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"all",children:"All Types"}),d.jsx("option",{value:"excavator",children:"Excavator"}),d.jsx("option",{value:"crane",children:"Crane"}),d.jsx("option",{value:"bulldozer",children:"Bulldozer"}),d.jsx("option",{value:"loader",children:"Loader"}),d.jsx("option",{value:"truck",children:"Truck"}),d.jsx("option",{value:"generator",children:"Generator"}),d.jsx("option",{value:"compressor",children:"Compressor"}),d.jsx("option",{value:"tool",children:"Tool"})]})]}),d.jsxs("button",{onClick:()=>p(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-4 h-4 mr-2"}),"Add Equipment"]})]})]})}),d.jsx("div",{className:"border-b border-gray-200",children:d.jsx("nav",{className:"flex space-x-8 px-6",children:E.map(e=>{const t=e.icon;return d.jsxs("button",{onClick:()=>r(e.id),className:"flex items-center py-4 px-1 border-b-2 font-medium text-sm "+(s===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[d.jsx(t,{className:"w-4 h-4 mr-2"}),e.label]},e.id)})})}),d.jsxs("div",{className:"p-6",children:["overview"===s&&c&&d.jsx(ar,{metrics:c,equipment:l}),"equipment"===s&&d.jsx(ir,{equipment:C,onSelectEquipment:x,onCreateEquipment:()=>p(!0),getStatusColor:S,getTypeIcon:e=>{switch(e){case"excavator":case"bulldozer":case"loader":case"truck":return ps;case"crane":return st;case"generator":return Is;case"compressor":return Et;case"tool":return Xt;default:return It}}}),"maintenance"===s&&d.jsx(nr,{equipment:l,getStatusColor:S}),"utilization"===s&&d.jsx(lr,{equipment:l}),"tracking"===s&&d.jsx(or,{equipment:l})]}),h&&d.jsx(cr,{projectId:e,onClose:()=>p(!1),onSuccess:e=>{o([...l,e]),p(!1)}}),u&&d.jsx(dr,{equipment:u,onClose:()=>x(null),onUpdate:e=>{o(l.map(t=>t.id===e.id?e:t)),x(null)}})]})},ar=({metrics:e,equipment:t})=>{const s=[{title:"Total Equipment",value:e.totalEquipment.toString(),change:0,icon:ps,color:"blue"},{title:"Utilization Rate",value:`${e.averageUtilization}%`,change:3.2,icon:st,color:"green"},{title:"Total Value",value:`$${(e.totalValue/1e6).toFixed(1)}M`,change:-2.1,icon:jt,color:"purple"},{title:"Maintenance Costs",value:`$${e.maintenanceCosts.toLocaleString()}`,change:-5.8,icon:Ds,color:"orange"}];return d.jsxs("div",{className:"space-y-6",children:[d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:s.map((e,t)=>{const s=e.icon;return d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("div",{className:`p-2 rounded-lg bg-${e.color}-100`,children:d.jsx(s,{className:`w-5 h-5 text-${e.color}-600`})}),0!==e.change&&d.jsxs("div",{className:"flex items-center text-sm "+(e.change>=0?"text-green-600":"text-red-600"),children:[d.jsx(xs,{className:"w-4 h-4 mr-1 "+(e.change<0?"rotate-180":"")}),Math.abs(e.change),"%"]})]}),d.jsxs("div",{className:"mt-4",children:[d.jsx("h3",{className:"text-sm font-medium text-gray-600",children:e.title}),d.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:e.value})]})]},t)})}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Equipment Status"}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-600",children:"Available"}),d.jsx("span",{className:"text-sm font-medium text-green-600",children:e.availableEquipment})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-600",children:"In Use"}),d.jsx("span",{className:"text-sm font-medium text-blue-600",children:e.inUseEquipment})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-600",children:"Maintenance"}),d.jsx("span",{className:"text-sm font-medium text-yellow-600",children:e.maintenanceEquipment})]})]})]}),d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Equipment Activity"}),d.jsx("div",{className:"space-y-3",children:t.slice(0,5).map(e=>d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.name}),d.jsx("p",{className:"text-xs text-gray-500",children:e.location})]}),d.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${rr(e.status)}`,children:e.status.replace("_"," ")})]},e.id))})]})]})]})},rr=e=>{switch(e){case"available":return"text-green-600 bg-green-100";case"in_use":return"text-blue-600 bg-blue-100";case"maintenance":return"text-yellow-600 bg-yellow-100";case"repair":return"text-orange-600 bg-orange-100";case"out_of_service":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},ir=({equipment:e,onSelectEquipment:t,onCreateEquipment:s,getStatusColor:a,getTypeIcon:r})=>0===e.length?d.jsxs("div",{className:"text-center py-12",children:[d.jsx(ps,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No equipment found"}),d.jsx("p",{className:"text-gray-600 mb-4",children:"Add your first piece of equipment to get started"}),d.jsxs("button",{onClick:s,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-4 h-4 mr-2"}),"Add Equipment"]})]}):d.jsx("div",{className:"space-y-4",children:d.jsx("div",{className:"grid gap-4",children:e.map(e=>{const s=r(e.type);return d.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex items-start space-x-4",children:[d.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:d.jsx(s,{className:"w-6 h-6 text-blue-600"})}),d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center mb-2",children:[d.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:e.name}),d.jsx("span",{className:`ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full ${a(e.status)}`,children:e.status.replace("_"," ")})]}),d.jsxs("p",{className:"text-gray-600 mb-3",children:[e.manufacturer," ",e.model," (",e.year,")"]}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Serial:"}),d.jsx("p",{className:"font-medium",children:e.serialNumber})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Location:"}),d.jsx("p",{className:"font-medium",children:e.location})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Hours:"}),d.jsx("p",{className:"font-medium",children:e.hoursUsed.toLocaleString()})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Value:"}),d.jsxs("p",{className:"font-medium",children:["$",e.currentValue.toLocaleString()]})]})]}),e.assignedTo&&d.jsxs("div",{className:"mt-3",children:[d.jsx("span",{className:"text-sm text-gray-500",children:"Assigned to: "}),d.jsx("span",{className:"font-medium",children:e.assignedTo})]})]})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{onClick:()=>t(e),className:"p-2 text-blue-600 hover:text-blue-800",title:"View Details",children:d.jsx(Nt,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-2 text-gray-600 hover:text-gray-800",title:"Edit",children:d.jsx(rs,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-2 text-green-600 hover:text-green-800",title:"QR Code",children:d.jsx(Ht,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-2 text-purple-600 hover:text-purple-800",title:"Location",children:d.jsx(Lt,{className:"w-4 h-4"})})]})]})},e.id)})})}),nr=({equipment:e,getStatusColor:t})=>{const s=e.flatMap(e=>e.maintenanceHistory.map(t=>({...t,equipmentName:e.name})));return d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Maintenance Records"}),d.jsxs("button",{className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-4 h-4 mr-2"}),"Schedule Maintenance"]})]}),0===s.length?d.jsxs("div",{className:"text-center py-12",children:[d.jsx(Ds,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No maintenance records"}),d.jsx("p",{className:"text-gray-600",children:"Schedule maintenance to keep equipment running smoothly"})]}):d.jsx("div",{className:"grid gap-4",children:s.map(e=>d.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center mb-2",children:[d.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:e.description}),d.jsx("span",{className:`ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t(e.status)}`,children:e.status.replace("_"," ")})]}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Equipment:"}),d.jsx("p",{className:"font-medium",children:e.equipmentName})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Type:"}),d.jsx("p",{className:"font-medium",children:e.type})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Performed by:"}),d.jsx("p",{className:"font-medium",children:e.performedBy})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Cost:"}),d.jsxs("p",{className:"font-medium",children:["$",e.cost.toLocaleString()]})]})]}),e.partsUsed.length>0&&d.jsxs("div",{className:"mt-3",children:[d.jsx("span",{className:"text-sm text-gray-500",children:"Parts used: "}),d.jsx("span",{className:"font-medium",children:e.partsUsed.join(", ")})]})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{className:"p-2 text-blue-600 hover:text-blue-800",title:"View Details",children:d.jsx(Nt,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-2 text-gray-600 hover:text-gray-800",title:"Edit",children:d.jsx(rs,{className:"w-4 h-4"})})]})]})},e.id))})]})},lr=({equipment:e})=>d.jsxs("div",{className:"text-center py-12",children:[d.jsx(st,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Equipment Utilization"}),d.jsx("p",{className:"text-gray-600",children:"Track equipment usage and efficiency metrics"})]}),or=({equipment:e})=>d.jsxs("div",{className:"text-center py-12",children:[d.jsx(Lt,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Equipment Tracking"}),d.jsx("p",{className:"text-gray-600",children:"Real-time GPS tracking and location history"})]}),cr=({projectId:e,onClose:t,onSuccess:s})=>{const[r,i]=a.useState({name:"",type:"excavator",model:"",manufacturer:"",serialNumber:"",year:(new Date).getFullYear(),location:"",purchasePrice:0,maintenanceInterval:250});return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl mx-4",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Add New Equipment"})}),d.jsxs("form",{onSubmit:e=>{e.preventDefault();const t={id:`eq-${Date.now()}`,...r,status:"available",purchaseDate:new Date,currentValue:.8*r.purchasePrice,hoursUsed:0,photos:[],documents:[],specifications:{},utilization:[],maintenanceHistory:[],inspectionHistory:[]};s(t)},className:"p-6 space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Equipment Name *"}),d.jsx("input",{type:"text",required:!0,value:r.name,onChange:e=>i({...r,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., CAT 320 Excavator"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),d.jsxs("select",{value:r.type,onChange:e=>i({...r,type:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"excavator",children:"Excavator"}),d.jsx("option",{value:"crane",children:"Crane"}),d.jsx("option",{value:"bulldozer",children:"Bulldozer"}),d.jsx("option",{value:"loader",children:"Loader"}),d.jsx("option",{value:"truck",children:"Truck"}),d.jsx("option",{value:"generator",children:"Generator"}),d.jsx("option",{value:"compressor",children:"Compressor"}),d.jsx("option",{value:"tool",children:"Tool"}),d.jsx("option",{value:"other",children:"Other"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Manufacturer"}),d.jsx("input",{type:"text",value:r.manufacturer,onChange:e=>i({...r,manufacturer:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Caterpillar"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Model"}),d.jsx("input",{type:"text",value:r.model,onChange:e=>i({...r,model:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., 320"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Serial Number"}),d.jsx("input",{type:"text",value:r.serialNumber,onChange:e=>i({...r,serialNumber:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Equipment serial number"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year"}),d.jsx("input",{type:"number",value:r.year,onChange:e=>i({...r,year:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"1990",max:(new Date).getFullYear()+1})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Location"}),d.jsx("input",{type:"text",value:r.location,onChange:e=>i({...r,location:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Current location"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Purchase Price"}),d.jsx("input",{type:"number",value:r.purchasePrice,onChange:e=>i({...r,purchasePrice:parseFloat(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0",step:"1000"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Maintenance Interval (hours)"}),d.jsx("input",{type:"number",value:r.maintenanceInterval,onChange:e=>i({...r,maintenanceInterval:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"1"})]})]}),d.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[d.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),d.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Add Equipment"})]})]})]})})},dr=({equipment:e,onClose:t,onUpdate:s})=>d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),d.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded",children:d.jsx(X,{className:"w-5 h-5"})})]})}),d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Equipment Details"}),d.jsxs("div",{className:"space-y-3 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Status:"}),d.jsx("span",{className:`ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full ${rr(e.status)}`,children:e.status.replace("_"," ")})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Type:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.type})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Manufacturer:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.manufacturer})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Model:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.model})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Year:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.year})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Serial Number:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.serialNumber})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Location:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.location})]})]})]}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Usage & Maintenance"}),d.jsxs("div",{className:"space-y-3 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Hours Used:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.hoursUsed.toLocaleString()})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Current Value:"}),d.jsxs("span",{className:"ml-2 font-medium",children:["$",e.currentValue.toLocaleString()]})]}),e.lastMaintenance&&d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Last Maintenance:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.lastMaintenance.toLocaleDateString()})]}),e.nextMaintenance&&d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Next Maintenance:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.nextMaintenance.toLocaleDateString()})]}),e.assignedTo&&d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Assigned to:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.assignedTo})]})]})]})]}),Object.keys(e.specifications).length>0&&d.jsxs("div",{className:"mt-6",children:[d.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Specifications"}),d.jsx("div",{className:"grid grid-cols-2 gap-4 text-sm",children:Object.entries(e.specifications).map(([e,t])=>d.jsxs("div",{children:[d.jsxs("span",{className:"text-gray-500",children:[e,":"]}),d.jsx("span",{className:"ml-2 font-medium",children:t})]},e))})]})]}),d.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:d.jsxs("div",{className:"flex justify-end space-x-3",children:[d.jsx("button",{onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Close"}),d.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Edit Equipment"})]})})]})}),mr=({projectId:e,userId:t})=>{const[s,r]=a.useState("users"),[i,n]=a.useState(!0),[l,o]=a.useState([]),[c,m]=a.useState([]),[u,x]=a.useState([]),[h,p]=a.useState([]),[g,y]=a.useState(null),[b,j]=a.useState(null),[f,v]=a.useState(!1),[N,w]=a.useState(""),[k,S]=a.useState("all"),[C,E]=a.useState("all"),[D,A]=a.useState("all");a.useEffect(()=>{I()},[e]);const I=async()=>{n(!0);try{const e=T(),t=M(),s=R(),a=P(),r=L(e,t,s);o(e),m(t),x(s),p(a),y(r)}catch(e){console.error("Error loading user data:",e)}finally{n(!1)}},T=()=>[{id:"user-1",email:"john.smith@construction.com",firstName:"John",lastName:"Smith",displayName:"John Smith",phone:"+1-555-0101",title:"Project Manager",department:"Construction",company:"ABC Construction",companyId:"company-1",role:{id:"role-manager",name:"Project Manager",description:"Manages construction projects",level:2,permissions:["project.read","project.update","team.manage"],isSystemRole:!0},permissions:[],status:"active",lastLogin:new Date(Date.now()-72e5),createdAt:new Date(Date.now()-7776e6),updatedAt:new Date(Date.now()-864e5),projects:[{projectId:"project-1",projectName:"Downtown Office Complex",role:"Project Manager",permissions:["full_access"],assignedAt:new Date(Date.now()-5184e6),assignedBy:"admin"}],preferences:{theme:"light",language:"en",timezone:"America/New_York",notifications:{email:!0,push:!0,sms:!1,frequency:"immediate"},dashboard:{layout:"default",widgets:["projects","tasks","calendar"]}},twoFactorEnabled:!0,loginAttempts:0,passwordLastChanged:new Date(Date.now()-2592e6),mustChangePassword:!1},{id:"user-2",email:"sarah.johnson@construction.com",firstName:"Sarah",lastName:"Johnson",displayName:"Sarah Johnson",phone:"+1-555-0102",title:"Site Supervisor",department:"Field Operations",company:"ABC Construction",companyId:"company-1",role:{id:"role-supervisor",name:"Site Supervisor",description:"Supervises on-site construction activities",level:3,permissions:["field.read","field.update","safety.manage"],isSystemRole:!0},permissions:[],status:"active",lastLogin:new Date(Date.now()-18e5),createdAt:new Date(Date.now()-5184e6),updatedAt:new Date(Date.now()-36e5),projects:[{projectId:"project-1",projectName:"Downtown Office Complex",role:"Site Supervisor",permissions:["field_access","safety_reports"],assignedAt:new Date(Date.now()-3888e6),assignedBy:"user-1"}],preferences:{theme:"light",language:"en",timezone:"America/New_York",notifications:{email:!0,push:!0,sms:!0,frequency:"immediate"},dashboard:{layout:"mobile",widgets:["tasks","safety","weather"]}},twoFactorEnabled:!1,loginAttempts:0,passwordLastChanged:new Date(Date.now()-3888e6),mustChangePassword:!1},{id:"user-3",email:"mike.wilson@subcontractor.com",firstName:"Mike",lastName:"Wilson",displayName:"Mike Wilson",phone:"+1-555-0103",title:"Electrical Foreman",department:"Electrical",company:"Wilson Electric",companyId:"company-2",role:{id:"role-foreman",name:"Trade Foreman",description:"Leads specific trade activities",level:3,permissions:["trade.read","trade.update"],isSystemRole:!0},permissions:[],status:"active",lastLogin:new Date(Date.now()-144e5),createdAt:new Date(Date.now()-2592e6),updatedAt:new Date(Date.now()-1728e5),projects:[{projectId:"project-1",projectName:"Downtown Office Complex",role:"Electrical Foreman",permissions:["electrical_work","progress_reports"],assignedAt:new Date(Date.now()-216e7),assignedBy:"user-1"}],preferences:{theme:"dark",language:"en",timezone:"America/New_York",notifications:{email:!1,push:!0,sms:!1,frequency:"daily"},dashboard:{layout:"compact",widgets:["tasks","materials","crew"]}},twoFactorEnabled:!1,loginAttempts:0,passwordLastChanged:new Date(Date.now()-1728e6),mustChangePassword:!1},{id:"user-4",email:"lisa.chen@consultant.com",firstName:"Lisa",lastName:"Chen",displayName:"Lisa Chen",phone:"+1-555-0104",title:"Quality Inspector",department:"Quality Assurance",company:"QA Consultants",companyId:"company-3",role:{id:"role-inspector",name:"Quality Inspector",description:"Performs quality inspections and compliance checks",level:3,permissions:["quality.read","quality.create","inspections.manage"],isSystemRole:!0},permissions:[],status:"pending",createdAt:new Date(Date.now()-6048e5),updatedAt:new Date(Date.now()-6048e5),projects:[],preferences:{theme:"auto",language:"en",timezone:"America/New_York",notifications:{email:!0,push:!1,sms:!1,frequency:"weekly"},dashboard:{layout:"default",widgets:["inspections","quality","compliance"]}},twoFactorEnabled:!1,loginAttempts:0,passwordLastChanged:new Date(Date.now()-6048e5),mustChangePassword:!0}],M=()=>[{id:"company-1",name:"ABC Construction",type:"contractor",address:"123 Main St, New York, NY 10001",phone:"+1-555-0100",email:"info@abcconstruction.com",website:"https://abcconstruction.com",isActive:!0,createdAt:new Date(Date.now()-31536e6),userCount:25,projectCount:8},{id:"company-2",name:"Wilson Electric",type:"subcontractor",address:"456 Electric Ave, Brooklyn, NY 11201",phone:"+1-555-0200",email:"contact@wilsonelectric.com",parentCompanyId:"company-1",isActive:!0,createdAt:new Date(Date.now()-15552e6),userCount:12,projectCount:3},{id:"company-3",name:"QA Consultants",type:"consultant",address:"789 Quality Blvd, Manhattan, NY 10002",phone:"+1-555-0300",email:"info@qaconsultants.com",website:"https://qaconsultants.com",isActive:!0,createdAt:new Date(Date.now()-7776e6),userCount:8,projectCount:5}],R=()=>[{id:"role-admin",name:"System Administrator",description:"Full system access and administration",level:1,permissions:["*"],isSystemRole:!0},{id:"role-manager",name:"Project Manager",description:"Manages construction projects",level:2,permissions:["project.*","team.manage","budget.read","schedule.manage"],isSystemRole:!0},{id:"role-supervisor",name:"Site Supervisor",description:"Supervises on-site construction activities",level:3,permissions:["field.*","safety.manage","quality.read","team.read"],isSystemRole:!0},{id:"role-foreman",name:"Trade Foreman",description:"Leads specific trade activities",level:3,permissions:["trade.*","crew.manage","materials.read"],isSystemRole:!0},{id:"role-inspector",name:"Quality Inspector",description:"Performs quality inspections and compliance checks",level:3,permissions:["quality.*","inspections.manage","compliance.read"],isSystemRole:!0},{id:"role-worker",name:"Field Worker",description:"Basic field access for construction workers",level:4,permissions:["field.read","tasks.update","timesheets.manage"],isSystemRole:!0}],P=()=>[{id:"perm-1",name:"Project Management",description:"Full project management access",category:"Projects",resource:"project",actions:["create","read","update","delete","approve"]},{id:"perm-2",name:"Field Operations",description:"Field operations and daily activities",category:"Field",resource:"field",actions:["read","update","create"]},{id:"perm-3",name:"Safety Management",description:"Safety incident and compliance management",category:"Safety",resource:"safety",actions:["read","create","update","manage"]},{id:"perm-4",name:"Quality Control",description:"Quality inspections and control",category:"Quality",resource:"quality",actions:["read","create","update","approve"]},{id:"perm-5",name:"User Management",description:"User and role management",category:"Administration",resource:"users",actions:["create","read","update","delete","manage"]}],L=(e,t,s)=>{const a=e.length,r=e.filter(e=>"active"===e.status).length,i=e.filter(e=>"pending"===e.status).length,n=e.filter(e=>"suspended"===e.status).length,l=s.map(t=>{const s=e.filter(e=>e.role.id===t.id).length;return{role:t.name,count:s,percentage:a>0?s/a*100:0}}),o=t.map(t=>({company:t.name,userCount:e.filter(e=>e.companyId===t.id).length,type:t.type}));return{totalUsers:a,activeUsers:r,pendingUsers:i,suspendedUsers:n,totalCompanies:t.length,totalRoles:s.length,loginActivity:[{date:new Date(Date.now()-6048e5),logins:45,uniqueUsers:18},{date:new Date(Date.now()-5184e5),logins:52,uniqueUsers:22},{date:new Date(Date.now()-432e6),logins:38,uniqueUsers:16},{date:new Date(Date.now()-3456e5),logins:41,uniqueUsers:19},{date:new Date(Date.now()-2592e5),logins:47,uniqueUsers:21},{date:new Date(Date.now()-1728e5),logins:35,uniqueUsers:15},{date:new Date(Date.now()-864e5),logins:29,uniqueUsers:14}],roleDistribution:l,companyDistribution:o}},_=l.filter(e=>{const t=e.displayName.toLowerCase().includes(N.toLowerCase())||e.email.toLowerCase().includes(N.toLowerCase())||e.company.toLowerCase().includes(N.toLowerCase()),s="all"===k||e.status===k,a="all"===C||e.role.id===C,r="all"===D||e.companyId===D;return t&&s&&a&&r}),O=[{id:"users",label:"Users",icon:vs},{id:"roles",label:"Roles & Permissions",icon:Zt},{id:"companies",label:"Companies",icon:nt},{id:"overview",label:"Overview",icon:ct},{id:"settings",label:"Settings",icon:Xt}];return i?d.jsxs("div",{className:"flex items-center justify-center h-64",children:[d.jsx(Bt,{className:"w-8 h-8 animate-spin text-blue-600"}),d.jsx("span",{className:"ml-2 text-gray-600",children:"Loading user data..."})]}):d.jsxs("div",{className:"bg-white rounded-lg shadow-lg",children:[d.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"User Management"}),d.jsx("p",{className:"text-gray-600",children:"Manage users, roles, permissions, and company access"})]}),d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("input",{type:"text",placeholder:"Search users...",value:N,onChange:e=>w(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-64"}),d.jsxs("select",{value:k,onChange:e=>S(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"all",children:"All Status"}),d.jsx("option",{value:"active",children:"Active"}),d.jsx("option",{value:"pending",children:"Pending"}),d.jsx("option",{value:"suspended",children:"Suspended"}),d.jsx("option",{value:"inactive",children:"Inactive"})]}),d.jsxs("select",{value:C,onChange:e=>E(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"all",children:"All Roles"}),u.map(e=>d.jsx("option",{value:e.id,children:e.name},e.id))]}),d.jsxs("select",{value:D,onChange:e=>A(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"all",children:"All Companies"}),c.map(e=>d.jsx("option",{value:e.id,children:e.name},e.id))]})]}),d.jsxs("button",{onClick:()=>v(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(bs,{className:"w-4 h-4 mr-2"}),"Add User"]})]})]})}),d.jsx("div",{className:"border-b border-gray-200",children:d.jsx("nav",{className:"flex space-x-8 px-6",children:O.map(e=>{const t=e.icon;return d.jsxs("button",{onClick:()=>r(e.id),className:"flex items-center py-4 px-1 border-b-2 font-medium text-sm "+(s===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[d.jsx(t,{className:"w-4 h-4 mr-2"}),e.label]},e.id)})})}),d.jsxs("div",{className:"p-6",children:["users"===s&&d.jsx(ur,{users:_,onSelectUser:j,onCreateUser:()=>v(!0),getStatusColor:e=>{switch(e){case"active":return"text-green-600 bg-green-100";case"pending":return"text-yellow-600 bg-yellow-100";case"suspended":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},getRoleIcon:e=>{switch(e){case 1:return bt;case 2:return ns;case 3:return rt;default:return vs}}}),"roles"===s&&d.jsx(xr,{roles:u,permissions:h}),"companies"===s&&d.jsx(hr,{companies:c}),"overview"===s&&g&&d.jsx(pr,{metrics:g,users:l,companies:c,roles:u}),"settings"===s&&d.jsx(gr,{})]}),f&&d.jsx(yr,{companies:c,roles:u,onClose:()=>v(!1),onSuccess:e=>{o([...l,e]),v(!1)}}),b&&d.jsx(br,{user:b,companies:c,roles:u,onClose:()=>j(null),onUpdate:e=>{o(l.map(t=>t.id===e.id?e:t)),j(null)}})]})},ur=({users:e,onSelectUser:t,onCreateUser:s,getStatusColor:a,getRoleIcon:r})=>0===e.length?d.jsxs("div",{className:"text-center py-12",children:[d.jsx(vs,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No users found"}),d.jsx("p",{className:"text-gray-600 mb-4",children:"Add users to start managing your team"}),d.jsxs("button",{onClick:s,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(bs,{className:"w-4 h-4 mr-2"}),"Add User"]})]}):d.jsx("div",{className:"space-y-4",children:d.jsx("div",{className:"grid gap-4",children:e.map(e=>{const s=r(e.role.level);return d.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex items-start space-x-4",children:[d.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center",children:e.avatar?d.jsx("img",{src:e.avatar,alt:e.displayName,className:"w-12 h-12 rounded-full"}):d.jsxs("span",{className:"text-blue-600 font-medium text-lg",children:[e.firstName.charAt(0),e.lastName.charAt(0)]})}),d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center mb-2",children:[d.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:e.displayName}),d.jsx("span",{className:`ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full ${a(e.status)}`,children:e.status}),d.jsxs("div",{className:"ml-2 flex items-center text-gray-500",children:[d.jsx(s,{className:"w-4 h-4 mr-1"}),d.jsx("span",{className:"text-sm",children:e.role.name})]}),e.twoFactorEnabled&&d.jsx(Zt,{className:"w-4 h-4 ml-2 text-green-600",title:"2FA Enabled"})]}),d.jsxs("p",{className:"text-gray-600 mb-3",children:[e.title,"  ",e.company]}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Email:"}),d.jsx("p",{className:"font-medium",children:e.email})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Phone:"}),d.jsx("p",{className:"font-medium",children:e.phone||"Not provided"})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Department:"}),d.jsx("p",{className:"font-medium",children:e.department})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Last Login:"}),d.jsx("p",{className:"font-medium",children:e.lastLogin?e.lastLogin.toLocaleDateString():"Never"})]})]}),d.jsxs("div",{className:"mt-3",children:[d.jsx("span",{className:"text-sm text-gray-500",children:"Projects: "}),d.jsxs("span",{className:"font-medium",children:[e.projects.length," assigned"]})]})]})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{onClick:()=>t(e),className:"p-2 text-blue-600 hover:text-blue-800",title:"View Details",children:d.jsx(Nt,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-2 text-gray-600 hover:text-gray-800",title:"Edit User",children:d.jsx(rs,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-2 "+("active"===e.status?"text-red-600 hover:text-red-800":"text-green-600 hover:text-green-800"),title:"active"===e.status?"Suspend User":"Activate User",children:"active"===e.status?d.jsx(js,{className:"w-4 h-4"}):d.jsx(ys,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-2 text-gray-600 hover:text-gray-800",title:"More Options",children:d.jsx(vt,{className:"w-4 h-4"})})]})]})},e.id)})})}),xr=({roles:e,permissions:t})=>d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Roles & Permissions"}),d.jsxs("button",{className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-4 h-4 mr-2"}),"Create Role"]})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"System Roles"}),d.jsx("div",{className:"space-y-3",children:e.map(e=>d.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsx("h5",{className:"font-medium text-gray-900",children:e.name}),d.jsxs("span",{className:"text-xs px-2 py-1 rounded-full "+(1===e.level?"bg-red-100 text-red-800":2===e.level?"bg-orange-100 text-orange-800":3===e.level?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:["Level ",e.level]})]}),d.jsx("p",{className:"text-sm text-gray-600 mb-3",children:e.description}),d.jsxs("div",{className:"text-xs text-gray-500",children:[e.permissions.length," permissions"]})]},e.id))})]}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-medium text-gray-900 mb-4",children:"Permission Categories"}),d.jsx("div",{className:"space-y-3",children:t.map(e=>d.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[d.jsx("h5",{className:"font-medium text-gray-900 mb-1",children:e.name}),d.jsx("p",{className:"text-sm text-gray-600 mb-2",children:e.description}),d.jsxs("div",{className:"flex items-center justify-between text-xs",children:[d.jsxs("span",{className:"text-gray-500",children:["Category: ",e.category]}),d.jsxs("span",{className:"text-gray-500",children:["Actions: ",e.actions.join(", ")]})]})]},e.id))})]})]})]}),hr=({companies:e})=>d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Companies"}),d.jsxs("button",{className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-4 h-4 mr-2"}),"Add Company"]})]}),d.jsx("div",{className:"grid gap-4",children:e.map(e=>d.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center mb-2",children:[d.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:e.name}),d.jsx("span",{className:"ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full "+("owner"===e.type?"bg-purple-100 text-purple-800":"contractor"===e.type?"bg-blue-100 text-blue-800":"subcontractor"===e.type?"bg-green-100 text-green-800":"consultant"===e.type?"bg-orange-100 text-orange-800":"bg-gray-100 text-gray-800"),children:e.type})]}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Address:"}),d.jsx("p",{className:"font-medium",children:e.address})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Phone:"}),d.jsx("p",{className:"font-medium",children:e.phone})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Users:"}),d.jsx("p",{className:"font-medium",children:e.userCount})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Projects:"}),d.jsx("p",{className:"font-medium",children:e.projectCount})]})]}),e.website&&d.jsxs("div",{className:"mt-3",children:[d.jsx("span",{className:"text-sm text-gray-500",children:"Website: "}),d.jsx("a",{href:e.website,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800",children:e.website})]})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{className:"p-2 text-blue-600 hover:text-blue-800",title:"View Details",children:d.jsx(Nt,{className:"w-4 h-4"})}),d.jsx("button",{className:"p-2 text-gray-600 hover:text-gray-800",title:"Edit Company",children:d.jsx(rs,{className:"w-4 h-4"})})]})]})},e.id))})]}),pr=({metrics:e,users:t,companies:s,roles:a})=>{const r=[{title:"Total Users",value:e.totalUsers.toString(),change:8.2,icon:vs,color:"blue"},{title:"Active Users",value:e.activeUsers.toString(),change:5.1,icon:ys,color:"green"},{title:"Companies",value:e.totalCompanies.toString(),change:0,icon:nt,color:"purple"},{title:"System Roles",value:e.totalRoles.toString(),change:0,icon:Zt,color:"orange"}];return d.jsxs("div",{className:"space-y-6",children:[d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:r.map((e,t)=>{const s=e.icon;return d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("div",{className:`p-2 rounded-lg bg-${e.color}-100`,children:d.jsx(s,{className:`w-5 h-5 text-${e.color}-600`})}),0!==e.change&&d.jsxs("div",{className:"flex items-center text-sm "+(e.change>=0?"text-green-600":"text-red-600"),children:[d.jsx(xs,{className:"w-4 h-4 mr-1 "+(e.change<0?"rotate-180":"")}),Math.abs(e.change),"%"]})]}),d.jsxs("div",{className:"mt-4",children:[d.jsx("h3",{className:"text-sm font-medium text-gray-600",children:e.title}),d.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:e.value})]})]},t)})}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"User Status Distribution"}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-600",children:"Active"}),d.jsx("span",{className:"text-sm font-medium text-green-600",children:e.activeUsers})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-600",children:"Pending"}),d.jsx("span",{className:"text-sm font-medium text-yellow-600",children:e.pendingUsers})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-600",children:"Suspended"}),d.jsx("span",{className:"text-sm font-medium text-red-600",children:e.suspendedUsers})]})]})]}),d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Role Distribution"}),d.jsx("div",{className:"space-y-3",children:e.roleDistribution.map((e,t)=>d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-600",children:e.role}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.count}),d.jsxs("span",{className:"text-xs text-gray-500",children:["(",e.percentage.toFixed(1),"%)"]})]})]},t))})]})]})]})},gr=()=>d.jsxs("div",{className:"text-center py-12",children:[d.jsx(Xt,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"User Management Settings"}),d.jsx("p",{className:"text-gray-600",children:"Configure user management policies and security settings"})]}),yr=({companies:e,roles:t,onClose:s,onSuccess:r})=>{const[i,n]=a.useState({email:"",firstName:"",lastName:"",phone:"",title:"",department:"",companyId:"",roleId:"",sendInvite:!0});return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl mx-4",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Add New User"})}),d.jsxs("form",{onSubmit:s=>{s.preventDefault();const a=t.find(e=>e.id===i.roleId),n=e.find(e=>e.id===i.companyId);if(!a||!n)return;const l={id:`user-${Date.now()}`,email:i.email,firstName:i.firstName,lastName:i.lastName,displayName:`${i.firstName} ${i.lastName}`,phone:i.phone,title:i.title,department:i.department,company:n.name,companyId:i.companyId,role:a,permissions:[],status:"pending",createdAt:new Date,updatedAt:new Date,projects:[],preferences:{theme:"light",language:"en",timezone:"America/New_York",notifications:{email:!0,push:!0,sms:!1,frequency:"immediate"},dashboard:{layout:"default",widgets:[]}},twoFactorEnabled:!1,loginAttempts:0,passwordLastChanged:new Date,mustChangePassword:!0};r(l)},className:"p-6 space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name *"}),d.jsx("input",{type:"text",required:!0,value:i.firstName,onChange:e=>n({...i,firstName:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name *"}),d.jsx("input",{type:"text",required:!0,value:i.lastName,onChange:e=>n({...i,lastName:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address *"}),d.jsx("input",{type:"email",required:!0,value:i.email,onChange:e=>n({...i,email:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),d.jsx("input",{type:"tel",value:i.phone,onChange:e=>n({...i,phone:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Job Title"}),d.jsx("input",{type:"text",value:i.title,onChange:e=>n({...i,title:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),d.jsx("input",{type:"text",value:i.department,onChange:e=>n({...i,department:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company *"}),d.jsxs("select",{required:!0,value:i.companyId,onChange:e=>n({...i,companyId:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"",children:"Select Company"}),e.map(e=>d.jsx("option",{value:e.id,children:e.name},e.id))]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role *"}),d.jsxs("select",{required:!0,value:i.roleId,onChange:e=>n({...i,roleId:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"",children:"Select Role"}),t.map(e=>d.jsx("option",{value:e.id,children:e.name},e.id))]})]})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",id:"sendInvite",checked:i.sendInvite,onChange:e=>n({...i,sendInvite:e.target.checked}),className:"rounded border-gray-300"}),d.jsx("label",{htmlFor:"sendInvite",className:"ml-2 text-sm text-gray-700",children:"Send invitation email to user"})]}),d.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[d.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),d.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Add User"})]})]})]})})},br=({user:e,companies:t,roles:s,onClose:a,onUpdate:r})=>d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e.displayName}),d.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded",children:d.jsx(X,{className:"w-5 h-5"})})]})}),d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"User Information"}),d.jsxs("div",{className:"space-y-3 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Email:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.email})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Phone:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.phone||"Not provided"})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Title:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.title})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Department:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.department})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Company:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.company})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Role:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.role.name})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Status:"}),d.jsx("span",{className:`ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full ${jr(e.status)}`,children:e.status})]})]})]}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Account Security"}),d.jsxs("div",{className:"space-y-3 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Two-Factor Auth:"}),d.jsx("span",{className:"ml-2 font-medium "+(e.twoFactorEnabled?"text-green-600":"text-red-600"),children:e.twoFactorEnabled?"Enabled":"Disabled"})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Last Login:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.lastLogin?e.lastLogin.toLocaleString():"Never"})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Password Changed:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.passwordLastChanged.toLocaleDateString()})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Must Change Password:"}),d.jsx("span",{className:"ml-2 font-medium "+(e.mustChangePassword?"text-orange-600":"text-green-600"),children:e.mustChangePassword?"Yes":"No"})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Failed Login Attempts:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.loginAttempts})]})]})]})]}),e.projects.length>0&&d.jsxs("div",{className:"mt-6",children:[d.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Project Assignments"}),d.jsx("div",{className:"space-y-2",children:e.projects.map((e,t)=>d.jsx("div",{className:"bg-gray-50 p-3 rounded-lg",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900",children:e.projectName}),d.jsx("p",{className:"text-sm text-gray-600",children:e.role})]}),d.jsxs("div",{className:"text-sm text-gray-500",children:["Assigned: ",e.assignedAt.toLocaleDateString()]})]})},t))})]})]}),d.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:d.jsxs("div",{className:"flex justify-end space-x-3",children:[d.jsx("button",{onClick:a,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Close"}),d.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Edit User"})]})})]})}),jr=e=>{switch(e){case"active":return"text-green-600 bg-green-100";case"pending":return"text-yellow-600 bg-yellow-100";case"suspended":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},fr=({projectId:e,userId:t})=>{const[s,r]=a.useState("profile"),[i,n]=a.useState(!0),[l,o]=a.useState(!1),[c,m]=a.useState(null),[u,x]=a.useState(null),[h,p]=a.useState(!1);a.useEffect(()=>{g()},[e,t]);const g=async()=>{n(!0);try{const e=y(),t=b();m(e),x(t)}catch(e){console.error("Error loading settings:",e)}finally{n(!1)}},y=()=>({profile:{firstName:"John",lastName:"Smith",email:"john.smith@construction.com",phone:"+1-555-0101",title:"Project Manager",department:"Construction",timezone:"America/New_York",language:"en",dateFormat:"MM/DD/YYYY",timeFormat:"12h"},preferences:{theme:"light",density:"comfortable",sidebarCollapsed:!1,showAvatars:!0,showNotificationBadges:!0,autoSave:!0,confirmDeletions:!0},notifications:{email:{enabled:!0,frequency:"immediate",types:{mentions:!0,assignments:!0,deadlines:!0,updates:!1,security:!0}},push:{enabled:!0,sound:!0,vibration:!1,types:{mentions:!0,assignments:!0,deadlines:!0,updates:!1,security:!0}},desktop:{enabled:!0,sound:!1,position:"top-right"}},security:{twoFactorEnabled:!0,sessionTimeout:480,passwordExpiry:90,loginNotifications:!0,deviceTracking:!0,ipWhitelist:[]},privacy:{profileVisibility:"team",activityTracking:!0,dataCollection:!0,thirdPartyIntegrations:!0}}),b=()=>({general:{siteName:"ASAgents Construction Management",siteUrl:"https://asagents.construction.com",adminEmail:"admin@construction.com",timezone:"America/New_York",language:"en",maintenanceMode:!1,registrationEnabled:!0,guestAccess:!1},storage:{maxFileSize:100,allowedFileTypes:[".pdf",".doc",".docx",".xls",".xlsx",".jpg",".png",".gif",".mp4",".zip"],storageQuota:1e3,autoCleanup:!0,cleanupDays:90,compressionEnabled:!0},security:{passwordPolicy:{minLength:8,requireUppercase:!0,requireLowercase:!0,requireNumbers:!0,requireSymbols:!1,preventReuse:5},sessionSettings:{timeout:480,maxConcurrentSessions:3,rememberMeDuration:30},rateLimiting:{enabled:!0,maxRequests:100,windowMinutes:15}},integrations:{email:{provider:"smtp",host:"smtp.gmail.com",port:587,username:"noreply@construction.com",encryption:"tls"},storage:{provider:"local"},analytics:{enabled:!1}}}),j=(e,t)=>{if(!c)return;const s=e.split("."),a={...c};let r=a;for(let i=0;i<s.length-1;i++)r=r[s[i]];r[s[s.length-1]]=t,m(a),p(!0)},f=(e,t)=>{if(!u)return;const s=e.split("."),a={...u};let r=a;for(let i=0;i<s.length-1;i++)r=r[s[i]];r[s[s.length-1]]=t,x(a),p(!0)},v=[{id:"profile",label:"Profile",icon:fs},{id:"preferences",label:"Preferences",icon:es},{id:"notifications",label:"Notifications",icon:it},{id:"security",label:"Security",icon:Zt},{id:"privacy",label:"Privacy",icon:Nt},{id:"system",label:"System",icon:Qt},{id:"integrations",label:"Integrations",icon:Is}];return i?d.jsxs("div",{className:"flex items-center justify-center h-64",children:[d.jsx(Bt,{className:"w-8 h-8 animate-spin text-blue-600"}),d.jsx("span",{className:"ml-2 text-gray-600",children:"Loading settings..."})]}):d.jsxs("div",{className:"bg-white rounded-lg shadow-lg",children:[d.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Settings"}),d.jsx("p",{className:"text-gray-600",children:"Manage your account and system preferences"})]}),d.jsxs("div",{className:"flex items-center space-x-3",children:[h&&d.jsxs("div",{className:"flex items-center text-orange-600 text-sm",children:[d.jsx(hs,{className:"w-4 h-4 mr-1"}),"Unsaved changes"]}),d.jsxs("button",{onClick:async()=>{o(!0);try{await new Promise(e=>setTimeout(e,1e3)),p(!1)}catch(e){console.error("Error saving settings:",e)}finally{o(!1)}},disabled:!h||l,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[l?d.jsx(Bt,{className:"w-4 h-4 mr-2 animate-spin"}):d.jsx(Wt,{className:"w-4 h-4 mr-2"}),l?"Saving...":"Save Changes"]})]})]})}),d.jsx("div",{className:"border-b border-gray-200",children:d.jsx("nav",{className:"flex space-x-8 px-6",children:v.map(e=>{const t=e.icon;return d.jsxs("button",{onClick:()=>r(e.id),className:"flex items-center py-4 px-1 border-b-2 font-medium text-sm "+(s===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[d.jsx(t,{className:"w-4 h-4 mr-2"}),e.label]},e.id)})})}),d.jsxs("div",{className:"p-6",children:["profile"===s&&c&&d.jsx(vr,{settings:c.profile,onUpdate:(e,t)=>j(`profile.${e}`,t)}),"preferences"===s&&c&&d.jsx(Nr,{settings:c.preferences,onUpdate:(e,t)=>j(`preferences.${e}`,t)}),"notifications"===s&&c&&d.jsx(wr,{settings:c.notifications,onUpdate:(e,t)=>j(`notifications.${e}`,t)}),"security"===s&&c&&d.jsx(kr,{settings:c.security,onUpdate:(e,t)=>j(`security.${e}`,t)}),"privacy"===s&&c&&d.jsx(Sr,{settings:c.privacy,onUpdate:(e,t)=>j(`privacy.${e}`,t)}),"system"===s&&u&&d.jsx(Cr,{settings:u,onUpdate:(e,t)=>f(e,t)}),"integrations"===s&&u&&d.jsx(Er,{settings:u.integrations,onUpdate:(e,t)=>f(`integrations.${e}`,t)})]})]})},vr=({settings:e,onUpdate:t})=>d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Profile Information"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"First Name"}),d.jsx("input",{type:"text",value:e.firstName,onChange:e=>t("firstName",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Last Name"}),d.jsx("input",{type:"text",value:e.lastName,onChange:e=>t("lastName",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),d.jsx("input",{type:"email",value:e.email,onChange:e=>t("email",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),d.jsx("input",{type:"tel",value:e.phone,onChange:e=>t("phone",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Job Title"}),d.jsx("input",{type:"text",value:e.title,onChange:e=>t("title",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),d.jsx("input",{type:"text",value:e.department,onChange:e=>t("department",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Regional Settings"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Timezone"}),d.jsxs("select",{value:e.timezone,onChange:e=>t("timezone",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"America/New_York",children:"Eastern Time (ET)"}),d.jsx("option",{value:"America/Chicago",children:"Central Time (CT)"}),d.jsx("option",{value:"America/Denver",children:"Mountain Time (MT)"}),d.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time (PT)"}),d.jsx("option",{value:"UTC",children:"UTC"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Language"}),d.jsxs("select",{value:e.language,onChange:e=>t("language",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"en",children:"English"}),d.jsx("option",{value:"es",children:"Spanish"}),d.jsx("option",{value:"fr",children:"French"}),d.jsx("option",{value:"de",children:"German"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Format"}),d.jsxs("select",{value:e.dateFormat,onChange:e=>t("dateFormat",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"MM/DD/YYYY",children:"MM/DD/YYYY"}),d.jsx("option",{value:"DD/MM/YYYY",children:"DD/MM/YYYY"}),d.jsx("option",{value:"YYYY-MM-DD",children:"YYYY-MM-DD"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time Format"}),d.jsxs("select",{value:e.timeFormat,onChange:e=>t("timeFormat",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"12h",children:"12 Hour (AM/PM)"}),d.jsx("option",{value:"24h",children:"24 Hour"})]})]})]})]})]}),Nr=({settings:e,onUpdate:t})=>d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Appearance"}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Theme"}),d.jsx("div",{className:"flex space-x-4",children:[{value:"light",label:"Light",icon:ls},{value:"dark",label:"Dark",icon:Ut},{value:"auto",label:"Auto",icon:Ot}].map(({value:s,label:a,icon:r})=>d.jsxs("button",{onClick:()=>t("theme",s),className:"flex items-center space-x-2 px-4 py-2 border rounded-lg "+(e.theme===s?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-300 hover:border-gray-400"),children:[d.jsx(r,{className:"w-4 h-4"}),d.jsx("span",{children:a})]},s))})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Density"}),d.jsxs("select",{value:e.density,onChange:e=>t("density",e.target.value),className:"w-full max-w-xs px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"compact",children:"Compact"}),d.jsx("option",{value:"comfortable",children:"Comfortable"}),d.jsx("option",{value:"spacious",children:"Spacious"})]})]})]})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Interface Options"}),d.jsx("div",{className:"space-y-4",children:[{key:"sidebarCollapsed",label:"Collapse sidebar by default",description:"Start with a collapsed sidebar for more workspace"},{key:"showAvatars",label:"Show user avatars",description:"Display profile pictures throughout the interface"},{key:"showNotificationBadges",label:"Show notification badges",description:"Display unread counts on navigation items"},{key:"autoSave",label:"Auto-save changes",description:"Automatically save form changes as you type"},{key:"confirmDeletions",label:"Confirm deletions",description:"Show confirmation dialogs before deleting items"}].map(({key:s,label:a,description:r})=>d.jsxs("div",{className:"flex items-start space-x-3",children:[d.jsx("button",{onClick:()=>t(s,!e[s]),className:"mt-1",children:e[s]?d.jsx(ds,{className:"w-6 h-6 text-blue-600"}):d.jsx(cs,{className:"w-6 h-6 text-gray-400"})}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900",children:a}),d.jsx("p",{className:"text-sm text-gray-600",children:r})]})]},s))})]})]}),wr=({settings:e,onUpdate:t})=>d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Email Notifications"}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900",children:"Enable email notifications"}),d.jsx("p",{className:"text-sm text-gray-600",children:"Receive notifications via email"})]}),d.jsx("button",{onClick:()=>t("email.enabled",!e.email.enabled),children:e.email.enabled?d.jsx(ds,{className:"w-6 h-6 text-blue-600"}):d.jsx(cs,{className:"w-6 h-6 text-gray-400"})})]}),e.email.enabled&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Frequency"}),d.jsxs("select",{value:e.email.frequency,onChange:e=>t("email.frequency",e.target.value),className:"w-full max-w-xs px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"immediate",children:"Immediate"}),d.jsx("option",{value:"hourly",children:"Hourly digest"}),d.jsx("option",{value:"daily",children:"Daily digest"}),d.jsx("option",{value:"weekly",children:"Weekly digest"})]})]}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 mb-3",children:"Email notification types"}),d.jsx("div",{className:"space-y-2",children:Object.entries(e.email.types).map(([e,s])=>d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-700 capitalize",children:e.replace(/([A-Z])/g," $1")}),d.jsx("button",{onClick:()=>t(`email.types.${e}`,!s),children:s?d.jsx(ds,{className:"w-5 h-5 text-blue-600"}):d.jsx(cs,{className:"w-5 h-5 text-gray-400"})})]},e))})]})]})]})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Push Notifications"}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900",children:"Enable push notifications"}),d.jsx("p",{className:"text-sm text-gray-600",children:"Receive notifications on your device"})]}),d.jsx("button",{onClick:()=>t("push.enabled",!e.push.enabled),children:e.push.enabled?d.jsx(ds,{className:"w-6 h-6 text-blue-600"}):d.jsx(cs,{className:"w-6 h-6 text-gray-400"})})]}),e.push.enabled&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-700",children:"Sound"}),d.jsx("button",{onClick:()=>t("push.sound",!e.push.sound),children:e.push.sound?d.jsx(ws,{className:"w-5 h-5 text-blue-600"}):d.jsx(ks,{className:"w-5 h-5 text-gray-400"})})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-700",children:"Vibration"}),d.jsx("button",{onClick:()=>t("push.vibration",!e.push.vibration),children:e.push.vibration?d.jsx(ts,{className:"w-5 h-5 text-blue-600"}):d.jsx(ts,{className:"w-5 h-5 text-gray-400"})})]}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900 mb-3",children:"Push notification types"}),d.jsx("div",{className:"space-y-2",children:Object.entries(e.push.types).map(([e,s])=>d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-700 capitalize",children:e.replace(/([A-Z])/g," $1")}),d.jsx("button",{onClick:()=>t(`push.types.${e}`,!s),children:s?d.jsx(ds,{className:"w-5 h-5 text-blue-600"}):d.jsx(cs,{className:"w-5 h-5 text-gray-400"})})]},e))})]})]})]})]})]}),kr=({settings:e,onUpdate:t})=>d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Authentication"}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900",children:"Two-Factor Authentication"}),d.jsx("p",{className:"text-sm text-gray-600",children:"Add an extra layer of security to your account"})]}),d.jsx("button",{onClick:()=>t("twoFactorEnabled",!e.twoFactorEnabled),children:e.twoFactorEnabled?d.jsx(ds,{className:"w-6 h-6 text-green-600"}):d.jsx(cs,{className:"w-6 h-6 text-gray-400"})})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Session Timeout (minutes)"}),d.jsx("input",{type:"number",value:e.sessionTimeout,onChange:e=>t("sessionTimeout",parseInt(e.target.value)),className:"w-full max-w-xs px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"15",max:"1440"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password Expiry (days)"}),d.jsx("input",{type:"number",value:e.passwordExpiry,onChange:e=>t("passwordExpiry",parseInt(e.target.value)),className:"w-full max-w-xs px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"30",max:"365"})]})]})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Security Monitoring"}),d.jsx("div",{className:"space-y-4",children:[{key:"loginNotifications",label:"Login notifications",description:"Get notified when someone logs into your account"},{key:"deviceTracking",label:"Device tracking",description:"Track devices that access your account"}].map(({key:s,label:a,description:r})=>d.jsxs("div",{className:"flex items-start space-x-3",children:[d.jsx("button",{onClick:()=>t(s,!e[s]),className:"mt-1",children:e[s]?d.jsx(ds,{className:"w-6 h-6 text-blue-600"}):d.jsx(cs,{className:"w-6 h-6 text-gray-400"})}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900",children:a}),d.jsx("p",{className:"text-sm text-gray-600",children:r})]})]},s))})]})]}),Sr=({settings:e,onUpdate:t})=>d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Profile Privacy"}),d.jsx("div",{className:"space-y-4",children:d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Profile Visibility"}),d.jsxs("select",{value:e.profileVisibility,onChange:e=>t("profileVisibility",e.target.value),className:"w-full max-w-xs px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"public",children:"Public"}),d.jsx("option",{value:"team",children:"Team Only"}),d.jsx("option",{value:"private",children:"Private"})]})]})})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Data & Analytics"}),d.jsx("div",{className:"space-y-4",children:[{key:"activityTracking",label:"Activity tracking",description:"Allow tracking of your activity for analytics"},{key:"dataCollection",label:"Data collection",description:"Allow collection of usage data to improve the service"},{key:"thirdPartyIntegrations",label:"Third-party integrations",description:"Allow data sharing with integrated third-party services"}].map(({key:s,label:a,description:r})=>d.jsxs("div",{className:"flex items-start space-x-3",children:[d.jsx("button",{onClick:()=>t(s,!e[s]),className:"mt-1",children:e[s]?d.jsx(ds,{className:"w-6 h-6 text-blue-600"}):d.jsx(cs,{className:"w-6 h-6 text-gray-400"})}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900",children:a}),d.jsx("p",{className:"text-sm text-gray-600",children:r})]})]},s))})]})]}),Cr=({settings:e,onUpdate:t})=>d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"General Settings"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Site Name"}),d.jsx("input",{type:"text",value:e.general.siteName,onChange:e=>t("general.siteName",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Site URL"}),d.jsx("input",{type:"url",value:e.general.siteUrl,onChange:e=>t("general.siteUrl",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Admin Email"}),d.jsx("input",{type:"email",value:e.general.adminEmail,onChange:e=>t("general.adminEmail",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Timezone"}),d.jsxs("select",{value:e.general.timezone,onChange:e=>t("general.timezone",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"America/New_York",children:"Eastern Time (ET)"}),d.jsx("option",{value:"America/Chicago",children:"Central Time (CT)"}),d.jsx("option",{value:"America/Denver",children:"Mountain Time (MT)"}),d.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time (PT)"}),d.jsx("option",{value:"UTC",children:"UTC"})]})]})]}),d.jsx("div",{className:"mt-6 space-y-4",children:[{key:"maintenanceMode",label:"Maintenance mode",description:"Put the system in maintenance mode"},{key:"registrationEnabled",label:"User registration",description:"Allow new users to register"},{key:"guestAccess",label:"Guest access",description:"Allow guest users to view public content"}].map(({key:s,label:a,description:r})=>d.jsxs("div",{className:"flex items-start space-x-3",children:[d.jsx("button",{onClick:()=>t(`general.${s}`,!e.general[s]),className:"mt-1",children:e.general[s]?d.jsx(ds,{className:"w-6 h-6 text-blue-600"}):d.jsx(cs,{className:"w-6 h-6 text-gray-400"})}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900",children:a}),d.jsx("p",{className:"text-sm text-gray-600",children:r})]})]},s))})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Storage Settings"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max File Size (MB)"}),d.jsx("input",{type:"number",value:e.storage.maxFileSize,onChange:e=>t("storage.maxFileSize",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"1",max:"1000"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Storage Quota (GB)"}),d.jsx("input",{type:"number",value:e.storage.storageQuota,onChange:e=>t("storage.storageQuota",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"1",max:"10000"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Auto-cleanup Days"}),d.jsx("input",{type:"number",value:e.storage.cleanupDays,onChange:e=>t("storage.cleanupDays",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"1",max:"365"})]})]}),d.jsx("div",{className:"mt-6 space-y-4",children:[{key:"autoCleanup",label:"Auto cleanup",description:"Automatically delete old files"},{key:"compressionEnabled",label:"File compression",description:"Compress uploaded files to save space"}].map(({key:s,label:a,description:r})=>d.jsxs("div",{className:"flex items-start space-x-3",children:[d.jsx("button",{onClick:()=>t(`storage.${s}`,!e.storage[s]),className:"mt-1",children:e.storage[s]?d.jsx(ds,{className:"w-6 h-6 text-blue-600"}):d.jsx(cs,{className:"w-6 h-6 text-gray-400"})}),d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900",children:a}),d.jsx("p",{className:"text-sm text-gray-600",children:r})]})]},s))})]})]}),Er=({settings:e,onUpdate:t})=>d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Email Configuration"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Provider"}),d.jsxs("select",{value:e.email.provider,onChange:e=>t("email.provider",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"smtp",children:"SMTP"}),d.jsx("option",{value:"sendgrid",children:"SendGrid"}),d.jsx("option",{value:"mailgun",children:"Mailgun"}),d.jsx("option",{value:"ses",children:"Amazon SES"})]})]}),"smtp"===e.email.provider&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SMTP Host"}),d.jsx("input",{type:"text",value:e.email.host||"",onChange:e=>t("email.host",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Port"}),d.jsx("input",{type:"number",value:e.email.port||587,onChange:e=>t("email.port",parseInt(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),d.jsx("input",{type:"text",value:e.email.username||"",onChange:e=>t("email.username",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Encryption"}),d.jsxs("select",{value:e.email.encryption||"tls",onChange:e=>t("email.encryption",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"none",children:"None"}),d.jsx("option",{value:"tls",children:"TLS"}),d.jsx("option",{value:"ssl",children:"SSL"})]})]})]})]})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Storage Configuration"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Storage Provider"}),d.jsxs("select",{value:e.storage.provider,onChange:e=>t("storage.provider",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"local",children:"Local Storage"}),d.jsx("option",{value:"s3",children:"Amazon S3"}),d.jsx("option",{value:"azure",children:"Azure Blob"}),d.jsx("option",{value:"gcp",children:"Google Cloud"})]})]}),"local"!==e.storage.provider&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bucket/Container"}),d.jsx("input",{type:"text",value:e.storage.bucket||"",onChange:e=>t("storage.bucket",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Region"}),d.jsx("input",{type:"text",value:e.storage.region||"",onChange:e=>t("storage.region",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})]})]})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Analytics"}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"font-medium text-gray-900",children:"Enable Analytics"}),d.jsx("p",{className:"text-sm text-gray-600",children:"Track usage and performance metrics"})]}),d.jsx("button",{onClick:()=>t("analytics.enabled",!e.analytics.enabled),children:e.analytics.enabled?d.jsx(ds,{className:"w-6 h-6 text-blue-600"}):d.jsx(cs,{className:"w-6 h-6 text-gray-400"})})]}),e.analytics.enabled&&d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Analytics Provider"}),d.jsxs("select",{value:e.analytics.provider||"google",onChange:e=>t("analytics.provider",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"google",children:"Google Analytics"}),d.jsx("option",{value:"mixpanel",children:"Mixpanel"}),d.jsx("option",{value:"amplitude",children:"Amplitude"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tracking ID"}),d.jsx("input",{type:"text",value:e.analytics.trackingId||"",onChange:e=>t("analytics.trackingId",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"GA-XXXXXXXXX-X"})]})]})]})]})]}),Dr=({projectId:e,userId:t})=>{const[s,r]=a.useState("templates"),[i,n]=a.useState("grid"),[l,o]=a.useState(!0),[c,m]=a.useState([]),[u,x]=a.useState(null),[h,p]=a.useState(null),[g,y]=a.useState(!1),[b,j]=a.useState(""),[f,v]=a.useState("all"),[N,w]=a.useState("all"),[k,S]=a.useState("all");a.useEffect(()=>{C()},[e]);const C=async()=>{o(!0);try{const e=E(),t=D(e);m(e),x(t)}catch(e){console.error("Error loading template data:",e)}finally{o(!1)}},E=()=>[{id:"template-1",name:"Commercial Office Building",description:"Complete template for commercial office building construction including all phases from design to occupancy",category:"commercial",type:"project",version:"2.1",isPublic:!0,isFavorite:!0,createdBy:"System",createdAt:new Date(Date.now()-15552e6),updatedAt:new Date(Date.now()-2592e6),usageCount:45,rating:4.8,tags:["office","commercial","multi-story","LEED"],estimatedDuration:365,estimatedCost:5e6,complexity:"complex",phases:[{id:"phase-1",name:"Pre-Construction",description:"Design, permits, and planning phase",order:1,estimatedDuration:90,estimatedCost:5e5,dependencies:[],milestones:[{id:"milestone-1",name:"Design Approval",description:"Final design approval from client and authorities",targetDate:60,criteria:["Architectural plans approved","Structural plans approved","MEP plans approved"],deliverables:["Approved drawings","Permit applications"]}],tasks:["task-1","task-2"]},{id:"phase-2",name:"Foundation & Structure",description:"Foundation and structural construction",order:2,estimatedDuration:120,estimatedCost:2e6,dependencies:["phase-1"],milestones:[{id:"milestone-2",name:"Structure Complete",description:"Structural frame completion",targetDate:210,criteria:["Foundation complete","Frame erected","Roof installed"],deliverables:["Structural inspection reports","Progress photos"]}],tasks:["task-3","task-4"]}],tasks:[{id:"task-1",name:"Architectural Design",description:"Create detailed architectural drawings and specifications",phaseId:"phase-1",order:1,estimatedDuration:160,estimatedCost:15e4,assignedRole:"Architect",dependencies:[],priority:"high",type:"design",requiredSkills:["AutoCAD","Revit","Building Codes"],deliverables:["Floor plans","Elevations","Sections","Details"],checklists:["checklist-1"]},{id:"task-2",name:"Permit Applications",description:"Submit and manage building permit applications",phaseId:"phase-1",order:2,estimatedDuration:40,estimatedCost:25e3,assignedRole:"Project Manager",dependencies:["task-1"],priority:"critical",type:"documentation",requiredSkills:["Permit Process","Code Compliance"],deliverables:["Permit applications","Code compliance reports"],checklists:["checklist-2"]}],checklists:[{id:"checklist-1",name:"Architectural Design Review",description:"Comprehensive review checklist for architectural designs",category:"Design",isRequired:!0,applicablePhases:["phase-1"],applicableTasks:["task-1"],items:[{id:"item-1",text:"Floor plans show all required spaces",description:"Verify all programmatic requirements are met",isRequired:!0,category:"Planning",order:1},{id:"item-2",text:"Accessibility compliance verified",description:"Check ADA compliance for all areas",isRequired:!0,category:"Code Compliance",order:2},{id:"item-3",text:"Fire egress paths clearly marked",description:"Verify fire safety and egress requirements",isRequired:!0,category:"Safety",order:3}]}],workflows:[{id:"workflow-1",name:"Design Approval Workflow",description:"Standard approval process for design documents",trigger:"manual",steps:[{id:"step-1",name:"Initial Review",type:"approval",order:1,assignedRole:"Design Manager",parameters:{timeout:72},conditions:[]},{id:"step-2",name:"Client Review",type:"approval",order:2,assignedRole:"Client",parameters:{timeout:168},conditions:["step-1-approved"]}],conditions:[],notifications:[]}],resources:[{id:"resource-1",name:"Design Standards Manual",type:"document",url:"/templates/design-standards.pdf",isRequired:!0,applicablePhases:["phase-1"]},{id:"resource-2",name:"Permit Application Form",type:"form",url:"/templates/permit-form.pdf",isRequired:!0,applicablePhases:["phase-1"]}],customFields:[{id:"field-1",name:"building_height",type:"number",label:"Building Height (stories)",description:"Number of stories in the building",isRequired:!0,validation:{min:1,max:50}},{id:"field-2",name:"leed_certification",type:"select",label:"LEED Certification Target",description:"Target LEED certification level",isRequired:!1,options:["None","Certified","Silver","Gold","Platinum"]}]},{id:"template-2",name:"Residential Single Family Home",description:"Standard template for single family residential construction",category:"residential",type:"project",version:"1.5",isPublic:!0,isFavorite:!1,createdBy:"John Smith",createdAt:new Date(Date.now()-10368e6),updatedAt:new Date(Date.now()-1296e6),usageCount:28,rating:4.5,tags:["residential","single-family","custom-home"],estimatedDuration:180,estimatedCost:75e4,complexity:"moderate",phases:[],tasks:[],checklists:[],workflows:[],resources:[],customFields:[]},{id:"template-3",name:"Safety Inspection Checklist",description:"Comprehensive safety inspection checklist for construction sites",category:"custom",type:"checklist",version:"3.0",isPublic:!0,isFavorite:!0,createdBy:"Safety Department",createdAt:new Date(Date.now()-5184e6),updatedAt:new Date(Date.now()-432e6),usageCount:156,rating:4.9,tags:["safety","inspection","compliance","OSHA"],estimatedDuration:1,estimatedCost:0,complexity:"simple",phases:[],tasks:[],checklists:[],workflows:[],resources:[],customFields:[]},{id:"template-4",name:"Change Order Approval Workflow",description:"Standardized workflow for change order approvals",category:"custom",type:"workflow",version:"2.0",isPublic:!1,isFavorite:!1,createdBy:"Project Management",createdAt:new Date(Date.now()-3888e6),updatedAt:new Date(Date.now()-864e6),usageCount:89,rating:4.3,tags:["change-order","approval","workflow","budget"],estimatedDuration:7,estimatedCost:0,complexity:"moderate",phases:[],tasks:[],checklists:[],workflows:[],resources:[],customFields:[]}],D=e=>{const t=e.length,s=e.filter(e=>e.isPublic).length,a=e.filter(e=>e.isFavorite).length,r=e.filter(e=>new Date(e.updatedAt).getTime()>Date.now()-2592e6).length,i=["residential","commercial","industrial","infrastructure","renovation","custom"].map(s=>{const a=e.filter(e=>e.category===s).length;return{category:s,count:a,percentage:t>0?a/t*100:0}}),n=e.sort((e,t)=>t.usageCount-e.usageCount).slice(0,5).map(e=>({template:e,usageCount:e.usageCount}));return{totalTemplates:t,publicTemplates:s,favoriteTemplates:a,recentlyUsed:r,categoryDistribution:i,popularTemplates:n,usageStats:[{date:new Date(Date.now()-2592e6),templatesUsed:12,projectsCreated:8},{date:new Date(Date.now()-1296e6),templatesUsed:18,projectsCreated:12},{date:new Date,templatesUsed:25,projectsCreated:15}]}},A=e=>{switch(e){case"simple":return"text-green-600 bg-green-100";case"moderate":return"text-yellow-600 bg-yellow-100";case"complex":return"text-orange-600 bg-orange-100";case"expert":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},I=c.filter(e=>{const t=e.name.toLowerCase().includes(b.toLowerCase())||e.description.toLowerCase().includes(b.toLowerCase())||e.tags.some(e=>e.toLowerCase().includes(b.toLowerCase())),s="all"===f||e.category===f,a="all"===N||e.type===N,r="all"===k||e.complexity===k;return t&&s&&a&&r}),T=[{id:"templates",label:"Templates",icon:wt},{id:"workflows",label:"Workflows",icon:Es},{id:"checklists",label:"Checklists",icon:as},{id:"overview",label:"Overview",icon:ct}];return l?d.jsxs("div",{className:"flex items-center justify-center h-64",children:[d.jsx(Bt,{className:"w-8 h-8 animate-spin text-blue-600"}),d.jsx("span",{className:"ml-2 text-gray-600",children:"Loading templates..."})]}):d.jsxs("div",{className:"bg-white rounded-lg shadow-lg",children:[d.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Templates"}),d.jsx("p",{className:"text-gray-600",children:"Project templates, workflows, and standardized processes"})]}),d.jsxs("div",{className:"flex items-center space-x-3",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("input",{type:"text",placeholder:"Search templates...",value:b,onChange:e=>j(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 w-64"}),d.jsxs("select",{value:f,onChange:e=>v(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"all",children:"All Categories"}),d.jsx("option",{value:"residential",children:"Residential"}),d.jsx("option",{value:"commercial",children:"Commercial"}),d.jsx("option",{value:"industrial",children:"Industrial"}),d.jsx("option",{value:"infrastructure",children:"Infrastructure"}),d.jsx("option",{value:"renovation",children:"Renovation"}),d.jsx("option",{value:"custom",children:"Custom"})]}),d.jsxs("select",{value:N,onChange:e=>w(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"all",children:"All Types"}),d.jsx("option",{value:"project",children:"Project"}),d.jsx("option",{value:"phase",children:"Phase"}),d.jsx("option",{value:"task",children:"Task"}),d.jsx("option",{value:"checklist",children:"Checklist"}),d.jsx("option",{value:"workflow",children:"Workflow"})]}),d.jsxs("div",{className:"flex items-center border border-gray-300 rounded-lg",children:[d.jsx("button",{onClick:()=>n("grid"),className:"p-2 "+("grid"===i?"bg-blue-100 text-blue-600":"text-gray-400"),children:d.jsx(At,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>n("list"),className:"p-2 "+("list"===i?"bg-blue-100 text-blue-600":"text-gray-400"),children:d.jsx(Pt,{className:"w-4 h-4"})})]})]}),d.jsxs("button",{onClick:()=>y(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-4 h-4 mr-2"}),"Create Template"]})]})]})}),d.jsx("div",{className:"border-b border-gray-200",children:d.jsx("nav",{className:"flex space-x-8 px-6",children:T.map(e=>{const t=e.icon;return d.jsxs("button",{onClick:()=>r(e.id),className:"flex items-center py-4 px-1 border-b-2 font-medium text-sm "+(s===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[d.jsx(t,{className:"w-4 h-4 mr-2"}),e.label]},e.id)})})}),d.jsxs("div",{className:"p-6",children:["templates"===s&&d.jsx(Ar,{templates:I,viewMode:i,onSelectTemplate:p,onToggleFavorite:e=>{m(c.map(t=>t.id===e?{...t,isFavorite:!t.isFavorite}:t))},onCreateTemplate:()=>y(!0),getComplexityColor:A,getTypeIcon:e=>{switch(e){case"project":return nt;case"phase":return Rt;case"task":return as;case"checklist":return ht;case"workflow":return Es;default:return wt}}}),"workflows"===s&&d.jsx(Ir,{templates:I.filter(e=>"workflow"===e.type),viewMode:i,onSelectTemplate:p,getComplexityColor:A}),"checklists"===s&&d.jsx(Tr,{templates:I.filter(e=>"checklist"===e.type),viewMode:i,onSelectTemplate:p,getComplexityColor:A}),"overview"===s&&u&&d.jsx(Mr,{metrics:u,templates:c})]}),g&&d.jsx(Rr,{onClose:()=>y(!1),onSuccess:e=>{m([...c,e]),y(!1)}}),h&&d.jsx(Pr,{template:h,onClose:()=>p(null),onUpdate:e=>{m(c.map(t=>t.id===e.id?e:t)),p(null)}})]})},Ar=({templates:e,viewMode:t,onSelectTemplate:s,onToggleFavorite:a,onCreateTemplate:r,getComplexityColor:i,getTypeIcon:n})=>0===e.length?d.jsxs("div",{className:"text-center py-12",children:[d.jsx(wt,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No templates found"}),d.jsx("p",{className:"text-gray-600 mb-4",children:"Create your first template to get started"}),d.jsxs("button",{onClick:r,className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[d.jsx(zt,{className:"w-4 h-4 mr-2"}),"Create Template"]})]}):"grid"===t?d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:e.map(e=>{const t=n(e.type);return d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",children:[d.jsxs("div",{className:"flex items-start justify-between mb-3",children:[d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:d.jsx(t,{className:"w-5 h-5 text-blue-600"})}),d.jsx("div",{children:d.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${i(e.complexity)}`,children:e.complexity})})]}),d.jsx("button",{onClick:t=>{t.stopPropagation(),a(e.id)},className:"text-gray-400 hover:text-yellow-500",children:e.isFavorite?d.jsx(ns,{className:"w-5 h-5 fill-current text-yellow-500"}):d.jsx(is,{className:"w-5 h-5"})})]}),d.jsxs("div",{onClick:()=>s(e),children:[d.jsx("h4",{className:"font-semibold text-gray-900 mb-2 line-clamp-2",children:e.name}),d.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-3",children:e.description}),d.jsxs("div",{className:"space-y-2 text-xs text-gray-500",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{children:"Duration:"}),d.jsxs("span",{children:[e.estimatedDuration," days"]})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{children:"Cost:"}),d.jsxs("span",{children:["$",e.estimatedCost.toLocaleString()]})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{children:"Used:"}),d.jsxs("span",{children:[e.usageCount," times"]})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{children:"Rating:"}),d.jsxs("div",{className:"flex items-center",children:[d.jsx(ns,{className:"w-3 h-3 fill-current text-yellow-400"}),d.jsx("span",{className:"ml-1",children:e.rating})]})]})]}),d.jsxs("div",{className:"mt-3 flex flex-wrap gap-1",children:[e.tags.slice(0,3).map((e,t)=>d.jsx("span",{className:"inline-flex px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded",children:e},t)),e.tags.length>3&&d.jsxs("span",{className:"inline-flex px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded",children:["+",e.tags.length-3]})]})]})]},e.id)})}):d.jsx("div",{className:"space-y-4",children:e.map(e=>{const t=n(e.type);return d.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:d.jsxs("div",{className:"flex items-start justify-between",children:[d.jsxs("div",{className:"flex items-start space-x-4 flex-1",children:[d.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:d.jsx(t,{className:"w-6 h-6 text-blue-600"})}),d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center mb-2",children:[d.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:e.name}),d.jsx("span",{className:`ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full ${i(e.complexity)}`,children:e.complexity}),e.isPublic&&d.jsx("span",{className:"ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:"Public"})]}),d.jsx("p",{className:"text-gray-600 mb-3",children:e.description}),d.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Type:"}),d.jsx("p",{className:"font-medium capitalize",children:e.type})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Category:"}),d.jsx("p",{className:"font-medium capitalize",children:e.category})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Duration:"}),d.jsxs("p",{className:"font-medium",children:[e.estimatedDuration," days"]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Usage:"}),d.jsxs("p",{className:"font-medium",children:[e.usageCount," times"]})]})]}),d.jsx("div",{className:"mt-3 flex flex-wrap gap-1",children:e.tags.map((e,t)=>d.jsx("span",{className:"inline-flex px-2 py-1 text-xs bg-gray-100 text-gray-600 rounded",children:e},t))})]})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{onClick:()=>a(e.id),className:"p-2 text-gray-400 hover:text-yellow-500",children:e.isFavorite?d.jsx(ns,{className:"w-5 h-5 fill-current text-yellow-500"}):d.jsx(is,{className:"w-5 h-5"})}),d.jsx("button",{onClick:()=>s(e),className:"p-2 text-blue-600 hover:text-blue-800",title:"View Details",children:d.jsx(Nt,{className:"w-5 h-5"})}),d.jsx("button",{className:"p-2 text-gray-600 hover:text-gray-800",title:"Copy Template",children:d.jsx(yt,{className:"w-5 h-5"})}),d.jsx("button",{className:"p-2 text-gray-600 hover:text-gray-800",title:"Edit Template",children:d.jsx(rs,{className:"w-5 h-5"})}),d.jsx("button",{className:"p-2 text-gray-600 hover:text-gray-800",title:"More Options",children:d.jsx(vt,{className:"w-5 h-5"})})]})]})},e.id)})}),Ir=({templates:e,viewMode:t,onSelectTemplate:s,getComplexityColor:a})=>d.jsxs("div",{className:"text-center py-12",children:[d.jsx(Es,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Workflow Templates"}),d.jsx("p",{className:"text-gray-600",children:"Manage automated workflows and approval processes"}),d.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:[e.length," workflow templates available"]})]}),Tr=({templates:e,viewMode:t,onSelectTemplate:s,getComplexityColor:a})=>d.jsxs("div",{className:"text-center py-12",children:[d.jsx(as,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),d.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Checklist Templates"}),d.jsx("p",{className:"text-gray-600",children:"Standardized checklists for quality control and inspections"}),d.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:[e.length," checklist templates available"]})]}),Mr=({metrics:e,templates:t})=>{const s=[{title:"Total Templates",value:e.totalTemplates.toString(),change:0,icon:wt,color:"blue"},{title:"Public Templates",value:e.publicTemplates.toString(),change:0,icon:Kt,color:"green"},{title:"Favorites",value:e.favoriteTemplates.toString(),change:0,icon:ns,color:"yellow"},{title:"Recently Used",value:e.recentlyUsed.toString(),change:0,icon:pt,color:"purple"}];return d.jsxs("div",{className:"space-y-6",children:[d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:s.map((e,t)=>{const s=e.icon;return d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsx("div",{className:"flex items-center justify-between",children:d.jsx("div",{className:`p-2 rounded-lg bg-${e.color}-100`,children:d.jsx(s,{className:`w-5 h-5 text-${e.color}-600`})})}),d.jsxs("div",{className:"mt-4",children:[d.jsx("h3",{className:"text-sm font-medium text-gray-600",children:e.title}),d.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:e.value})]})]},t)})}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Category Distribution"}),d.jsx("div",{className:"space-y-3",children:e.categoryDistribution.map((e,t)=>d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-600 capitalize",children:e.category}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.count}),d.jsxs("span",{className:"text-xs text-gray-500",children:["(",e.percentage.toFixed(1),"%)"]})]})]},t))})]}),d.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Popular Templates"}),d.jsx("div",{className:"space-y-3",children:e.popularTemplates.map((e,t)=>d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm font-medium text-gray-900",children:e.template.name}),d.jsx("p",{className:"text-xs text-gray-500 capitalize",children:e.template.category})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("span",{className:"text-sm font-medium text-gray-900",children:e.usageCount}),d.jsx("span",{className:"text-xs text-gray-500",children:"uses"})]})]},t))})]})]})]})},Rr=({onClose:e,onSuccess:t})=>{const[s,r]=a.useState({name:"",description:"",category:"custom",type:"project",complexity:"moderate",estimatedDuration:30,estimatedCost:1e5,isPublic:!1,tags:""});return d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl mx-4",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Create New Template"})}),d.jsxs("form",{onSubmit:e=>{e.preventDefault();const a={id:`template-${Date.now()}`,...s,version:"1.0",isFavorite:!1,createdBy:"Current User",createdAt:new Date,updatedAt:new Date,usageCount:0,rating:0,tags:s.tags.split(",").map(e=>e.trim()).filter(Boolean),phases:[],tasks:[],checklists:[],workflows:[],resources:[],customFields:[]};t(a)},className:"p-6 space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Template Name *"}),d.jsx("input",{type:"text",required:!0,value:s.name,onChange:e=>r({...s,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Enter template name"})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),d.jsx("textarea",{value:s.description,onChange:e=>r({...s,description:e.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"Describe the template purpose and usage"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),d.jsxs("select",{value:s.category,onChange:e=>r({...s,category:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"residential",children:"Residential"}),d.jsx("option",{value:"commercial",children:"Commercial"}),d.jsx("option",{value:"industrial",children:"Industrial"}),d.jsx("option",{value:"infrastructure",children:"Infrastructure"}),d.jsx("option",{value:"renovation",children:"Renovation"}),d.jsx("option",{value:"custom",children:"Custom"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),d.jsxs("select",{value:s.type,onChange:e=>r({...s,type:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"project",children:"Project"}),d.jsx("option",{value:"phase",children:"Phase"}),d.jsx("option",{value:"task",children:"Task"}),d.jsx("option",{value:"checklist",children:"Checklist"}),d.jsx("option",{value:"workflow",children:"Workflow"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Complexity"}),d.jsxs("select",{value:s.complexity,onChange:e=>r({...s,complexity:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[d.jsx("option",{value:"simple",children:"Simple"}),d.jsx("option",{value:"moderate",children:"Moderate"}),d.jsx("option",{value:"complex",children:"Complex"}),d.jsx("option",{value:"expert",children:"Expert"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estimated Duration (days)"}),d.jsx("input",{type:"number",value:s.estimatedDuration,onChange:e=>r({...s,estimatedDuration:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"1"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estimated Cost ($)"}),d.jsx("input",{type:"number",value:s.estimatedCost,onChange:e=>r({...s,estimatedCost:parseInt(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",min:"0"})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tags (comma-separated)"}),d.jsx("input",{type:"text",value:s.tags,onChange:e=>r({...s,tags:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., office, commercial, multi-story"})]})]}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("input",{type:"checkbox",id:"isPublic",checked:s.isPublic,onChange:e=>r({...s,isPublic:e.target.checked}),className:"rounded border-gray-300"}),d.jsx("label",{htmlFor:"isPublic",className:"ml-2 text-sm text-gray-700",children:"Make this template public (visible to all users)"})]}),d.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[d.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),d.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Create Template"})]})]})]})})},Pr=({template:e,onClose:t,onUpdate:s})=>d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto",children:[d.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),d.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded",children:d.jsx(X,{className:"w-5 h-5"})})]})}),d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Template Information"}),d.jsxs("div",{className:"space-y-3 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Category:"}),d.jsx("span",{className:"ml-2 font-medium capitalize",children:e.category})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Type:"}),d.jsx("span",{className:"ml-2 font-medium capitalize",children:e.type})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Complexity:"}),d.jsx("span",{className:"ml-2 font-medium capitalize",children:e.complexity})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Version:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.version})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Created by:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.createdBy})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Created:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.createdAt.toLocaleDateString()})]})]})]}),d.jsxs("div",{children:[d.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Usage Statistics"}),d.jsxs("div",{className:"space-y-3 text-sm",children:[d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Times used:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.usageCount})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Rating:"}),d.jsxs("div",{className:"ml-2 inline-flex items-center",children:[d.jsx(ns,{className:"w-4 h-4 fill-current text-yellow-400"}),d.jsx("span",{className:"ml-1 font-medium",children:e.rating})]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Estimated duration:"}),d.jsxs("span",{className:"ml-2 font-medium",children:[e.estimatedDuration," days"]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Estimated cost:"}),d.jsxs("span",{className:"ml-2 font-medium",children:["$",e.estimatedCost.toLocaleString()]})]}),d.jsxs("div",{children:[d.jsx("span",{className:"text-gray-500",children:"Public:"}),d.jsx("span",{className:"ml-2 font-medium",children:e.isPublic?"Yes":"No"})]})]})]})]}),d.jsxs("div",{className:"mt-6",children:[d.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Description"}),d.jsx("p",{className:"text-sm text-gray-700 bg-gray-50 p-3 rounded-lg",children:e.description})]}),e.tags.length>0&&d.jsxs("div",{className:"mt-6",children:[d.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Tags"}),d.jsx("div",{className:"flex flex-wrap gap-2",children:e.tags.map((e,t)=>d.jsx("span",{className:"inline-flex px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded",children:e},t))})]}),e.phases.length>0&&d.jsxs("div",{className:"mt-6",children:[d.jsxs("h4",{className:"font-semibold text-gray-900 mb-3",children:["Phases (",e.phases.length,")"]}),d.jsx("div",{className:"space-y-2",children:e.phases.map(e=>d.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h5",{className:"font-medium text-gray-900",children:e.name}),d.jsxs("span",{className:"text-sm text-gray-500",children:[e.estimatedDuration," days"]})]}),d.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]},e.id))})]})]}),d.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:d.jsxs("div",{className:"flex justify-between",children:[d.jsxs("div",{className:"flex space-x-3",children:[d.jsxs("button",{className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:[d.jsx(yt,{className:"w-4 h-4 mr-2 inline"}),"Duplicate"]}),d.jsxs("button",{className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:[d.jsx(ft,{className:"w-4 h-4 mr-2 inline"}),"Export"]})]}),d.jsxs("div",{className:"flex space-x-3",children:[d.jsx("button",{onClick:t,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Close"}),d.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Use Template"})]})]})})]})});class Lr extends a.Component{constructor(){super(...arguments),this.state={hasError:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Uncaught error:",e,t)}render(){return this.state.hasError?d.jsxs(Me,{className:"border-destructive",children:[d.jsx("h2",{className:"text-xl font-bold text-destructive",children:"Something went wrong."}),d.jsx("p",{className:"text-muted-foreground mt-2",children:"A component on this dashboard has crashed. You can try refreshing the page."}),d.jsxs("details",{className:"mt-4 text-sm bg-muted p-2 rounded",children:[d.jsx("summary",{children:"Error Details"}),d.jsx("pre",{className:"whitespace-pre-wrap text-xs mt-2",children:this.state.error?.toString()})]}),d.jsx(Pe,{variant:"secondary",className:"mt-4",onClick:()=>window.location.reload(),children:"Refresh Page"})]}):this.props.children}}const _r=()=>{const{user:e,logout:t,loading:s}=Te(),[r,i]=a.useState("login"),[n,l]=a.useState("tools");if(s)return d.jsx("div",{className:"min-h-screen grid place-items-center p-6",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto"}),d.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"Loading..."})]})});if(!e){if("register"===r)return d.jsx("div",{className:"min-h-screen grid place-items-center p-6",children:d.jsx("div",{className:"w-full max-w-lg",children:d.jsxs(Me,{className:"p-6",children:[d.jsx("h2",{className:"text-lg font-semibold",children:"Registration temporarily unavailable"}),d.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Please contact support or use an existing account."}),d.jsx("div",{className:"mt-4",children:d.jsx("button",{type:"button",className:"text-primary hover:underline",onClick:()=>i("login"),children:"Back to login"})})]})})});try{return d.jsx("div",{className:"min-h-screen grid place-items-center p-6",children:d.jsxs("div",{className:"w-full max-w-md",children:[d.jsx(Me,{className:"mb-6",children:d.jsxs("div",{className:"p-4",children:[d.jsx("h1",{className:"text-xl font-bold",children:"AS Agents CMS"}),d.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Sign in to continue"})]})}),d.jsx(Fe,{onSwitchToRegister:()=>i("register"),onSwitchToForgotPassword:()=>i("forgot")})]})})}catch(o){return console.error("Login component error:",o),d.jsx("div",{className:"min-h-screen grid place-items-center p-6",children:d.jsxs(Me,{className:"p-6 border-destructive",children:[d.jsx("h2",{className:"text-lg font-semibold text-destructive",children:"Login Error"}),d.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"There was an error loading the login form."}),d.jsx("button",{type:"button",className:"mt-4 px-4 py-2 bg-primary text-primary-foreground rounded",onClick:()=>window.location.reload(),children:"Reload Page"})]})})}}return d.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[d.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",className:"h-6 w-6 text-primary","aria-hidden":!0,children:[d.jsx("path",{fill:"currentColor",d:"M12 2l9.196 5.31a1 1 0 01.5.866v10.648a1 1 0 01-.5.866L12 24l-9.196-4.31a1 1 0 01-.5.866V8.176a1 1 0 01.5-.866L12 2z",opacity:.12}),d.jsx("path",{fill:"currentColor",d:"M12 4.5l-6.5 3.752v7.496L12 19.5l6.5-3.752V8.252L12 4.5zm0 1.732l5 2.886v5.764l-5 2.886-5-2.886V9.118l5-2.886z"})]}),d.jsx("h1",{className:"text-lg font-semibold",children:"AS Agents"})]}),d.jsx("button",{type:"button",onClick:t,className:"text-sm text-red-600 hover:underline",children:"Logout"})]}),d.jsxs("div",{className:"flex flex-1 min-h-0",children:[d.jsx($e,{user:e,activeView:n,setActiveView:l,onLogout:t,pendingTimesheetCount:0,openIncidentCount:0,unreadMessageCount:0,companyName:void 0}),d.jsx("main",{className:"flex-1 p-4 overflow-auto",children:"tools"===n?d.jsx(ze,{user:e,addToast:(e,t)=>{"error"===t?console.error(e):console.log(e)},setActiveView:l}):"field"===n?d.jsx(_s,{projectId:"demo-project-1",userId:e.id,isOnline:navigator.onLine}):"document-management"===n?d.jsx(Ks,{projectId:"demo-project-1",userId:e.id}):"project-analytics"===n?d.jsx(ua,{projectId:"demo-project-1",userId:e.id}):"advanced-reporting"===n?d.jsx(va,{projectId:"demo-project-1",userId:e.id}):"collaboration"===n?d.jsx(Aa,{projectId:"demo-project-1",userId:e.id}):"quality-control"===n?d.jsx(_a,{projectId:"demo-project-1",userId:e.id}):"safety-dashboard"===n?d.jsx(Wa,{projectId:"demo-project-1",userId:e.id}):"equipment-dashboard"===n?d.jsx(sr,{projectId:"demo-project-1",userId:e.id}):"user-management"===n?d.jsx(mr,{projectId:"demo-project-1",userId:e.id}):"settings-dashboard"===n?d.jsx(fr,{projectId:"demo-project-1",userId:e.id}):"templates-dashboard"===n?d.jsx(Dr,{projectId:"demo-project-1",userId:e.id}):d.jsxs(Me,{className:"p-6",children:[d.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Coming soon"}),d.jsxs("p",{className:"text-sm text-muted-foreground mt-1",children:['The "',n,'" view will be restored next.']})]})})]})]})},Or=()=>d.jsx(Lr,{children:d.jsx(Ie,{children:d.jsx(_r,{})})}),Ur=document.getElementById("root");if(!Ur)throw new Error("Could not find root element to mount to");u.createRoot(Ur).render(d.jsx(r.StrictMode,{children:d.jsx(Or,{})}));
