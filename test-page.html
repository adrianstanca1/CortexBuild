<!DOCTYPE html>
<html>
<head>
    <title>CortexBuild Test Page</title>
    <style>
        body { font-family: Arial; padding: 20px; background: #1a1a1a; color: #fff; }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .ok { background: #166534; }
        .error { background: #991b1b; }
        button { padding: 10px 20px; margin: 5px; background: #3b82f6; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #2563eb; }
    </style>
</head>
<body>
    <h1>üîß CortexBuild Diagnostic Page</h1>

    <div id="status"></div>

    <h2>Test Buttons</h2>
    <button onclick="testBackend()">Test Backend API</button>
    <button onclick="testLogin()">Test Login</button>
    <button onclick="window.location.href='/'">Go to Main App</button>

    <h2>Console Output</h2>
    <pre id="console" style="background: #000; padding: 10px; border-radius: 5px; max-height: 400px; overflow-y: auto;"></pre>

    <script>
        const statusDiv = document.getElementById('status');
        const consoleDiv = document.getElementById('console');

        function log(msg) {
            console.log(msg);
            consoleDiv.textContent += msg + '\n';
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }

        async function testBackend() {
            log('Testing backend...');
            try {
                const res = await fetch('http://localhost:3001/api/tenders');
                const data = await res.json();
                log('‚úÖ Backend responding: ' + JSON.stringify(data).substring(0, 100));
                statusDiv.innerHTML = '<div class="status ok">‚úÖ Backend is working!</div>';
            } catch (err) {
                log('‚ùå Backend error: ' + err.message);
                statusDiv.innerHTML = '<div class="status error">‚ùå Backend error: ' + err.message + '</div>';
            }
        }

        async function testLogin() {
            log('Testing login...');
            try {
                const res = await fetch('http://localhost:3001/api/auth/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        email: 'adrian.stanca1@gmail.com',
                        password: 'parola123'
                    })
                });
                const data = await res.json();
                if (data.success) {
                    log('‚úÖ Login successful: ' + data.user.email);
                    statusDiv.innerHTML = '<div class="status ok">‚úÖ Login works! User: ' + data.user.email + '</div>';
                } else {
                    log('‚ùå Login failed: ' + data.error);
                    statusDiv.innerHTML = '<div class="status error">‚ùå Login failed: ' + data.error + '</div>';
                }
            } catch (err) {
                log('‚ùå Login error: ' + err.message);
                statusDiv.innerHTML = '<div class="status error">‚ùå Login error: ' + err.message + '</div>';
            }
        }

        // Auto-run on load
        log('Page loaded at: ' + new Date().toLocaleTimeString());
        log('Frontend URL: http://localhost:3000');
        log('Backend URL: http://localhost:3001');

        // Test backend automatically
        setTimeout(() => {
            log('Running automatic backend test...');
            testBackend();
        }, 500);
    </script>
</body>
</html>
